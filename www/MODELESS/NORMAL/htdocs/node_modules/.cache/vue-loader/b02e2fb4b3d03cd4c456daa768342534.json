{"remainingRequest":"/workspace3/minjie.chen/gitlab-work/advance-indoor/resources/www/MODELESS/NORMAL/htdocs/node_modules/vue-loader/lib/index.js??vue-loader-options!/workspace3/minjie.chen/gitlab-work/advance-indoor/resources/www/MODELESS/NORMAL/htdocs/src/components/CommonChangePwd.vue?vue&type=style&index=0&id=0c76d0c2&lang=less&scoped=true&","dependencies":[{"path":"/workspace3/minjie.chen/gitlab-work/advance-indoor/resources/www/MODELESS/NORMAL/htdocs/src/components/CommonChangePwd.vue","mtime":1600155105014},{"path":"/workspace3/minjie.chen/gitlab-work/advance-indoor/resources/www/MODELESS/NORMAL/htdocs/node_modules/css-loader/dist/cjs.js","mtime":1600155105054},{"path":"/workspace3/minjie.chen/gitlab-work/advance-indoor/resources/www/MODELESS/NORMAL/htdocs/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1600155105414},{"path":"/workspace3/minjie.chen/gitlab-work/advance-indoor/resources/www/MODELESS/NORMAL/htdocs/node_modules/postcss-loader/src/index.js","mtime":1600155105458},{"path":"/workspace3/minjie.chen/gitlab-work/advance-indoor/resources/www/MODELESS/NORMAL/htdocs/node_modules/less-loader/dist/cjs.js","mtime":1600155105078},{"path":"/workspace3/minjie.chen/gitlab-work/advance-indoor/resources/www/MODELESS/NORMAL/htdocs/node_modules/cache-loader/dist/cjs.js","mtime":1600155105894},{"path":"/workspace3/minjie.chen/gitlab-work/advance-indoor/resources/www/MODELESS/NORMAL/htdocs/node_modules/vue-loader/lib/index.js","mtime":1600155105414}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgovZGVlcC8uYW50LW1vZGFsLWNvbnRlbnQgewogIHdpZHRoOiA5NTBweDsKICBib3JkZXItcmFkaXVzOiAxMHB4Owp9CgovZGVlcC8uYW50LW1vZGFsLWZvb3RlciB7CiAgcGFkZGluZy10b3A6IDBweDsKICBib3JkZXItdG9wOiB1bnNldDsKfQoKLmFrLWNvbW1vbi1tb2RhbC1mb290ZXIgewogIG1hcmdpbi1ib3R0b206IDQwcHg7CiAgbWFyZ2luLXJpZ2h0OiAzNHB4Owp9CgouYWstY29tbW9uLW1vZGFsLWZvb3RlciA+IGRpdiB7CiAgcGFkZGluZy10b3A6IDYwcHg7Cn0KCi5hay1jb21tb24tbW9kYWwtZm9vdGVyLWJ0biB7CiAgd2lkdGg6IDEyMHB4OwogIGZvbnQtc2l6ZTogMTZweDsKICBib3JkZXItcmFkaXVzOiA1cHg7CiAgbWFyZ2luLWxlZnQ6IDMwcHg7Cn0KLmFrLWNvbW1vbi1tb2RhbC1mb290ZXItY2FuY2VsIHsKICBiYWNrZ3JvdW5kOiByZ2JhKDI0MSwgMjQxLCAyNDEsIDEpOwogIGNvbG9yOiAjNjU2NTY1OwogIGJvcmRlcjogdW5zZXQ7Cn0KLmFrLWNvbW1vbi1tb2RhbC1mb290ZXItY29uZmlybSB7CiAgYmFja2dyb3VuZDogcmdiYSgwLCAxMzUsIDI0NywgMSk7CiAgY29sb3I6ICNmZmZmZmY7CiAgYm9yZGVyOiB1bnNldDsKfQovZGVlcC8uYW50LW1vZGFsLXRpdGxlIHsKICBmb250LXNpemU6IDIwcHg7CiAgY29sb3I6ICMzMzMzMzM7CiAgZm9udC13ZWlnaHQ6IGJvbGQ7CiAgbWluLWhlaWdodDogMjJweDsKfQovZGVlcC8uYW50LW1vZGFsLWhlYWRlciB7CiAgbWFyZ2luOiAxNXB4OwogIHBhZGRpbmc6IDE1cHggMTVweDsKICBib3JkZXItYm90dG9tLWNvbG9yOiAjZDNkYmUxOwp9CgovZGVlcC8uYW50LW1vZGFsLWJvZHkgewogIHBhZGRpbmctdG9wOiAwcHg7CiAgcGFkZGluZy1ib3R0b206IDBweDsKfQoKL2RlZXAvLmFudC1idG4tZGFuZ2VyOmhvdmVyLAovZGVlcC8gLmFudC1idG4tZGFuZ2VyOmZvY3VzIHsKICBjb2xvcjogIzY1NjU2NTsKICBiYWNrZ3JvdW5kLWNvbG9yOiAjZjlmOWY5Owp9CgouYWstbW9kYWwtc3BhbiB7CiAgbWFyZ2luLWxlZnQ6IDM1cHg7CiAgbWFyZ2luLXJpZ2h0OiAzNXB4OwogIGZvbnQtc2l6ZTogMTZweDsKICBmbG9hdDogbGVmdDsKICBtYXJnaW4tYm90dG9tOiA0MHB4Owp9Cg=="},{"version":3,"sources":["CommonChangePwd.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiZA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA","file":"CommonChangePwd.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div>\n    <a-modal :title=\"title\" :visible=\"data.visible\" :centered=\"true\" @cancel=\"onCancel\">\n      <template v-for=\"(item,itemIndex) in modalItems\">\n        <div :key=\"item.key\">\n          <CommonInput\n            :addOnBefore=\"item.addOnBefore\"\n            v-if=\"item.type == 'input'\"\n            :wholeStyle=\"inputStyle\"\n            :labelTitle=\"item.title\"\n            :descriptionContent=\"item.description\"\n            :hintContent=\"item.hintContent\"\n            :showHint=\"item.showHint\"\n            :disabled=\"item.disabled\"\n            :inputType=\"item.inputType\"\n            :isWarn=\"item.isWarn\"\n            :warnLabel=\"item.warnLabel\"\n            :value=\"item.value\"\n            @change=\"onChange($event, item,item.key,itemIndex)\"\n            :maxLength=\"item.maxLength\"\n            :showEmptyPwd=\"item.showEmptyPwd\"\n            :showDescription=\"item.showDescription\"\n            :onInput=\"item.onInput\"\n            :isShow=\"item.isShow\"\n          ></CommonInput>\n          <CommonLabel\n            v-else-if=\"item.type=='label'\"\n            :wholeStyle=\"inputStyle\"\n            :labelTitle=\"item.title\"\n            :value=\"item.value\"\n            :showDescription=\"item.showDescription\"\n            :titleBold=\"item.titleBold\"\n          ></CommonLabel>\n          <span v-else-if=\"item.type=='span'\" class=\"ak-modal-span\">{{item.value}}</span>\n          <label\n            v-else-if=\"item.type=='hint-label'\"\n            v-show=\"item.isShowDiv\"\n            :style=\"item.isTrue ? hintGreenStyle : hintRedStyle\"\n          >{{item.value}}{{item.right}}</label>\n        </div>\n      </template>\n      <template slot=\"footer\">\n        <div class=\"ak-common-modal-footer\">\n          <div v-if=\"showFooter\">\n            <a-button\n              @click=\"onCancel\"\n              class=\"ak-common-modal-footer-btn ak-common-modal-footer-cancel\"\n              type=\"danger\"\n            >{{cancelBtnLabel}}</a-button>\n            <a-button\n              class=\"ak-common-modal-footer-btn ak-common-modal-footer-confirm\"\n              type=\"primary\"\n              @click=\"onConfirm\"\n              :disabled=\"confirmDisabled\"\n            >{{submitBtnLabel}}</a-button>\n          </div>\n        </div>\n      </template>\n    </a-modal>\n  </div>\n</template>\n\n<script>\nimport CommonInput from \"@/components/CommonInput.vue\";\nimport CommonLabel from \"@/components/CommonLabel.vue\";\nimport {\n  deepClone,\n  getIndexByKey,\n  isValidLoginPsw,\n  notContainInvalid_Sub,\n  showRequestSuccess,\n  showErrorInfo,\n} from \"@/js/common.js\";\n\nexport default {\n  components: {\n    CommonInput,\n    CommonLabel,\n  },\n  props: {\n    userName: String,\n    cancelBtnLabel: String,\n    title: String,\n    oldPswShow: { type: Boolean, default: true },\n    data: Object,\n  },\n  data() {\n    return {\n      submitBtnLabel: this.$t(\"Change\"),\n      showFooter: true,\n      confirmDisabled: true,\n      modalItems: [\n        {\n          type: \"span\",\n          value: this.$t(\"WebPswModifyAlert\"),\n        },\n        {\n          title: this.$t(\"UserName\"),\n          type: \"label\",\n          key: \"userName\",\n          value: this.userName,\n          isHint: false,\n        },\n        {\n          title: this.$t(\"OldPassword\"),\n          type: \"input\",\n          key: \"oldPassword\",\n          showEmptyPwd: false,\n          value: \"\",\n          inputType: \"password\",\n          showDescription: false,\n          maxlength: 20,\n          isShow: this.oldPswShow,\n        },\n        {\n          type: \"hint-label\",\n          key: \"oldPasswordhint\",\n          value: this.$t(\"OldPasswordIncorrectWarning\"),\n          isShowDiv: false,\n          isTrue: false,\n        },\n        {\n          title: this.$t(\"NewPassword\"),\n          type: \"input\",\n          key: \"newPassword\",\n          showEmptyPwd: false,\n          value: \"\",\n          inputType: \"password\",\n          showDescription: false,\n          maxlength: 20,\n        },\n        {\n          type: \"hint-label\",\n          key: \"hint0\",\n          value: this.$t(\"UpperAlert\"),\n          isShowDiv: false,\n          isTrue: false,\n        },\n        {\n          type: \"hint-label\",\n          key: \"hint1\",\n          value: this.$t(\"LowerAlert\"),\n          isShowDiv: false,\n          isTrue: false,\n        },\n        {\n          type: \"hint-label\",\n          key: \"hint2\",\n          value: this.$t(\"DigitAlert\"),\n          isShowDiv: false,\n          isTrue: false,\n        },\n        {\n          type: \"hint-label\",\n          key: \"hint3\",\n          value: this.$t(\"CharLongAlert\"),\n          isShowDiv: false,\n          isTrue: false,\n        },\n        {\n          title: this.$t(\"ConfirmPassword\"),\n          type: \"input\",\n          key: \"confirmPassword\",\n          showEmptyPwd: false,\n          value: \"\",\n          inputType: \"password\",\n          showDescription: false,\n          disabled: true,\n        },\n        {\n          type: \"hint-label\",\n          key: \"confirmPasswordhint\",\n          value: this.$t(\"MatchAlert\"),\n          isShowDiv: false,\n          isTrue: false,\n        },\n      ],\n      inputStyle: {\n        paddingLeft: \"130px\",\n        fontSize: \"16px\",\n        marginTop: \"16px\",\n        display: \"flex\",\n      },\n      hintRedStyle: {\n        paddingLeft: \"420px\",\n        fontSize: \"14px\",\n        color: \"#fa4747\",\n        marginTop: \"16px\",\n        display: \"flex\",\n      },\n      hintGreenStyle: {\n        paddingLeft: \"420px\",\n        fontSize: \"14px\",\n        color: \"#35a404\",\n        marginTop: \"16px\",\n        display: \"flex\",\n      },\n    };\n  },\n  methods: {\n    onConfirm: function () {\n      onModifyPageClickChangeButton(this);\n    },\n    onCancel: function(){\n      this.data.visible = false;\n      modalChangeCancel(this);\n    },\n    onChange: function (data, item, itemKey, itemIndex) {\n      let oldVal = item.value;\n      let newVal = data;\n\n      item.value = data;\n\n      let result = {\n        oldVal: oldVal,\n        newVal: newVal,\n        itemKey: itemKey,\n        itemIndex: itemIndex,\n      };\n\n      if (\"newPassword\" == itemKey) {\n        onModifyPageNewPswChange(this, newVal);\n      }\n\n      if (\"confirmPassword\" == itemKey) {\n        onModifyPageConfirmNewPswChange(this, newVal);\n      }\n    },\n  },\n  watch: {\n    userName(newVal) {\n      let itemIndex = getIndexByKey(this.modalItems, \"userName\");\n      this.modalItems[itemIndex].value = newVal;\n    },\n    oldPswShow(newVal) {\n      let itemIndex = getIndexByKey(this.modalItems, \"oldPassword\");\n      this.modalItems[itemIndex].isShow = newVal;\n    },\n  },\n};\n\nfunction modalChangeCancel(vm){\n  let itemIndex1 = getIndexByKey(vm.modalItems, \"oldPassword\");\n  let itemIndex2 = getIndexByKey(vm.modalItems, \"newPassword\");\n  let itemIndex3 = getIndexByKey(vm.modalItems, \"confirmPassword\");\n  vm.modalItems[itemIndex1].value = \"\";\n  vm.modalItems[itemIndex2].value = \"\";\n  vm.modalItems[itemIndex3].value = \"\";\n\n  for (var i = 0; i < 4; i++) {\n    let hintIndex = getIndexByKey(vm.modalItems, \"hint\" + i);\n    vm.modalItems[hintIndex].isShowDiv = false;\n  }\n\n  let hintIndex = getIndexByKey(vm.modalItems, \"confirmPasswordhint\");\n  vm.modalItems[hintIndex].isShowDiv = false;\n\n  let requestData = {\n    target: \"securityBasic\",\n    action: \"set\",\n    data: {\n      \"firstCancel\": 1,\n    },\n  };\n  vm.$axios.post(\"api\", requestData).then((response) => {\n\n  });\n}\n\nfunction onModifyPageClickChangeButton(vm) {\n  var nIsValidNew, nIsValidConfirm;\n  var strOldPsw, strNewPsw, strUserName;\n  var bIsFirstTime;\n  var request;\n  var errFlag = false;\n\n  let oldPwdItemIndex = getIndexByKey(vm.modalItems, \"oldPassword\");\n  let newPwdItemIndex = getIndexByKey(vm.modalItems, \"newPassword\");\n  let userNameItemIndex = getIndexByKey(vm.modalItems, \"userName\");\n  strUserName = vm.modalItems[userNameItemIndex].value;\n  strOldPsw = vm.modalItems[oldPwdItemIndex].value;\n  strNewPsw = vm.modalItems[newPwdItemIndex].value;\n\n  if (false == vm.modalItems[oldPwdItemIndex].isShow) {\n    let requestData = {\n      target: \"securityBasic\",\n      action: \"set\",\n      data: {\n        userName: strUserName,\n        firstLogin: 1,\n        newPassword: strNewPsw,\n      },\n    };\n    vm.$axios.post(\"api\", requestData).then((response) => {\n      showRequestSuccess(vm, vm.$t(\"Change Success\"));\n      vm.data.visible = false;\n    });\n    return;\n  }\n\n  if (!notContainInvalid_Sub(strNewPsw)) {\n    showErrorInfo(vm, vm.$t(\"LoginPasswordFormatAlert\"));\n    return;\n  }\n\n  if (strNewPsw == strOldPsw) {\n    showErrorInfo(vm, vm.$t(\"LoginOldPasswordSameAlert\"));\n    return;\n  }\n\n  // vm.data.submitLoading = true;\n\n  let requestData = {\n    target: \"securityBasic\",\n    action: \"set\",\n    data: {\n      userName: strUserName,\n      oldPassword: strOldPsw,\n      newPassword: strNewPsw,\n    },\n  };\n  vm.$axios.post(\"api\", requestData).then((response) => {\n    if (response.data.retcode == -1) {\n      showErrorInfo(vm, vm.$t(\"original password incorrect\"));\n    } else if (response.data.retcode == 0) {\n      showRequestSuccess(vm, vm.$t(\"Change Success\"));\n      vm.data.visible = false;\n    }\n    // vm.data.submitLoading = false;\n  });\n}\n\nfunction onModifyPageNewPswChange(vm, value) {\n  var nFlag = 0;\n  var strFlag;\n  if (value.length != 0) {\n    for (var i = 0; i < 4; i++) {\n      let hintIndex = getIndexByKey(vm.modalItems, \"hint\" + i);\n      vm.modalItems[hintIndex].isShowDiv = true;\n    }\n  } else {\n    for (var i = 0; i < 4; i++) {\n      let hintIndex = getIndexByKey(vm.modalItems, \"hint\" + i);\n      vm.modalItems[hintIndex].isShowDiv = false;\n    }\n  }\n  nFlag = isValidLoginPsw(value);\n  strFlag = nFlag.toString(2);\n  strFlag = (Array(4).join(0) + strFlag).slice(-4);\n\n  for (var i = 0; i < strFlag.length; i++) {\n    let hintIndex = getIndexByKey(vm.modalItems, \"hint\" + i);\n    if (strFlag.charAt(i) == 1) {\n      vm.modalItems[hintIndex].right = \" √\";\n      vm.modalItems[hintIndex].isTrue = true;\n    } else {\n      vm.modalItems[hintIndex].right = \" ×\";\n      vm.modalItems[hintIndex].isTrue = false;\n    }\n  }\n  if (15 != nFlag) {\n    let itemIndex = getIndexByKey(vm.modalItems, \"confirmPassword\");\n    vm.modalItems[itemIndex].value = \"\";\n    vm.modalItems[itemIndex].disabled = true;\n  } else {\n    let itemIndex = getIndexByKey(vm.modalItems, \"confirmPassword\");\n    vm.modalItems[itemIndex].disabled = false;\n    for (var i = 0; i < 4; i++) {\n      let hintIndex = getIndexByKey(vm.modalItems, \"hint\" + i);\n      vm.modalItems[hintIndex].isShowDiv = false;\n    }\n  }\n  return nFlag;\n}\n\nfunction onModifyPageConfirmNewPswChange(vm, value) {\n  let itemIndex = getIndexByKey(vm.modalItems, \"newPassword\");\n  var newPsw = vm.modalItems[itemIndex].value;\n  let hintIndex = getIndexByKey(vm.modalItems, \"confirmPasswordhint\");\n  if (value.length <= 0 || newPsw.length <= 0) {\n    vm.modalItems[hintIndex].isShowDiv = false;\n    vm.confirmDisabled = true;\n    return -1;\n  }\n  if (value.length < 8 || value.length > newPsw.length) {\n    vm.modalItems[hintIndex].isShowDiv = true;\n    vm.confirmDisabled = true;\n    return -1;\n  } else if (value.length == newPsw.length && value == newPsw) {\n    vm.modalItems[hintIndex].isShowDiv = false;\n    vm.confirmDisabled = false;\n    return 1;\n  } else {\n    vm.modalItems[hintIndex].isShowDiv = true;\n    vm.confirmDisabled = true;\n  }\n  return 0;\n}\n</script>\n\n<style lang=\"less\" scoped>\n/deep/.ant-modal-content {\n  width: 950px;\n  border-radius: 10px;\n}\n\n/deep/.ant-modal-footer {\n  padding-top: 0px;\n  border-top: unset;\n}\n\n.ak-common-modal-footer {\n  margin-bottom: 40px;\n  margin-right: 34px;\n}\n\n.ak-common-modal-footer > div {\n  padding-top: 60px;\n}\n\n.ak-common-modal-footer-btn {\n  width: 120px;\n  font-size: 16px;\n  border-radius: 5px;\n  margin-left: 30px;\n}\n.ak-common-modal-footer-cancel {\n  background: rgba(241, 241, 241, 1);\n  color: #656565;\n  border: unset;\n}\n.ak-common-modal-footer-confirm {\n  background: rgba(0, 135, 247, 1);\n  color: #ffffff;\n  border: unset;\n}\n/deep/.ant-modal-title {\n  font-size: 20px;\n  color: #333333;\n  font-weight: bold;\n  min-height: 22px;\n}\n/deep/.ant-modal-header {\n  margin: 15px;\n  padding: 15px 15px;\n  border-bottom-color: #d3dbe1;\n}\n\n/deep/.ant-modal-body {\n  padding-top: 0px;\n  padding-bottom: 0px;\n}\n\n/deep/.ant-btn-danger:hover,\n/deep/ .ant-btn-danger:focus {\n  color: #656565;\n  background-color: #f9f9f9;\n}\n\n.ak-modal-span {\n  margin-left: 35px;\n  margin-right: 35px;\n  font-size: 16px;\n  float: left;\n  margin-bottom: 40px;\n}\n</style>"]}]}