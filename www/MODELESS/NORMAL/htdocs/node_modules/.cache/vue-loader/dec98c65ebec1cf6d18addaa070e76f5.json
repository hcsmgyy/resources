{"remainingRequest":"/workspace3/minjie.chen/gitlab-work/advance-indoor/resources/www/MODELESS/NORMAL/htdocs/node_modules/vue-loader/lib/index.js??vue-loader-options!/workspace3/minjie.chen/gitlab-work/advance-indoor/resources/www/MODELESS/NORMAL/htdocs/src/components/TableFileInput.vue?vue&type=script&lang=js&","dependencies":[{"path":"/workspace3/minjie.chen/gitlab-work/advance-indoor/resources/www/MODELESS/NORMAL/htdocs/src/components/TableFileInput.vue","mtime":1600155105018},{"path":"/workspace3/minjie.chen/gitlab-work/advance-indoor/resources/www/MODELESS/NORMAL/htdocs/node_modules/cache-loader/dist/cjs.js","mtime":1600155105894},{"path":"/workspace3/minjie.chen/gitlab-work/advance-indoor/resources/www/MODELESS/NORMAL/htdocs/node_modules/babel-loader/lib/index.js","mtime":1600155105338},{"path":"/workspace3/minjie.chen/gitlab-work/advance-indoor/resources/www/MODELESS/NORMAL/htdocs/node_modules/cache-loader/dist/cjs.js","mtime":1600155105894},{"path":"/workspace3/minjie.chen/gitlab-work/advance-indoor/resources/www/MODELESS/NORMAL/htdocs/node_modules/vue-loader/lib/index.js","mtime":1600155105414}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGRlZXBDbG9uZSwgY2hlY2tGaWxlRm9ybWF0LCBzaG93RXJyb3JJbmZvIH0gZnJvbSAiQC9qcy9jb21tb24uanMiOwpleHBvcnQgZGVmYXVsdCB7CiAgcHJvcHM6IHsKICAgIGFjY2VwdEZpbGVUeXBlOiB7IHR5cGU6IFN0cmluZywgZGVmYXVsdDogIiIgfSwKICAgIGJ0bk5hbWU6IFN0cmluZywKICAgIHZhbHVlOiBPYmplY3QsCiAgICB1cGxvYWQ6IEZ1bmN0aW9uLAogICAgaW5kZXg6IE51bWJlciwKICAgIGlzU2hvdzogeyB0eXBlOiBCb29sZWFuLCBkZWZhdWx0OiB0cnVlIH0sCiAgICBtYXhTaXplOiB7IHR5cGU6IE51bWJlciwgZGVmYXVsdDogLTEgfSwKICB9LAogIG1ldGhvZHM6IHsKICAgIGJlZm9yZVVwbG9hZDogZnVuY3Rpb24gKGluZm8pIHsKICAgICAgLy9jaGVjayBmb3JtYXQKICAgICAgbGV0IGFjY2VwdFR5cGVzID0gdGhpcy5hY2NlcHRGaWxlVHlwZS5zcGxpdCgiLCIpOwogICAgICBsZXQgY2hlY2tTdWNjZXNzID0gZmFsc2U7CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYWNjZXB0VHlwZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBpZiAoY2hlY2tGaWxlRm9ybWF0KGluZm8ubmFtZSwgYWNjZXB0VHlwZXNbaV0sIGFjY2VwdFR5cGVzW2ldLmxlbmd0aCkpIHsKICAgICAgICAgIGNoZWNrU3VjY2VzcyA9IHRydWU7CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmICghY2hlY2tTdWNjZXNzKSB7CiAgICAgICAgc2hvd0Vycm9ySW5mbyh0aGlzLCB0aGlzLiR0KCJGaWxlRm9ybWF0V2FybmluZyIpKTsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgICAgLy9jaGVjayBmaWxlIHNpemUKICAgICAgaWYgKHRoaXMubWF4U2l6ZSA+IDAgJiYgaW5mby5zaXplID4gdGhpcy5tYXhTaXplKSB7CiAgICAgICAgc2hvd0Vycm9ySW5mbyh0aGlzLCB0aGlzLiR0KCJVcGxvYWRpbmdGaWxlVG9vTGFyZ2VXYXJuaW5nIikpOwogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgICAvL2NoZWNrIGZpbGUgbmFtZQogICAgICBpZiAoaW5mby5uYW1lLmxlbmd0aCA+IDEyNykgewogICAgICAgIHNob3dFcnJvckluZm8odGhpcywgdGhpcy4kdCgiV2FybmluZ0ZpbGVOYW1lVG9vTG9uZyIpKTsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIGxldCBvbGRWYWx1ZSA9IGRlZXBDbG9uZSh0aGlzLnZhbHVlKTsKICAgICAgdGhpcy52YWx1ZS5maWxlRGF0YSA9IGluZm87CiAgICAgIHRoaXMudmFsdWUuZmlsZU5hbWUgPSBpbmZvLm5hbWU7CiAgICAgIHRoaXMub25DaGFuZ2Uob2xkVmFsdWUpOwogICAgICB0aGlzLnVwbG9hZChpbmZvLCB0aGlzLmluZGV4KTsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfSwKICAgIG9uQ2hhbmdlOiBmdW5jdGlvbiAob2xkVmFsKSB7CiAgICAgIGxldCBkYXRhID0gewogICAgICAgIG5ld1ZhbDogewogICAgICAgICAgZmlsZU5hbWU6IHRoaXMudmFsdWUuZmlsZU5hbWUsCiAgICAgICAgICBmaWxlRGF0YTogdGhpcy52YWx1ZS5maWxlRGF0YSwKICAgICAgICB9LAogICAgICAgIG9sZFZhbDogb2xkVmFsLAogICAgICB9OwogICAgICB0aGlzLiRlbWl0KCJjaGFuZ2UiLCBkYXRhKTsKICAgIH0sCiAgICBvbkNhbmNlbDogZnVuY3Rpb24gKCkgewogICAgICBsZXQgb2xkVmFsdWUgPSBkZWVwQ2xvbmUodGhpcy52YWx1ZSk7CiAgICAgIHRoaXMudmFsdWUuZmlsZU5hbWUgPSAiIjsKICAgICAgdGhpcy52YWx1ZS5maWxlRGF0YSA9IHt9OwogICAgICB0aGlzLm9uQ2hhbmdlKG9sZFZhbHVlKTsKICAgIH0sCiAgfSwKfTsK"},{"version":3,"sources":["TableFileInput.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;AAqBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"TableFileInput.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div class=\"ak-table-file-input-div\" v-if=\"isShow\">\n    <div :style=\"{display:'flex'}\">\n      <div class=\"ak-table-file-input-file-name\">\n        <label>{{value.fileName}}</label>\n        <a-upload\n          name=\"file\"\n          :showUploadList=\"false\"\n          :accept=\"acceptFileType\"\n          :beforeUpload=\"beforeUpload\"\n          :style=\"{float:'right'}\"\n        >\n          <a-button type=\"file\" class=\"ak-table-file-input-file-button\">{{$t('UpgradeFile')}}</a-button>\n        </a-upload>\n      </div>\n      <a-button type=\"danger\" class=\"ak-table-file-input-btn\" @click=\"onCancel\">{{ btnName }}</a-button>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { deepClone, checkFileFormat, showErrorInfo } from \"@/js/common.js\";\nexport default {\n  props: {\n    acceptFileType: { type: String, default: \"\" },\n    btnName: String,\n    value: Object,\n    upload: Function,\n    index: Number,\n    isShow: { type: Boolean, default: true },\n    maxSize: { type: Number, default: -1 },\n  },\n  methods: {\n    beforeUpload: function (info) {\n      //check format\n      let acceptTypes = this.acceptFileType.split(\",\");\n      let checkSuccess = false;\n      for (let i = 0; i < acceptTypes.length; i++) {\n        if (checkFileFormat(info.name, acceptTypes[i], acceptTypes[i].length)) {\n          checkSuccess = true;\n        }\n      }\n      if (!checkSuccess) {\n        showErrorInfo(this, this.$t(\"FileFormatWarning\"));\n        return false;\n      }\n      //check file size\n      if (this.maxSize > 0 && info.size > this.maxSize) {\n        showErrorInfo(this, this.$t(\"UploadingFileTooLargeWarning\"));\n        return false;\n      }\n      //check file name\n      if (info.name.length > 127) {\n        showErrorInfo(this, this.$t(\"WarningFileNameTooLong\"));\n        return false;\n      }\n\n      let oldValue = deepClone(this.value);\n      this.value.fileData = info;\n      this.value.fileName = info.name;\n      this.onChange(oldValue);\n      this.upload(info, this.index);\n      return false;\n    },\n    onChange: function (oldVal) {\n      let data = {\n        newVal: {\n          fileName: this.value.fileName,\n          fileData: this.value.fileData,\n        },\n        oldVal: oldVal,\n      };\n      this.$emit(\"change\", data);\n    },\n    onCancel: function () {\n      let oldValue = deepClone(this.value);\n      this.value.fileName = \"\";\n      this.value.fileData = {};\n      this.onChange(oldValue);\n    },\n  },\n};\n</script>\n\n\n<style lang=\"less\" scoped>\n.ak-table-file-input-div {\n  font-size: 16px;\n}\n\n.ak-table-file-input-file-name {\n  width: 320px;\n  border: 1px solid rgba(201, 201, 201, 1);\n  border-radius: 3px;\n  height: 32px;\n  background: #ffffff;\n  color: #999999;\n  font-size: 16px;\n  padding-left: 16px;\n  font-weight: 400;\n  text-align: left;\n  line-height: 1.9;\n}\n\n.ak-table-file-input-file-name > label {\n  text-overflow: ellipsis;\n  overflow: hidden;\n  max-width: 190px;\n  display: inline-block;\n  white-space: nowrap;\n}\n\n.ak-table-file-input-file-button {\n  float: right;\n  width: 110px;\n  border-radius: 3px;\n  border: none;\n  background: #0087f7;\n  font-size: 16px;\n  color: #ffffff;\n  height: 30px !important;\n}\n\n/deep/.ant-btn:hover,\n.ant-btn:focus,\n.ant-btn:active,\n.ant-btn.active {\n  background: #0087f7;\n  color: #ffffff;\n}\n\n.ak-table-file-input-btn {\n  flex: 1;\n  margin-left: 30px;\n  min-width: 120px;\n  max-width: 120px;\n  background: rgba(255, 243, 243, 1);\n  border: 1px solid rgba(255, 99, 101, 1);\n  border-radius: 5px;\n  color: #f55b5f;\n  font-size: 16px;\n}\n\n/deep/.ant-btn-danger:hover,\n/deep/.ant-btn-danger:focus {\n  background: rgba(255, 243, 243, 1);\n  border: 1px solid rgba(255, 99, 101, 1);\n  border-radius: 5px;\n  color: #f55b5f;\n}\n\n.ant-btn-danger[disabled] > i {\n  color: rgba(0, 0, 0, 0.25);\n}\n</style>"]}]}