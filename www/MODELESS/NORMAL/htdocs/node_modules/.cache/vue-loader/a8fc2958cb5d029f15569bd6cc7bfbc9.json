{"remainingRequest":"E:\\workspace\\resources\\www\\MODELESS\\NORMAL\\htdocs\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\workspace\\resources\\www\\MODELESS\\NORMAL\\htdocs\\src\\components\\ModalFileInput.vue?vue&type=style&index=0&id=1071859e&lang=less&scoped=true&","dependencies":[{"path":"E:\\workspace\\resources\\www\\MODELESS\\NORMAL\\htdocs\\src\\components\\ModalFileInput.vue","mtime":1624613275271},{"path":"E:\\workspace\\resources\\www\\MODELESS\\NORMAL\\htdocs\\node_modules\\css-loader\\dist\\cjs.js","mtime":1624613263505},{"path":"E:\\workspace\\resources\\www\\MODELESS\\NORMAL\\htdocs\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1624613274497},{"path":"E:\\workspace\\resources\\www\\MODELESS\\NORMAL\\htdocs\\node_modules\\postcss-loader\\src\\index.js","mtime":1624613269221},{"path":"E:\\workspace\\resources\\www\\MODELESS\\NORMAL\\htdocs\\node_modules\\less-loader\\dist\\cjs.js","mtime":1624613267555},{"path":"E:\\workspace\\resources\\www\\MODELESS\\NORMAL\\htdocs\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1624613261239},{"path":"E:\\workspace\\resources\\www\\MODELESS\\NORMAL\\htdocs\\node_modules\\vue-loader\\lib\\index.js","mtime":1624613274496}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoNCi5hay1tb2RhbC1maWxlLWlucHV0LWRpdiB7DQogIHBhZGRpbmctbGVmdDogMTEwcHg7DQogIGZvbnQtc2l6ZTogMTZweDsNCiAgbWFyZ2luLXRvcDogMjVweDsNCn0NCg0KLmFrLW1vZGFsLWZpbGUtaW5wdXQtdGl0bGUtbGFiZWwgew0KICBtYXgtd2lkdGg6IDcwMHB4Ow0KICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7DQogIG92ZXJmbG93OiBoaWRkZW47DQogIHRleHQtb3ZlcmZsb3c6IGVsbGlwc2lzOw0KICB3aGl0ZS1zcGFjZTogbm93cmFwOw0KICBwYWRkaW5nLXRvcDogNHB4Ow0KICBtYXJnaW4tYm90dG9tOiAyNnB4Ow0KICBjb2xvcjogIzMzMzMzMzsNCn0NCg0KLmFrLW1vZGFsLWZpbGUtaW5wdXQtaGludC1sYWJlbCB7DQogIGNvbG9yOiAjOWE5YTlhOw0KICBtYXJnaW4tbGVmdDogMTBweDsNCiAgcGFkZGluZy10b3A6IDRweDsNCn0NCg0KLmFrLW1vZGFsLWZpbGUtaW5wdXQtZmlsZS1uYW1lIHsNCiAgd2lkdGg6IDM4MHB4Ow0KICBib3JkZXI6IDFweCBzb2xpZCByZ2JhKDIwMSwgMjAxLCAyMDEsIDEpOw0KICBib3JkZXItcmFkaXVzOiAzcHg7DQogIGhlaWdodDogMzJweDsNCiAgYmFja2dyb3VuZDogcmdiYSgyNDksIDI0OSwgMjQ5LCAxKTsNCiAgY29sb3I6ICM5OTk5OTk7DQogIGZvbnQtc2l6ZTogMTZweDsNCiAgcGFkZGluZy1sZWZ0OiAxNnB4Ow0KICBmb250LXdlaWdodDogNDAwOw0KfQ0KDQouYWstbW9kYWwtZmlsZS1pbnB1dC1maWxlLWJ1dHRvbiB7DQogIGZsb2F0OiByaWdodDsNCiAgd2lkdGg6IDExMHB4Ow0KICBib3JkZXItcmFkaXVzOiAzcHg7DQogIGJvcmRlcjogbm9uZTsNCiAgYmFja2dyb3VuZDogIzAwODdmNzsNCiAgZm9udC1zaXplOiAxNnB4Ow0KICBjb2xvcjogI2ZmZmZmZjsNCiAgaGVpZ2h0OiAzMHB4ICFpbXBvcnRhbnQ7DQp9DQoNCi5hay1tb2RhbC1maWxlLWlucHV0LWZpbGUtbmFtZSA+IGxhYmVsIHsNCiAgZGlzcGxheTogaW5saW5lLWJsb2NrOw0KICBtYXJnaW4tdG9wOiAycHg7DQogIG1heC13aWR0aDogMjUwcHg7DQogIG92ZXJmbG93OiBoaWRkZW47DQogIHRleHQtb3ZlcmZsb3c6IGVsbGlwc2lzOw0KICB3aGl0ZS1zcGFjZTogbm93cmFwOw0KfQ0KDQovZGVlcC8uYW50LWJ0bjpob3ZlciwNCi5hbnQtYnRuOmZvY3VzLA0KLmFudC1idG46YWN0aXZlLA0KLmFudC1idG4uYWN0aXZlIHsNCiAgYmFja2dyb3VuZDogIzAwODdmNzsNCiAgY29sb3I6ICNmZmZmZmY7DQp9DQoNCi5hay1tb2RhbC1maWxlLWlucHV0LWJ0biB7DQogIHdpZHRoOiAxMjBweDsNCiAgYmFja2dyb3VuZDogIzAwODdmNzsNCiAgY29sb3I6ICNmZmZmZmY7DQogIGZvbnQtc2l6ZTogMTZweDsNCiAgbWFyZ2luLWxlZnQ6IDMwcHg7DQp9DQo="},{"version":3,"sources":["ModalFileInput.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwKA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ModalFileInput.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n  <div class=\"ak-modal-file-input-div\">\r\n    <div>\r\n      <label class=\"ak-modal-file-input-title-label\">{{labelTitle}}</label>\r\n    </div>\r\n    <div :style=\"{display:'flex'}\">\r\n      <div class=\"ak-modal-file-input-file-name\">\r\n        <label>{{value.fileName}}</label>\r\n        <a-upload\r\n          name=\"file\"\r\n          :showUploadList=\"false\"\r\n          :accept=\"acceptFileType\"\r\n          :beforeUpload=\"beforeUpload\"\r\n          :style=\"{float:'right'}\"\r\n        >\r\n          <a-button type=\"file\" class=\"ak-modal-file-input-file-button\">{{$t('UpgradeFile')}}</a-button>\r\n        </a-upload>\r\n      </div>\r\n      <a-button\r\n        type=\"primary\"\r\n        class=\"ak-modal-file-input-btn\"\r\n        @click=\"onCancel\"\r\n        :disabled=\"importBtnDisabled\"\r\n      >\r\n        <MyIcon type=\"iconreset\" :style=\"{fontSize:'16px',paddingRight:'6px'}\"></MyIcon>\r\n        {{ importBtnName }}\r\n      </a-button>\r\n\r\n      <Popover\r\n        :showDescription=\"showDescription\"\r\n        :descriptionContent=\"descriptionContent\"\r\n        :style=\"{paddingLeft:'50px'}\"\r\n      ></Popover>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Popover from \"@/components/Popover.vue\";\r\nimport { checkFileFormat, showErrorInfo, checkShellRule } from \"@/js/common.js\";\r\nexport default {\r\n  components: {\r\n    Popover,\r\n  },\r\n  props: {\r\n    showDescription: { type: Boolean, default: false },\r\n    descriptionContent: String,\r\n    labelTitle: String,\r\n    acceptFileType: { type: String, default: \"\" },\r\n    importBtnName: { type: String, default: \"Import\" },\r\n    uploadFunction: {\r\n      type: Function,\r\n      default: function () {\r\n        console.log(\"click import\");\r\n      },\r\n    },\r\n    value: Object,\r\n    maxSize: { type: Number, default: 50 * 1024 * 1024 },\r\n    imgResolutionWidth: { type: Number, default: -1 },\r\n    imgResolutionHeight: { type: Number, default: -1 },\r\n  },\r\n  methods: {\r\n    beforeUpload: function (info) {\r\n      //check format\r\n      let acceptTypes = this.acceptFileType.split(\",\");\r\n      let checkSuccess = false;\r\n      if (!checkShellRule(info.name)) {\r\n        showErrorInfo(this, this.$t(\"FileNameShellError\"));\r\n        return false;\r\n      }\r\n      for (let i = 0; i < acceptTypes.length; i++) {\r\n        if (checkFileFormat(info.name, acceptTypes[i], acceptTypes[i].length)) {\r\n          checkSuccess = true;\r\n        }\r\n      }\r\n      if (!checkSuccess) {\r\n        showErrorInfo(this, this.$t(\"FileFormatWarning\"));\r\n        return false;\r\n      }\r\n      //check file size\r\n      if (this.maxSize > 0 && info.size > this.maxSize) {\r\n        showErrorInfo(this, this.$t(\"UploadingFileTooLargeWarning\"));\r\n        return false;\r\n      }\r\n      //check file name\r\n      if (info.name.length > 127) {\r\n        showErrorInfo(this, this.$t(\"WarningFileNameTooLong\"));\r\n        return false;\r\n      }\r\n\r\n      //check img resolution\r\n      if (\r\n        (checkFileFormat(info.name, \".PNG\", 4) ||\r\n          checkFileFormat(info.name, \".JPG\", 4) ||\r\n          checkFileFormat(info.name, \".JPEG\", 5)) &&\r\n        this.imgResolutionWidth > 0 &&\r\n        this.imgResolutionHeight > 0\r\n      ) {\r\n        var reader = new FileReader();\r\n        reader.readAsDataURL(info);\r\n        var vm = this;\r\n        reader.onload = function () {\r\n          var img = new Image();\r\n          img.src = reader.result;\r\n          img.onload = function () {\r\n            if (\r\n              img.width > vm.imgResolutionWidth ||\r\n              img.height > vm.imgResolutionHeight\r\n            ) {\r\n              showErrorInfo(vm, vm.$t(\"ImageResolutionErr\"));\r\n              return false;\r\n            } else {\r\n              info.height = img.height;\r\n              info.width = img.width;\r\n              vm.fileData = info;\r\n              vm.value.fileName = info.name;\r\n              vm.onChange();\r\n              return false;\r\n            }\r\n          };\r\n          img.onerror = function () {\r\n            //图片加载错误\r\n            showErrorInfo(vm, vm.$t(\"FileFormatWarning\"));\r\n            return false;\r\n          };\r\n        };\r\n      } else {\r\n        //done\r\n        this.fileData = info;\r\n        this.value.fileName = info.name;\r\n        this.onChange();\r\n        return false;\r\n      }\r\n    },\r\n    onChange: function () {\r\n      let data = {\r\n        fileName: this.value.fileName,\r\n        fileData: this.fileData,\r\n      };\r\n      this.$emit(\"change\", data);\r\n    },\r\n    onCancel: function () {\r\n      this.value.fileName = this.$t(\"UpgradeFilePath\");\r\n      this.fileData = {};\r\n      this.onChange();\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      // fileName: this.$t(\"UpgradeFilePath\"),\r\n      fileData: {},\r\n      importBtnDisabled: true,\r\n    };\r\n  },\r\n  watch: {\r\n    value(newVal, oldVal) {\r\n      let fileName = newVal.fileName;\r\n      if (fileName != \"\" && fileName != this.$t(\"UpgradeFilePath\")) {\r\n        this.importBtnDisabled = false;\r\n      } else {\r\n        this.importBtnDisabled = true;\r\n      }\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.ak-modal-file-input-div {\r\n  padding-left: 110px;\r\n  font-size: 16px;\r\n  margin-top: 25px;\r\n}\r\n\r\n.ak-modal-file-input-title-label {\r\n  max-width: 700px;\r\n  display: inline-block;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  white-space: nowrap;\r\n  padding-top: 4px;\r\n  margin-bottom: 26px;\r\n  color: #333333;\r\n}\r\n\r\n.ak-modal-file-input-hint-label {\r\n  color: #9a9a9a;\r\n  margin-left: 10px;\r\n  padding-top: 4px;\r\n}\r\n\r\n.ak-modal-file-input-file-name {\r\n  width: 380px;\r\n  border: 1px solid rgba(201, 201, 201, 1);\r\n  border-radius: 3px;\r\n  height: 32px;\r\n  background: rgba(249, 249, 249, 1);\r\n  color: #999999;\r\n  font-size: 16px;\r\n  padding-left: 16px;\r\n  font-weight: 400;\r\n}\r\n\r\n.ak-modal-file-input-file-button {\r\n  float: right;\r\n  width: 110px;\r\n  border-radius: 3px;\r\n  border: none;\r\n  background: #0087f7;\r\n  font-size: 16px;\r\n  color: #ffffff;\r\n  height: 30px !important;\r\n}\r\n\r\n.ak-modal-file-input-file-name > label {\r\n  display: inline-block;\r\n  margin-top: 2px;\r\n  max-width: 250px;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  white-space: nowrap;\r\n}\r\n\r\n/deep/.ant-btn:hover,\r\n.ant-btn:focus,\r\n.ant-btn:active,\r\n.ant-btn.active {\r\n  background: #0087f7;\r\n  color: #ffffff;\r\n}\r\n\r\n.ak-modal-file-input-btn {\r\n  width: 120px;\r\n  background: #0087f7;\r\n  color: #ffffff;\r\n  font-size: 16px;\r\n  margin-left: 30px;\r\n}\r\n</style>"]}]}