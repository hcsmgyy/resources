{"remainingRequest":"E:\\code\\resources\\www\\MODELESS\\NORMAL\\htdocs\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\code\\resources\\www\\MODELESS\\NORMAL\\htdocs\\src\\views\\PhoneCallFeature.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\code\\resources\\www\\MODELESS\\NORMAL\\htdocs\\src\\views\\PhoneCallFeature.vue","mtime":1628736725838},{"path":"E:\\code\\resources\\www\\MODELESS\\NORMAL\\htdocs\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1624613261239},{"path":"E:\\code\\resources\\www\\MODELESS\\NORMAL\\htdocs\\node_modules\\babel-loader\\lib\\index.js","mtime":1624613260275},{"path":"E:\\code\\resources\\www\\MODELESS\\NORMAL\\htdocs\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1624613261239},{"path":"E:\\code\\resources\\www\\MODELESS\\NORMAL\\htdocs\\node_modules\\vue-loader\\lib\\index.js","mtime":1624613274496}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KDQppbXBvcnQgQ29tbW9uUGFnZSBmcm9tICJAL2NvbXBvbmVudHMvQ29tbW9uUGFnZS52dWUiOw0KaW1wb3J0IG1vbWVudCBmcm9tICJtb21lbnQiOw0KaW1wb3J0IHsNCiAgc2hvd1JlcXVlc3RTdWNjZXNzLA0KICBkZWVwQ2xvbmUsDQogIGdldEVuYWJsZVNlbGVjdEl0ZW1zLA0KICBnZXRJdGVtQnlLZXksDQogIGNoZWNrUmFuZ2VPZk51bWJlciwNCiAgZ2V0SW5kZXhCeUtleSwNCiAgc2hvd0Vycm9ySW5mbywNCiAgY2hlY2tGaWxlRm9ybWF0LA0KICBzaG93V2FybmluZ0luZm8sDQp9IGZyb20gIkAvanMvY29tbW9uLmpzIjsNCg0KY29uc3QgcmV0dXJuQ29kZUl0ZW1zID0gWw0KICB7IGtleTogNDA0LCBsYWJlbDogIjQwNChOb3QgRm91bmQpIiB9LA0KICB7IGtleTogNDgwLCBsYWJlbDogIjQ4MChUZW1wb3JhcmlseSBVbmF2YWlsYWJsZSkiIH0sDQogIHsga2V5OiA0ODYsIGxhYmVsOiAiNDg2KEJ1c3kgSGVyZSkiIH0sDQogIHsga2V5OiA2MDMsIGxhYmVsOiAiNjAzKERlY2xpbmUpIiB9LA0KXTsNCg0KZXhwb3J0IGRlZmF1bHQgew0KICBjb21wb25lbnRzOiB7DQogICAgQ29tbW9uUGFnZSwNCiAgfSwNCiAgZGF0YSgpIHsNCiAgICByZXR1cm4gew0KICAgICAgY2hhbmdlZENmZ0RhdGE6IHt9LA0KICAgICAgc3VibWl0Q2ZnRGF0YToge30sDQogICAgICBhcGlEYXRhOiB7fSwNCiAgICAgIGRhdGE6IHsNCiAgICAgICAgZ2V0RGF0YVN1Y2Nlc3M6IGZhbHNlLA0KICAgICAgfSwNCiAgICB9Ow0KICB9LA0KICBjcmVhdGVkKCkgew0KICAgIGdldERhdGEodGhpcyk7DQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICBvbkNvbW1vblBhZ2VEYXRhQ2hhbmdlOiBmdW5jdGlvbiAoZXZlbnQpIHsNCiAgICAgIHNldENoYW5nZWREYXRhKHRoaXMsIGV2ZW50KTsNCiAgICAgIC8v55WM6Z2i5Y+Y5YyWDQogICAgICBoYW5kbGVyUGFnZUNoYW5nZWQodGhpcyk7DQogICAgfSwNCiAgfSwNCn07DQoNCmZ1bmN0aW9uIHNldENoYW5nZWREYXRhKHZtLCBldmVudCkgew0KICBpZiAoDQogICAgZXZlbnQuaXRlbUtleSA9PSAiQ29uZmlnLkZlYXR1cmVzLkRORC5TdGFydFRpbWUiIHx8DQogICAgZXZlbnQuaXRlbUtleSA9PSAiQ29uZmlnLkZlYXR1cmVzLkRORC5FbmRUaW1lIg0KICApIHsNCiAgICB2bS5jaGFuZ2VkQ2ZnRGF0YVtldmVudC5pdGVtS2V5XSA9DQogICAgICBldmVudC5uZXdWYWwudG9EYXRlKCkuZ2V0SG91cnMoKSArDQogICAgICAiOiIgKw0KICAgICAgZXZlbnQubmV3VmFsLnRvRGF0ZSgpLmdldE1pbnV0ZXMoKTsNCiAgfSBlbHNlIHsNCiAgICB2bS5jaGFuZ2VkQ2ZnRGF0YVtldmVudC5pdGVtS2V5XSA9IGV2ZW50Lm5ld1ZhbDsNCiAgfQ0KfQ0KDQpmdW5jdGlvbiBoYW5kbGVyUGFnZUNoYW5nZWQodm0pIHsNCiAgbGV0IHNjaGVkdWxlTW9kZUl0ZW0gPSBnZXRJdGVtQnlLZXkoDQogICAgdm0uZGF0YSwNCiAgICAiRE5EIiwNCiAgICAiQ29uZmlnLkZlYXR1cmVzLkRORC5TY2hlZHVsZU1vZGUiDQogICk7DQogIGxldCBkbmRTdGFydFRpbWVJdGVtID0gZ2V0SXRlbUJ5S2V5KA0KICAgIHZtLmRhdGEsDQogICAgIkRORCIsDQogICAgIkNvbmZpZy5GZWF0dXJlcy5ETkQuU3RhcnRUaW1lIg0KICApOw0KICBsZXQgZG5kRW5kVGltZUl0ZW0gPSBnZXRJdGVtQnlLZXkoDQogICAgdm0uZGF0YSwNCiAgICAiRE5EIiwNCiAgICAiQ29uZmlnLkZlYXR1cmVzLkRORC5FbmRUaW1lIg0KICApOw0KICBpZiAodm0uY2hhbmdlZENmZ0RhdGFbIkNvbmZpZy5GZWF0dXJlcy5ETkQuV2hvbGVEYXkiXSA9PSAiMSIpIHsNCiAgICBzY2hlZHVsZU1vZGVJdGVtLmRpc2FibGVkID0gdHJ1ZTsNCiAgICBkbmRTdGFydFRpbWVJdGVtLmRpc2FibGVkID0gdHJ1ZTsNCiAgICBkbmRFbmRUaW1lSXRlbS5kaXNhYmxlZCA9IHRydWU7DQogIH0gZWxzZSB7DQogICAgc2NoZWR1bGVNb2RlSXRlbS5kaXNhYmxlZCA9IGZhbHNlOw0KICAgIGlmICh2bS5jaGFuZ2VkQ2ZnRGF0YVsiQ29uZmlnLkZlYXR1cmVzLkRORC5TY2hlZHVsZU1vZGUiXSA9PSAiMSIpIHsNCiAgICAgIGRuZFN0YXJ0VGltZUl0ZW0uZGlzYWJsZWQgPSBmYWxzZTsNCiAgICAgIGRuZEVuZFRpbWVJdGVtLmRpc2FibGVkID0gZmFsc2U7DQogICAgfSBlbHNlIHsNCiAgICAgIGRuZFN0YXJ0VGltZUl0ZW0uZGlzYWJsZWQgPSB0cnVlOw0KICAgICAgZG5kRW5kVGltZUl0ZW0uZGlzYWJsZWQgPSB0cnVlOw0KICAgIH0NCiAgfQ0KDQogIGxldCBzdGFydFRpbWVNaW4gPQ0KICAgIHZtLmNoYW5nZWRDZmdEYXRhWyJDb25maWcuRmVhdHVyZXMuRE5ELlN0YXJ0VGltZSJdLnNwbGl0KCI6IilbMF0gKiA2MCArDQogICAgdm0uY2hhbmdlZENmZ0RhdGFbIkNvbmZpZy5GZWF0dXJlcy5ETkQuU3RhcnRUaW1lIl0uc3BsaXQoIjoiKVsxXTsNCiAgbGV0IGVuZFRpbWVNaW4gPQ0KICAgIHZtLmNoYW5nZWRDZmdEYXRhWyJDb25maWcuRmVhdHVyZXMuRE5ELkVuZFRpbWUiXS5zcGxpdCgiOiIpWzBdICogNjAgKw0KICAgIHZtLmNoYW5nZWRDZmdEYXRhWyJDb25maWcuRmVhdHVyZXMuRE5ELkVuZFRpbWUiXS5zcGxpdCgiOiIpWzFdOw0KICBpZiAocGFyc2VJbnQoc3RhcnRUaW1lTWluKSA+PSBwYXJzZUludChlbmRUaW1lTWluKSkgew0KICAgIGRuZEVuZFRpbWVJdGVtLnNob3dIaW50ID0gdHJ1ZTsNCiAgfSBlbHNlIHsNCiAgICBkbmRFbmRUaW1lSXRlbS5zaG93SGludCA9IGZhbHNlOw0KICB9DQp9DQoNCmZ1bmN0aW9uIHN1Ym1pdERhdGEodm0pIHsNCiAgdm0uZGF0YS5zdWJtaXRMb2FkaW5nID0gdHJ1ZTsNCg0KICBsZXQgcmVxdWVzdERhdGEgPSB7DQogICAgdGFyZ2V0OiAicGhvbmVDYWxsRmVhdHVyZSIsDQogICAgYWN0aW9uOiAic2V0IiwNCiAgICBjb25maWdEYXRhOiB2bS5zdWJtaXRDZmdEYXRhLA0KICB9Ow0KICB2bS4kYXhpb3MucG9zdCgiYXBpIiwgcmVxdWVzdERhdGEpLnRoZW4oKHJlc3BvbnNlKSA9PiB7DQogICAgaWYgKCJ1bmRlZmluZWQiICE9IHR5cGVvZiByZXNwb25zZSkgew0KICAgICAgc2hvd1JlcXVlc3RTdWNjZXNzKHZtKTsNCiAgICB9DQogICAgdm0uZGF0YS5zdWJtaXRMb2FkaW5nID0gZmFsc2U7DQogIH0pOw0KfQ0KDQpmdW5jdGlvbiBnZXREYXRhKHZtKSB7DQogIHZtLiRheGlvcy5nZXQoImFwaS9waG9uZUNhbGxGZWF0dXJlL2luZm8iKS50aGVuKChyZXNwb25zZSkgPT4gew0KICAgIHZtLmdldERhdGFTdWNjZXNzID0gdHJ1ZTsNCiAgICB2bS5hcGlEYXRhID0gcmVzcG9uc2UuZGF0YTsNCiAgICB2bS5jaGFuZ2VkQ2ZnRGF0YSA9IGRlZXBDbG9uZShyZXNwb25zZS5kYXRhLmNvbmZpZ0RhdGEpOw0KICAgIGNyZWF0ZVBhZ2VEYXRhKHZtKTsNCiAgICBoYW5kbGVyUGFnZUNoYW5nZWQodm0pOw0KICB9KTsNCn0NCg0KZnVuY3Rpb24gZ2V0Q29tbWl0RGF0YSh2bSkgew0KICB2bS5zdWJtaXRDZmdEYXRhID0ge307DQogIGZvciAodmFyIGNoYW5nZWRLZXkgaW4gdm0uY2hhbmdlZENmZ0RhdGEpIHsNCiAgICBpZiAodm0uYXBpRGF0YS5jb25maWdEYXRhW2NoYW5nZWRLZXldICE9IHZtLmNoYW5nZWRDZmdEYXRhW2NoYW5nZWRLZXldKSB7DQogICAgICB2bS5zdWJtaXRDZmdEYXRhW2NoYW5nZWRLZXldID0gdm0uY2hhbmdlZENmZ0RhdGFbY2hhbmdlZEtleV07DQogICAgfQ0KICB9DQp9DQoNCmZ1bmN0aW9uIGNyZWF0ZVBhZ2VEYXRhKHZtKSB7DQogIHZtLmRhdGEgPSB7DQogICAgZ2V0RGF0YVN1Y2Nlc3M6IHRydWUsDQogICAgYnJlYWRDcnVtYjogew0KICAgICAgZmlyc3RUaXRsZTogdm0uJHQoIlBob25lIiksDQogICAgICBzZWNvbmRUaXRsZTogdm0uJHQoIkNhbGxGZWF0dXJlIiksDQogICAgfSwNCiAgICBvblN1Ym1pdDogZnVuY3Rpb24gKCkgew0KICAgICAgaWYgKCFjaGVja0NvbW1pdERhdGEodm0pKSB7DQogICAgICAgIHJldHVybjsNCiAgICAgIH0NCiAgICAgIGdldENvbW1pdERhdGEodm0pOw0KICAgICAgc3VibWl0RGF0YSh2bSk7DQogICAgfSwNCiAgICBvbkNhbmNlbDogZnVuY3Rpb24gKCkgew0KICAgICAgdm0uZGF0YS5jYW5jZWxMb2FkaW5nID0gdHJ1ZTsNCiAgICAgIGdldERhdGEodm0pOw0KICAgIH0sDQogICAgc3VibWl0TG9hZGluZzogZmFsc2UsDQogICAgY2FuY2VsTG9hZGluZzogZmFsc2UsDQogICAgY29udGVudHM6IFtdLA0KICB9Ow0KDQogIHZtLmRhdGEuY29udGVudHMucHVzaChjcmVhdGVGb3J3YXJkQ29udGVudCh2bSkpOw0KICB2bS5kYXRhLmNvbnRlbnRzLnB1c2goY3JlYXRlRE5EQ29udGVudCh2bSkpOw0KICB2bS5kYXRhLmNvbnRlbnRzLnB1c2goY3JlYXRlQXVkaW9DYWxsU2V0dGluZ0NvbnRlbnQodm0pKTsNCiAgdm0uZGF0YS5jb250ZW50cy5wdXNoKGNyZWF0ZU90aGVyc0NvbnRlbnQodm0pKTsNCiAgdm0uZGF0YS5jb250ZW50cy5wdXNoKGNyZWF0ZUFsbG93bGlzdHNDb250ZW50KHZtKSk7DQogIGdldEFsbG93VGFibGVEYXRhKHZtLCAxKTsNCn0NCg0KZnVuY3Rpb24gY3JlYXRlQWxsb3dsaXN0c0NvbnRlbnQodm0pIHsNCiAgLy/mt7vliqDmoYYNCiAgbGV0IGFkZE1vZGFsRGF0YSA9IHsNCiAgICB0aXRsZTogdm0uJHQoIkFkZExhYmVsIikgKyAiICIgKyB2bS4kdCgiQXV0b0Fuc3dlcldoaXRlbGlzdCIpLA0KICAgIGtleTogLTEsDQogICAgY2FuY2VsQnRuTGFiZWw6IHZtLiR0KCJDYW5jZWwiKSwNCiAgICBzdWJtaXRCdG5MYWJlbDogdm0uJHQoIlN1Ym1pdCIpLA0KICAgIHZpc2libGU6IGZhbHNlLA0KICAgIHNob3dGb290ZXI6IHRydWUsDQogICAgaXRlbXM6IFsNCiAgICAgIHsNCiAgICAgICAgdGl0bGU6IHZtLiR0KCJEZXZpY2VMb2NhdGlvbiIpLA0KICAgICAgICB0eXBlOiAiaW5wdXQiLA0KICAgICAgICBrZXk6ICJkZXZpY2VMb2NhdGlvbiIsDQogICAgICAgIHZhbHVlOiAiIiwNCiAgICAgICAgaXNXYXJuOiBmYWxzZSwNCiAgICAgICAgd2FybkxhYmVsOiB2bS4kdCgiQWxsb3dEZXZpY2VOb0VtcHR5IiksDQogICAgICAgIGRlc2NyaXB0aW9uOiB2bS4kdCgiQWxsb3dEZXZpY2VMb2NhdGlvbkRlc2MiKSwNCiAgICAgIH0sDQogICAgICB7DQogICAgICAgIHRpdGxlOiB2bS4kdCgiRGV2aWNlTnVtYmVyIiksDQogICAgICAgIHR5cGU6ICJpbnB1dCIsDQogICAgICAgIGtleTogImRldmljZU51bWJlciIsDQogICAgICAgIHZhbHVlOiAiIiwNCiAgICAgICAgaXNXYXJuOiBmYWxzZSwNCiAgICAgICAgd2FybkxhYmVsOiB2bS4kdCgiQWxsb3dJUFNJUE5vRW1wdHkiKSwNCiAgICAgICAgZGVzY3JpcHRpb246IHZtLiR0KCJBbGxvd1NJUERlc2MiKSwNCiAgICAgIH0sDQogICAgXSwNCiAgICBvbkNvbmZpcm06IGZ1bmN0aW9uICgpIHsNCiAgICAgIG9uQ2hhbmdlQWxsb3dMaXN0KHZtKTsNCiAgICB9LA0KICB9Ow0KDQogIC8v5a+85YWl5qGGDQogIGxldCBpbXBvcnRNb2RhbERhdGEgPSB7DQogICAgdGl0bGU6ICIgIiwNCiAgICBjYW5jZWxCdG5MYWJlbDogdm0uJHQoIkNhbmNlbCIpLA0KICAgIHN1Ym1pdEJ0bkxhYmVsOiB2bS4kdCgiSW1wb3J0IiksDQogICAgc2hvd0Zvb3RlcjogdHJ1ZSwNCiAgICB2aXNpYmxlOiBmYWxzZSwNCiAgICBpdGVtczogWw0KICAgICAgew0KICAgICAgICB0aXRsZTogdm0uJHQoIkFsbG93TGlzdEltcG9ydEhpbnQiKSwNCiAgICAgICAgdHlwZTogImZpbGUtaW5wdXQiLA0KICAgICAgICBrZXk6ICJpbXBvcnQiLA0KICAgICAgICBhY2NlcHRGaWxlVHlwZTogIi54bWwsLmNzdiIsDQogICAgICAgIGxvYWRpbmc6IGZhbHNlLA0KICAgICAgICB2YWx1ZTogew0KICAgICAgICAgIGZpbGVEYXRhOiB7fSwNCiAgICAgICAgICBmaWxlTmFtZTogdm0uJHQoIlVwZ3JhZGVGaWxlUGF0aCIpLA0KICAgICAgICB9LA0KICAgICAgICBpbXBvcnRCdG5OYW1lOiB2bS4kdCgiUmVzZXQiKSwNCiAgICAgIH0sDQogICAgXSwNCiAgICBvbkNvbmZpcm06IGZ1bmN0aW9uICgpIHsNCiAgICAgIG9uSW1wb3J0KHZtKTsNCiAgICB9LA0KICAgIGNvbmZpcm1Mb2FkaW5nOiBmYWxzZSwNCiAgfTsNCg0KICAvL+ihqOWktOaVsOaNrg0KICBsZXQgdGFibGVIZWFkRGF0YSA9IHsNCiAgICBhZGRNb2RhbERhdGE6IGFkZE1vZGFsRGF0YSwNCiAgICBpbXBvcnRNb2RhbERhdGE6IGltcG9ydE1vZGFsRGF0YSwNCiAgICBleHBvcnRJdGVtczogWw0KICAgICAgeyBrZXk6ICJ4bWwiLCBsYWJlbDogInhtbCIgfSwNCiAgICAgIHsga2V5OiAiY3N2IiwgbGFiZWw6ICJjc3YiIH0sDQogICAgXSwNCiAgICBvbkV4cG9ydDogZnVuY3Rpb24gKHR5cGUpIHsNCiAgICAgIG9uRXhwb3J0KHZtLCB0eXBlKTsNCiAgICB9LA0KICB9Ow0KDQogIC8v6KGo5bC+5pWw5o2uDQogIGxldCB0YWJsZUZvb3RlckRhdGEgPSB7DQogICAgb25EZWxldGU6IGZ1bmN0aW9uICgpIHsNCiAgICAgIG9uRGVsZXRlQWxsb3dMaXN0KHZtLCAic2VsZWN0Iik7DQogICAgfSwNCiAgICBvbkRlbGV0ZUFsbDogZnVuY3Rpb24gKCkgew0KICAgICAgb25EZWxldGVBbGxvd0xpc3Qodm0sICJhbGwiKTsNCiAgICB9LA0KICAgIG9uUGFnZUNoYW5nZTogZnVuY3Rpb24gKHBhZ2UpIHsNCiAgICAgIGdldEFsbG93VGFibGVEYXRhKHZtLCBwYWdlKTsNCiAgICB9LA0KICAgIHN1bTogMCwNCiAgICBwYWdlTnVtYmVyOiAxMCwNCiAgICBjdXJQYWdlOiAwLA0KICAgIGRlbGV0ZURpc2FibGVkOiB0cnVlLA0KICAgIGRlbGV0ZUFsbERpc2FibGVkOiBmYWxzZSwNCiAgfTsNCg0KICAvL+ihqOagvOaVsOaNrg0KDQogIGxldCBjb250ZW50ID0gew0KICAgIGtleTogImFsbG93bGlzdCIsDQogICAgdGl0bGU6IHZtLiR0KCJBdXRvQW5zd2VyV2hpdGVsaXN0IiksDQogICAgdGl0bGVEZXNjcmlwdGlvbjogdm0uJHQoIkFsbG93bGlzdERlc2MiKSwNCiAgICBpdGVtczogWw0KICAgICAgew0KICAgICAgICB0eXBlOiAidGFibGUiLA0KICAgICAgICBrZXk6ICJhbGxvd2xpc3QiLA0KICAgICAgICBzaG93SGVhZDogdHJ1ZSwNCiAgICAgICAgc2hvd0Zvb3RlcjogdHJ1ZSwNCiAgICAgICAgc2hvd1Jvd1NlbGVjdGlvbjogdHJ1ZSwNCiAgICAgICAgc2VsZWN0ZWRSb3dLZXlzOiBbXSwNCiAgICAgICAgdGFibGVIZWFkRGF0YTogdGFibGVIZWFkRGF0YSwNCiAgICAgICAgdGFibGVGb290ZXJEYXRhOiB0YWJsZUZvb3RlckRhdGEsDQogICAgICAgIHRhYmxlRGF0YTogW10sDQogICAgICAgIHRhYmxlQ29sdW1uczogWw0KICAgICAgICAgIHsNCiAgICAgICAgICAgIHR5cGU6ICJsYWJlbCIsDQogICAgICAgICAgICB0aXRsZTogdm0uJHQoIkluZGV4IiksDQogICAgICAgICAgICBkYXRhSW5kZXg6ICJpbmRleCIsDQogICAgICAgICAgICBzY29wZWRTbG90czogeyBjdXN0b21SZW5kZXI6ICJpbmRleCIgfSwNCiAgICAgICAgICAgIGFsaWduOiAiY2VudGVyIiwNCiAgICAgICAgICAgIHdpZHRoOiAiMTAlIiwNCiAgICAgICAgICB9LA0KICAgICAgICAgIHsNCiAgICAgICAgICAgIHR5cGU6ICJsYWJlbCIsDQogICAgICAgICAgICB0aXRsZTogdm0uJHQoIkRldmljZUxvY2F0aW9uIiksDQogICAgICAgICAgICBkYXRhSW5kZXg6ICJkZXZpY2VMb2NhdGlvbiIsDQogICAgICAgICAgICBzY29wZWRTbG90czogeyBjdXN0b21SZW5kZXI6ICJkZXZpY2VMb2NhdGlvbiIgfSwNCiAgICAgICAgICAgIGFsaWduOiAiY2VudGVyIiwNCiAgICAgICAgICAgIHdpZHRoOiAiNDAlIiwNCiAgICAgICAgICB9LA0KICAgICAgICAgIHsNCiAgICAgICAgICAgIHR5cGU6ICJsYWJlbCIsDQogICAgICAgICAgICB0aXRsZTogdm0uJHQoIkRldmljZU51bWJlciIpLA0KICAgICAgICAgICAgZGF0YUluZGV4OiAiZGV2aWNlTnVtYmVyIiwNCiAgICAgICAgICAgIHNjb3BlZFNsb3RzOiB7IGN1c3RvbVJlbmRlcjogImRldmljZU51bWJlciIgfSwNCiAgICAgICAgICAgIGFsaWduOiAiY2VudGVyIiwNCiAgICAgICAgICAgIHdpZHRoOiAiNDAlIiwNCiAgICAgICAgICB9LA0KICAgICAgICAgIHsNCiAgICAgICAgICAgIHR5cGU6ICJlZGl0IiwNCiAgICAgICAgICAgIHRpdGxlOiB2bS4kdCgiRWRpdExhYmVsIiksDQogICAgICAgICAgICBkYXRhSW5kZXg6ICJlZGl0IiwNCiAgICAgICAgICAgIHNjb3BlZFNsb3RzOiB7IGN1c3RvbVJlbmRlcjogImVkaXQiIH0sDQogICAgICAgICAgICBhbGlnbjogImNlbnRlciIsDQogICAgICAgICAgICB3aWR0aDogIjEwJSIsDQogICAgICAgICAgICBvbkVkaXQ6IGZ1bmN0aW9uIChpbmRleCwga2V5KSB7DQogICAgICAgICAgICAgIGxldCBhbGxvd1RhYmxlSXRlbSA9IGdldEl0ZW1CeUtleSgNCiAgICAgICAgICAgICAgICB2bS5kYXRhLA0KICAgICAgICAgICAgICAgICJhbGxvd2xpc3QiLA0KICAgICAgICAgICAgICAgICJhbGxvd2xpc3QiDQogICAgICAgICAgICAgICk7DQogICAgICAgICAgICAgIC8vbG9jYXRpb24NCiAgICAgICAgICAgICAgYWxsb3dUYWJsZUl0ZW0udGFibGVIZWFkRGF0YS5hZGRNb2RhbERhdGEuaXRlbXNbDQogICAgICAgICAgICAgICAgZ2V0SW5kZXhCeUtleSgNCiAgICAgICAgICAgICAgICAgIGFsbG93VGFibGVJdGVtLnRhYmxlSGVhZERhdGEuYWRkTW9kYWxEYXRhLml0ZW1zLA0KICAgICAgICAgICAgICAgICAgImRldmljZUxvY2F0aW9uIg0KICAgICAgICAgICAgICAgICkNCiAgICAgICAgICAgICAgXS52YWx1ZSA9IGFsbG93VGFibGVJdGVtLnRhYmxlRGF0YVtpbmRleF0uZGV2aWNlTG9jYXRpb247DQogICAgICAgICAgICAgIC8vbnVtYmVyDQogICAgICAgICAgICAgIGFsbG93VGFibGVJdGVtLnRhYmxlSGVhZERhdGEuYWRkTW9kYWxEYXRhLml0ZW1zWw0KICAgICAgICAgICAgICAgIGdldEluZGV4QnlLZXkoDQogICAgICAgICAgICAgICAgICBhbGxvd1RhYmxlSXRlbS50YWJsZUhlYWREYXRhLmFkZE1vZGFsRGF0YS5pdGVtcywNCiAgICAgICAgICAgICAgICAgICJkZXZpY2VOdW1iZXIiDQogICAgICAgICAgICAgICAgKQ0KICAgICAgICAgICAgICBdLnZhbHVlID0gYWxsb3dUYWJsZUl0ZW0udGFibGVEYXRhW2luZGV4XS5kZXZpY2VOdW1iZXI7DQogICAgICAgICAgICB9LA0KICAgICAgICAgIH0sDQogICAgICAgIF0sDQogICAgICB9LA0KICAgIF0sDQogIH07DQogIHJldHVybiBjb250ZW50Ow0KfQ0KDQpmdW5jdGlvbiBjcmVhdGVPdGhlcnNDb250ZW50KHZtKSB7DQogIGxldCBjb250ZW50ID0gew0KICAgIGtleTogIm90aGVycyIsDQogICAgdGl0bGU6IHZtLiR0KCJPdGhlcnMiKSwNCiAgICB0aXRsZURlc2NyaXB0aW9uOiB2bS4kdCgiQ2FsbEZlYXR1cmVPdGhlcnNEZXNjIiksDQogICAgaXRlbXM6IFsNCiAgICAgIHsNCiAgICAgICAgdGl0bGU6IHZtLiR0KCJSZXR1cm5Db2RlUmVmdXNlIiksDQogICAgICAgIHR5cGU6ICJzZWxlY3QiLA0KICAgICAgICBrZXk6ICJDb25maWcuRmVhdHVyZXMuUkVKRUNULlJldHVybkNvZGUiLA0KICAgICAgICB2YWx1ZTogdm0uYXBpRGF0YS5jb25maWdEYXRhWyJDb25maWcuRmVhdHVyZXMuUkVKRUNULlJldHVybkNvZGUiXSwNCiAgICAgICAgc2VsZWN0SXRlbXM6IHJldHVybkNvZGVJdGVtcywNCiAgICAgICAgZGVzY3JpcHRpb246IHZtLiR0KCJSZXR1cm5Db2RlUmVmdXNlRGVzYyIpLA0KICAgICAgfSwNCiAgICAgIHsNCiAgICAgICAgdGl0bGU6IHZtLiR0KCJBdXRvQW5zd2VyRGVsYXkiKSwNCiAgICAgICAgdHlwZTogImlucHV0IiwNCiAgICAgICAga2V5OiAiQ29uZmlnLkZlYXR1cmVzLkFVVE9BTlNXRVIuRGVsYXkiLA0KICAgICAgICB2YWx1ZTogdm0uYXBpRGF0YS5jb25maWdEYXRhWyJDb25maWcuRmVhdHVyZXMuQVVUT0FOU1dFUi5EZWxheSJdLA0KICAgICAgICBzaG93SGludDogdHJ1ZSwNCiAgICAgICAgaGludENvbnRlbnQ6ICIoIDB+MzAiICsgdm0uJHQoIlNlY29uZCIpICsgIiApIiwNCiAgICAgICAgaXNXYXJuOiBmYWxzZSwNCiAgICAgICAgd2FybkxhYmVsOiB2bS4kdCgiQXV0b0Fuc3dlckRlbGF5UmFuZ2VFcnJvciIpLA0KICAgICAgICBkZXNjcmlwdGlvbjogdm0uJHQoIkF1dG9BbnN3ZXJEZWxheURlc2MiKSwNCiAgICAgIH0sDQogICAgICB7DQogICAgICAgIHRpdGxlOiB2bS4kdCgiQW5zd2VyTW9kZSIpLA0KICAgICAgICB0eXBlOiAic2VsZWN0IiwNCiAgICAgICAga2V5OiAiQ29uZmlnLkZlYXR1cmVzLkFOU1dFUk1PREUuUHJpb3JpdHkiLA0KICAgICAgICB2YWx1ZTogdm0uYXBpRGF0YS5jb25maWdEYXRhWyJDb25maWcuRmVhdHVyZXMuQU5TV0VSTU9ERS5Qcmlvcml0eSJdLA0KICAgICAgICBzZWxlY3RJdGVtczogWw0KICAgICAgICAgIHsga2V5OiAwLCBsYWJlbDogdm0uJHQoIkF1ZGlvIikgfSwNCiAgICAgICAgICB7IGtleTogMSwgbGFiZWw6IHZtLiR0KCJWaWRlbyIpIH0sDQogICAgICAgIF0sDQogICAgICAgIGRlc2NyaXB0aW9uOiB2bS4kdCgiQW5zd2VyTW9kZURlc2MiKSwNCiAgICAgIH0sDQogICAgICB7DQogICAgICAgIHRpdGxlOiB2bS4kdCgiQW5zd2VyVG9uZSIpLA0KICAgICAgICB0eXBlOiAic2VsZWN0IiwNCiAgICAgICAga2V5OiAiQ29uZmlnLlNldHRpbmdzLkFVRElPLkFuc3dlclRvbmUiLA0KICAgICAgICB2YWx1ZTogdm0uYXBpRGF0YS5jb25maWdEYXRhWyJDb25maWcuU2V0dGluZ3MuQVVESU8uQW5zd2VyVG9uZSJdLA0KICAgICAgICBzZWxlY3RJdGVtczogWw0KICAgICAgICAgIHsga2V5OiAwLCBsYWJlbDogdm0uJHQoIkRpc2FibGVkIikgfSwNCiAgICAgICAgICB7IGtleTogMSwgbGFiZWw6IHZtLiR0KCJFbmFibGVkIikgfSwNCiAgICAgICAgXSwNCiAgICAgICAgZGVzY3JpcHRpb246IHZtLiR0KCJBbnN3ZXJNb2RlRGVzYyIpLA0KICAgICAgfSwNCiAgICAgIHsNCiAgICAgICAgdGl0bGU6IHZtLiR0KCJIYW5ndXBCdXN5VG9uZSIpLA0KICAgICAgICB0eXBlOiAiY2hlY2tib3giLA0KICAgICAgICBrZXk6ICJDb25maWcuU2V0dGluZ3MuR0VORVJBTC5IdW5nVXBCdXN5VG9uZSIsDQogICAgICAgIHZhbHVlOiB2bS5hcGlEYXRhLmNvbmZpZ0RhdGFbIkNvbmZpZy5TZXR0aW5ncy5HRU5FUkFMLkh1bmdVcEJ1c3lUb25lIl0sDQogICAgICAgIGRlc2NyaXB0aW9uOiB2bS4kdCgiQnVzeVRvbmVEZXNjIiksDQogICAgICB9LA0KICAgICAgew0KICAgICAgICB0aXRsZTogdm0uJHQoIkluZG9vckF1dG9BbnN3ZXIiKSwNCiAgICAgICAgdHlwZTogImNoZWNrYm94IiwNCiAgICAgICAga2V5OiAiQ29uZmlnLkZlYXR1cmVzLkFVVE9fQU5TV0VSLkluZG9vclRvSW5kb29yIiwNCiAgICAgICAgdmFsdWU6DQogICAgICAgICAgdm0uYXBpRGF0YS5jb25maWdEYXRhWyJDb25maWcuRmVhdHVyZXMuQVVUT19BTlNXRVIuSW5kb29yVG9JbmRvb3IiXSwNCiAgICAgICAgZGVzY3JpcHRpb246IHZtLiR0KCJJbmRvb3JBdXRvQW5zd2VyRGVzYyIpLA0KICAgICAgfSwNCiAgICAgIHsNCiAgICAgICAgdGl0bGU6IHZtLiR0KCJEaXJlY3RJUENhbGwiKSwNCiAgICAgICAgdHlwZTogImNoZWNrYm94IiwNCiAgICAgICAga2V5OiAiQ29uZmlnLlNldHRpbmdzLkdFTkVSQUwuRGlyZWN0SVAiLA0KICAgICAgICB2YWx1ZTogdm0uYXBpRGF0YS5jb25maWdEYXRhWyJDb25maWcuU2V0dGluZ3MuR0VORVJBTC5EaXJlY3RJUCJdLA0KICAgICAgICBkZXNjcmlwdGlvbjogdm0uJHQoIkRpcmVjdElQQ2FsbERlc2MiKSwNCiAgICAgIH0sDQogICAgICB7DQogICAgICAgIHRpdGxlOiB2bS4kdCgiRGlyZWN0SVBDYWxsUG9ydCIpLA0KICAgICAgICB0eXBlOiAiaW5wdXQiLA0KICAgICAgICBrZXk6ICJDb25maWcuU2V0dGluZ3MuR0VORVJBTC5EaXJlY3RJUFBvcnQiLA0KICAgICAgICB2YWx1ZTogdm0uYXBpRGF0YS5jb25maWdEYXRhWyJDb25maWcuU2V0dGluZ3MuR0VORVJBTC5EaXJlY3RJUFBvcnQiXSwNCiAgICAgICAgaXNXYXJuOiBmYWxzZSwNCiAgICAgICAgc2hvd0hpbnQ6IHRydWUsDQogICAgICAgIGhpbnRDb250ZW50OiAiKCAxfjY1NTM1ICkiLA0KICAgICAgICBkZXNjcmlwdGlvbjogdm0uJHQoIkRpcmVjdElQQ2FsbFBvcnREZXNjIiksDQogICAgICB9LA0KICAgIF0sDQogIH07DQogIHJldHVybiBjb250ZW50Ow0KfQ0KDQpmdW5jdGlvbiBjcmVhdGVBdWRpb0NhbGxTZXR0aW5nQ29udGVudCh2bSkgew0KICBsZXQgY29udGVudCA9IHsNCiAgICBrZXk6ICJhdWRpb0NhbGxTZXR0aW5nIiwNCiAgICB0aXRsZTogdm0uJHQoIkF1ZGlvQ2FsbFNldHRpbmciKSwNCiAgICB0aXRsZURlc2NyaXB0aW9uOiB2bS4kdCgiQXVkaW9DYWxsU2V0dGluZ0Rlc2MiKSwNCiAgICBpdGVtczogWw0KICAgICAgew0KICAgICAgICB0aXRsZTogdm0uJHQoIlJlY2VpdmVMaXZlU3RyZWFtIiksDQogICAgICAgIHR5cGU6ICJjaGVja2JveCIsDQogICAgICAgIGtleTogIkNvbmZpZy5GZWF0dXJlcy5BVURJT19DQUxMLlJlY2VpdmVMaXZlU3RyZWFtIiwNCiAgICAgICAgdmFsdWU6DQogICAgICAgICAgdm0uYXBpRGF0YS5jb25maWdEYXRhWyJDb25maWcuRmVhdHVyZXMuQVVESU9fQ0FMTC5SZWNlaXZlTGl2ZVN0cmVhbSJdLA0KICAgICAgICBkZXNjcmlwdGlvbjogdm0uJHQoIlJlY2VpdmVMaXZlRGVzYyIpLA0KICAgICAgfSwNCiAgICBdLA0KICB9Ow0KICByZXR1cm4gY29udGVudDsNCn0NCg0KZnVuY3Rpb24gY3JlYXRlRm9yd2FyZENvbnRlbnQodm0pIHsNCiAgbGV0IG5vQW5zd2VyUmluZ1RpbWVJdGVtcyA9IFtdOw0KICBmb3IgKGxldCBpID0gMDsgaSA8IDIxOyBpKyspIHsNCiAgICBub0Fuc3dlclJpbmdUaW1lSXRlbXMucHVzaCh7DQogICAgICBrZXk6IGkgKiA2LA0KICAgICAgbGFiZWw6ICIgIiArIGkgKiA2LA0KICAgIH0pOw0KICB9DQoNCiAgbGV0IGNvbnRlbnQgPSB7DQogICAga2V5OiAiZm9yd2FyZFRyYW5zZmVyIiwNCiAgICB0aXRsZTogdm0uJHQoIkZvcndhcmRUcmFuc2ZlciIpLA0KICAgIHRpdGxlRGVzY3JpcHRpb246IHZtLiR0KCJDYWxsRm93YXJkRGVzYyIpLA0KICAgIGl0ZW1zOiBbDQogICAgICB7DQogICAgICAgIHRpdGxlOiB2bS4kdCgiRm9yd2FyZEFsd2F5cyIpLA0KICAgICAgICB0eXBlOiAic2VsZWN0IiwNCiAgICAgICAga2V5OiAiQ29uZmlnLkZvcndhcmQuQUxXQVlTLkVuYWJsZSIsDQogICAgICAgIHZhbHVlOiB2bS5hcGlEYXRhLmNvbmZpZ0RhdGFbIkNvbmZpZy5Gb3J3YXJkLkFMV0FZUy5FbmFibGUiXSwNCiAgICAgICAgc2VsZWN0SXRlbXM6IGdldEVuYWJsZVNlbGVjdEl0ZW1zKHZtKSwNCiAgICAgICAgZGVzY3JpcHRpb246IHZtLiR0KCJBbHdheXNUcmFuc2ZlckRlc2MiKSwNCiAgICAgIH0sDQogICAgICB7DQogICAgICAgIHRpdGxlOiB2bS4kdCgiQWx3YXlzVGFyZ2V0TnVtYmVyIiksDQogICAgICAgIHR5cGU6ICJpbnB1dCIsDQogICAgICAgIGtleTogIkNvbmZpZy5Gb3J3YXJkLkFMV0FZUy5UYXJnZXQiLA0KICAgICAgICB2YWx1ZTogdm0uYXBpRGF0YS5jb25maWdEYXRhWyJDb25maWcuRm9yd2FyZC5BTFdBWVMuVGFyZ2V0Il0sDQogICAgICAgIGlzV2FybjogZmFsc2UsDQogICAgICAgIHdhcm5MYWJlbDogdm0uJHQoIlRhcmdldE51bWJlck5vRW1wdHkiKSwNCiAgICAgICAgZGVzY3JpcHRpb246IHZtLiR0KCJBbHdheXNGb3JOdW1iZXJEZXNjIiksDQogICAgICB9LA0KICAgICAgew0KICAgICAgICB0aXRsZTogdm0uJHQoIkZvcndhcmRCdXN5IiksDQogICAgICAgIHR5cGU6ICJzZWxlY3QiLA0KICAgICAgICBrZXk6ICJDb25maWcuRm9yd2FyZC5CVVNZLkVuYWJsZSIsDQogICAgICAgIHZhbHVlOiB2bS5hcGlEYXRhLmNvbmZpZ0RhdGFbIkNvbmZpZy5Gb3J3YXJkLkJVU1kuRW5hYmxlIl0sDQogICAgICAgIHNlbGVjdEl0ZW1zOiBnZXRFbmFibGVTZWxlY3RJdGVtcyh2bSksDQogICAgICAgIGRlc2NyaXB0aW9uOiB2bS4kdCgiQnVzeVRyYW5zZmVyRGVzYyIpLA0KICAgICAgfSwNCiAgICAgIHsNCiAgICAgICAgdGl0bGU6IHZtLiR0KCJCdXN5VGFyZ2V0TnVtYmVyIiksDQogICAgICAgIHR5cGU6ICJpbnB1dCIsDQogICAgICAgIGtleTogIkNvbmZpZy5Gb3J3YXJkLkJVU1kuVGFyZ2V0IiwNCiAgICAgICAgdmFsdWU6IHZtLmFwaURhdGEuY29uZmlnRGF0YVsiQ29uZmlnLkZvcndhcmQuQlVTWS5UYXJnZXQiXSwNCiAgICAgICAgaXNXYXJuOiBmYWxzZSwNCiAgICAgICAgd2FybkxhYmVsOiB2bS4kdCgiVGFyZ2V0TnVtYmVyTm9FbXB0eSIpLA0KICAgICAgICBkZXNjcmlwdGlvbjogdm0uJHQoIkJ1c3lGb3JOdW1iZXJEZXNjIiksDQogICAgICB9LA0KICAgICAgew0KICAgICAgICB0aXRsZTogdm0uJHQoIkZvcndhcmROb0Fuc3dlciIpLA0KICAgICAgICB0eXBlOiAic2VsZWN0IiwNCiAgICAgICAga2V5OiAiQ29uZmlnLkZvcndhcmQuVElNRU9VVC5FbmFibGUiLA0KICAgICAgICB2YWx1ZTogdm0uYXBpRGF0YS5jb25maWdEYXRhWyJDb25maWcuRm9yd2FyZC5USU1FT1VULkVuYWJsZSJdLA0KICAgICAgICBzZWxlY3RJdGVtczogZ2V0RW5hYmxlU2VsZWN0SXRlbXModm0pLA0KICAgICAgICBkZXNjcmlwdGlvbjogdm0uJHQoIk5vQW5zd3JlVHJhbnNmZXJEZXNjIiksDQogICAgICB9LA0KICAgICAgew0KICAgICAgICB0aXRsZTogdm0uJHQoIk5vQW5zd2VyVGFyZ2V0TnVtYmVyIiksDQogICAgICAgIHR5cGU6ICJpbnB1dCIsDQogICAgICAgIGtleTogIkNvbmZpZy5Gb3J3YXJkLlRJTUVPVVQuVGFyZ2V0IiwNCiAgICAgICAgdmFsdWU6IHZtLmFwaURhdGEuY29uZmlnRGF0YVsiQ29uZmlnLkZvcndhcmQuVElNRU9VVC5UYXJnZXQiXSwNCiAgICAgICAgaXNXYXJuOiBmYWxzZSwNCiAgICAgICAgd2FybkxhYmVsOiB2bS4kdCgiVGFyZ2V0TnVtYmVyTm9FbXB0eSIpLA0KICAgICAgICBkZXNjcmlwdGlvbjogdm0uJHQoIk5vQW5zd2VyRm9yTnVtYmVyRGVzYyIpLA0KICAgICAgfSwNCiAgICAgIHsNCiAgICAgICAgdGl0bGU6IHZtLiR0KCJOb0Fuc3dlclJpbmdUaW1lIikgKyAiICgiICsgdm0uJHQoIlNlY29uZCIpICsgIikiLA0KICAgICAgICB0eXBlOiAic2VsZWN0IiwNCiAgICAgICAga2V5OiAiQ29uZmlnLkZvcndhcmQuVElNRU9VVC5UaW1lb3V0IiwNCiAgICAgICAgdmFsdWU6IHZtLmFwaURhdGEuY29uZmlnRGF0YVsiQ29uZmlnLkZvcndhcmQuVElNRU9VVC5UaW1lb3V0Il0sDQogICAgICAgIHNlbGVjdEl0ZW1zOiBub0Fuc3dlclJpbmdUaW1lSXRlbXMsDQogICAgICAgIGRlc2NyaXB0aW9uOiB2bS4kdCgiTm9BbnN3ZXJEdXJhdGlvbkRlc2MiKSwNCiAgICAgIH0sDQogICAgXSwNCiAgfTsNCiAgcmV0dXJuIGNvbnRlbnQ7DQp9DQoNCmZ1bmN0aW9uIGNyZWF0ZURORENvbnRlbnQodm0pIHsNCiAgbGV0IGRuZFN0YXJ0VGltZSA9IG5ldyBEYXRlKCk7DQogIGRuZFN0YXJ0VGltZS5zZXRIb3VycygNCiAgICB2bS5hcGlEYXRhLmNvbmZpZ0RhdGFbIkNvbmZpZy5GZWF0dXJlcy5ETkQuU3RhcnRUaW1lIl0uc3BsaXQoIjoiKVswXQ0KICApOw0KICBkbmRTdGFydFRpbWUuc2V0TWludXRlcygNCiAgICB2bS5hcGlEYXRhLmNvbmZpZ0RhdGFbIkNvbmZpZy5GZWF0dXJlcy5ETkQuU3RhcnRUaW1lIl0uc3BsaXQoIjoiKVsxXQ0KICApOw0KDQogIGxldCBkbmRFbmRUaW1lID0gbmV3IERhdGUoKTsNCiAgZG5kRW5kVGltZS5zZXRIb3VycygNCiAgICB2bS5hcGlEYXRhLmNvbmZpZ0RhdGFbIkNvbmZpZy5GZWF0dXJlcy5ETkQuRW5kVGltZSJdLnNwbGl0KCI6IilbMF0NCiAgKTsNCiAgZG5kRW5kVGltZS5zZXRNaW51dGVzKA0KICAgIHZtLmFwaURhdGEuY29uZmlnRGF0YVsiQ29uZmlnLkZlYXR1cmVzLkRORC5FbmRUaW1lIl0uc3BsaXQoIjoiKVsxXQ0KICApOw0KDQogIGxldCBjb250ZW50ID0gew0KICAgIGtleTogIkRORCIsDQogICAgdGl0bGU6IHZtLiR0KCJETkQiKSwNCiAgICB0aXRsZURlc2NyaXB0aW9uOiB2bS4kdCgiRE5ERGVzYyIpLA0KICAgIGl0ZW1zOiBbDQogICAgICB7DQogICAgICAgIHRpdGxlOiB2bS4kdCgiV2hvbGVEYXkiKSwNCiAgICAgICAgdHlwZTogImNoZWNrYm94IiwNCiAgICAgICAga2V5OiAiQ29uZmlnLkZlYXR1cmVzLkRORC5XaG9sZURheSIsDQogICAgICAgIHZhbHVlOiB2bS5hcGlEYXRhLmNvbmZpZ0RhdGFbIkNvbmZpZy5GZWF0dXJlcy5ETkQuV2hvbGVEYXkiXSwNCiAgICAgICAgZGVzY3JpcHRpb246IHZtLiR0KCJXaG9sZURheURlc2MiKSwNCiAgICAgIH0sDQogICAgICB7DQogICAgICAgIHRpdGxlOiB2bS4kdCgiRE5EU2NoZWR1bGUiKSwNCiAgICAgICAgdHlwZTogImNoZWNrYm94IiwNCiAgICAgICAga2V5OiAiQ29uZmlnLkZlYXR1cmVzLkRORC5TY2hlZHVsZU1vZGUiLA0KICAgICAgICBkaXNhYmxlZDogZmFsc2UsDQogICAgICAgIHZhbHVlOiB2bS5hcGlEYXRhLmNvbmZpZ0RhdGFbIkNvbmZpZy5GZWF0dXJlcy5ETkQuU2NoZWR1bGVNb2RlIl0sDQogICAgICAgIGRlc2NyaXB0aW9uOiB2bS4kdCgiU2NoZWR1bGVEZXNjIiksDQogICAgICB9LA0KICAgICAgew0KICAgICAgICB0aXRsZTogdm0uJHQoIkRORFN0YXJ0VGltZSIpLA0KICAgICAgICB0eXBlOiAidGltZSIsDQogICAgICAgIGtleTogIkNvbmZpZy5GZWF0dXJlcy5ETkQuU3RhcnRUaW1lIiwNCiAgICAgICAgdGltZUZvcm1hdDogdm0uYXBpRGF0YS5jb25maWdEYXRhWyJDb25maWcuU2V0dGluZ3MuREFURVRJTUUuVGltZUZvcm1hdCJdID09IDAgPyAiaDptbSBhIiA6ICJISDptbSIsDQogICAgICAgIHVzZTEySG91cnM6IHZtLmFwaURhdGEuY29uZmlnRGF0YVsiQ29uZmlnLlNldHRpbmdzLkRBVEVUSU1FLlRpbWVGb3JtYXQiXSA9PSAwID8gdHJ1ZSA6IGZhbHNlLA0KICAgICAgICB2YWx1ZTogbW9tZW50KGRuZFN0YXJ0VGltZSksDQogICAgICAgIGRlc2NyaXB0aW9uOiB2bS4kdCgiRE5EU3RhcnRUaW1lRGVzYyIpLA0KICAgICAgfSwNCiAgICAgIHsNCiAgICAgICAgdGl0bGU6IHZtLiR0KCJETkRFbmRUaW1lIiksDQogICAgICAgIHR5cGU6ICJ0aW1lIiwNCiAgICAgICAga2V5OiAiQ29uZmlnLkZlYXR1cmVzLkRORC5FbmRUaW1lIiwNCiAgICAgICAgdGltZUZvcm1hdDogdm0uYXBpRGF0YS5jb25maWdEYXRhWyJDb25maWcuU2V0dGluZ3MuREFURVRJTUUuVGltZUZvcm1hdCJdID09IDAgPyAiaDptbSBhIiA6ICJISDptbSIsDQogICAgICAgIHVzZTEySG91cnM6IHZtLmFwaURhdGEuY29uZmlnRGF0YVsiQ29uZmlnLlNldHRpbmdzLkRBVEVUSU1FLlRpbWVGb3JtYXQiXSA9PSAwID8gdHJ1ZSA6IGZhbHNlLA0KICAgICAgICB2YWx1ZTogbW9tZW50KGRuZEVuZFRpbWUpLA0KICAgICAgICBzaG93SGludDogdHJ1ZSwNCiAgICAgICAgaGludENvbnRlbnQ6IHZtLiR0KCJOZXh0RGF5IiksDQogICAgICAgIGRlc2NyaXB0aW9uOiB2bS4kdCgiRE5ERW5kVGltZURlc2MiKSwNCiAgICAgIH0sDQogICAgICB7DQogICAgICAgIHRpdGxlOiB2bS4kdCgiUmV0dXJuQ29kZURORCIpLA0KICAgICAgICB0eXBlOiAic2VsZWN0IiwNCiAgICAgICAga2V5OiAiQ29uZmlnLkZlYXR1cmVzLkRORC5SZXR1cm5Db2RlIiwNCiAgICAgICAgdmFsdWU6IHZtLmFwaURhdGEuY29uZmlnRGF0YVsiQ29uZmlnLkZlYXR1cmVzLkRORC5SZXR1cm5Db2RlIl0sDQogICAgICAgIHNlbGVjdEl0ZW1zOiByZXR1cm5Db2RlSXRlbXMsDQogICAgICAgIGRlc2NyaXB0aW9uOiB2bS4kdCgiUmV0dXJuQ29kZURORERlc2MiKSwNCiAgICAgIH0sDQogICAgXSwNCiAgfTsNCiAgcmV0dXJuIGNvbnRlbnQ7DQp9DQoNCmZ1bmN0aW9uIGNoZWNrQ29tbWl0RGF0YSh2bSkgew0KICByZXR1cm4gY2hlY2tGb3J3YXJkRGF0YSh2bSkgJiYgY2hlY2tPdGhlcnNEYXRhKHZtKTsNCn0NCg0KZnVuY3Rpb24gY2hlY2tPdGhlcnNEYXRhKHZtKSB7DQogIGxldCBzdWNjZXNzID0gdHJ1ZTsNCg0KICBpZiAoDQogICAgIWNoZWNrUmFuZ2VPZk51bWJlcigNCiAgICAgIHZtLmNoYW5nZWRDZmdEYXRhWyJDb25maWcuRmVhdHVyZXMuQVVUT0FOU1dFUi5EZWxheSJdLA0KICAgICAgMCwNCiAgICAgIDMwDQogICAgKSB8fA0KICAgICIiID09IHZtLmNoYW5nZWRDZmdEYXRhWyJDb25maWcuRmVhdHVyZXMuQVVUT0FOU1dFUi5EZWxheSJdDQogICkgew0KICAgIGxldCBpdGVtID0gZ2V0SXRlbUJ5S2V5KA0KICAgICAgdm0uZGF0YSwNCiAgICAgICJvdGhlcnMiLA0KICAgICAgIkNvbmZpZy5GZWF0dXJlcy5BVVRPQU5TV0VSLkRlbGF5Ig0KICAgICk7DQogICAgaXRlbS5pc1dhcm4gPSB0cnVlOw0KICAgIHN1Y2Nlc3MgPSBmYWxzZTsNCiAgfQ0KDQogIGxldCBkaXJlY3RJcFBvcnRpdGVtID0gZ2V0SXRlbUJ5S2V5KA0KICAgIHZtLmRhdGEsDQogICAgIm90aGVycyIsDQogICAgIkNvbmZpZy5TZXR0aW5ncy5HRU5FUkFMLkRpcmVjdElQUG9ydCINCiAgKTsNCiAgaWYgKA0KICAgICFjaGVja1JhbmdlT2ZOdW1iZXIoDQogICAgICB2bS5jaGFuZ2VkQ2ZnRGF0YVsiQ29uZmlnLlNldHRpbmdzLkdFTkVSQUwuRGlyZWN0SVBQb3J0Il0sDQogICAgICAxLA0KICAgICAgNjU1MzUNCiAgICApDQogICkgew0KICAgIGRpcmVjdElwUG9ydGl0ZW0uaXNXYXJuID0gdHJ1ZTsNCiAgICBkaXJlY3RJcFBvcnRpdGVtLndhcm5MYWJlbCA9IHZtLiR0KCJEaXJlY3RJUFBvcnRSYW5nZUVycm9yIik7DQogICAgc3VjY2VzcyA9IGZhbHNlOw0KICB9DQogIGlmICgNCiAgICB2bS5jaGFuZ2VkQ2ZnRGF0YVsiQ29uZmlnLlNldHRpbmdzLkdFTkVSQUwuRGlyZWN0SVBQb3J0Il0gPT0gIjUwNjIiIHx8DQogICAgdm0uY2hhbmdlZENmZ0RhdGFbIkNvbmZpZy5TZXR0aW5ncy5HRU5FUkFMLkRpcmVjdElQUG9ydCJdID09ICI1MDYzIg0KICApIHsNCiAgICBkaXJlY3RJcFBvcnRpdGVtLmlzV2FybiA9IHRydWU7DQogICAgZGlyZWN0SXBQb3J0aXRlbS53YXJuTGFiZWwgPSB2bS4kdCgiU2FtZVNpcFBvcnRFcnIiKTsNCiAgICBzdWNjZXNzID0gZmFsc2U7DQogIH0NCiAgcmV0dXJuIHN1Y2Nlc3M7DQp9DQoNCmZ1bmN0aW9uIGNoZWNrRm9yd2FyZERhdGEodm0pIHsNCiAgbGV0IHN1Y2Nlc3MgPSB0cnVlOw0KICBpZiAoDQogICAgdm0uY2hhbmdlZENmZ0RhdGFbIkNvbmZpZy5Gb3J3YXJkLkFMV0FZUy5FbmFibGUiXSA9PSAiMSIgJiYNCiAgICB2bS5jaGFuZ2VkQ2ZnRGF0YVsiQ29uZmlnLkZvcndhcmQuQUxXQVlTLlRhcmdldCJdID09ICIiDQogICkgew0KICAgIGxldCBpdGVtID0gZ2V0SXRlbUJ5S2V5KA0KICAgICAgdm0uZGF0YSwNCiAgICAgICJmb3J3YXJkVHJhbnNmZXIiLA0KICAgICAgIkNvbmZpZy5Gb3J3YXJkLkFMV0FZUy5UYXJnZXQiDQogICAgKTsNCiAgICBpdGVtLmlzV2FybiA9IHRydWU7DQogICAgc3VjY2VzcyA9IGZhbHNlOw0KICB9DQogIGlmICgNCiAgICB2bS5jaGFuZ2VkQ2ZnRGF0YVsiQ29uZmlnLkZvcndhcmQuQlVTWS5FbmFibGUiXSA9PSAiMSIgJiYNCiAgICB2bS5jaGFuZ2VkQ2ZnRGF0YVsiQ29uZmlnLkZvcndhcmQuQlVTWS5UYXJnZXQiXSA9PSAiIg0KICApIHsNCiAgICBsZXQgaXRlbSA9IGdldEl0ZW1CeUtleSgNCiAgICAgIHZtLmRhdGEsDQogICAgICAiZm9yd2FyZFRyYW5zZmVyIiwNCiAgICAgICJDb25maWcuRm9yd2FyZC5CVVNZLlRhcmdldCINCiAgICApOw0KICAgIGl0ZW0uaXNXYXJuID0gdHJ1ZTsNCiAgICBzdWNjZXNzID0gZmFsc2U7DQogIH0NCiAgaWYgKA0KICAgIHZtLmNoYW5nZWRDZmdEYXRhWyJDb25maWcuRm9yd2FyZC5USU1FT1VULkVuYWJsZSJdID09ICIxIiAmJg0KICAgIHZtLmNoYW5nZWRDZmdEYXRhWyJDb25maWcuRm9yd2FyZC5USU1FT1VULlRhcmdldCJdID09ICIiDQogICkgew0KICAgIGxldCBpdGVtID0gZ2V0SXRlbUJ5S2V5KA0KICAgICAgdm0uZGF0YSwNCiAgICAgICJmb3J3YXJkVHJhbnNmZXIiLA0KICAgICAgIkNvbmZpZy5Gb3J3YXJkLlRJTUVPVVQuVGFyZ2V0Ig0KICAgICk7DQogICAgaXRlbS5pc1dhcm4gPSB0cnVlOw0KICAgIHN1Y2Nlc3MgPSBmYWxzZTsNCiAgfQ0KICByZXR1cm4gc3VjY2VzczsNCn0NCg0KZnVuY3Rpb24gZ2V0QWxsb3dUYWJsZURhdGEodm0sIHBhZ2UpIHsNCiAgdm0uJGF4aW9zLmdldCgiYXBpL3Bob25lQ2FsbEZlYXR1cmUvZ2V0P3BhZ2U9IiArIHBhZ2UpLnRoZW4oKHJlc3BvbnNlKSA9PiB7DQogICAgbGV0IHRhYmxlRGF0YSA9IFtdOw0KICAgIGxldCBkYXRhID0gcmVzcG9uc2UuZGF0YS5kYXRhOw0KICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGF0YS5hbGxvd0xpc3QubGVuZ3RoOyBpKyspIHsNCiAgICAgIGxldCBpdGVtID0gew0KICAgICAgICBrZXk6IGRhdGEuYWxsb3dMaXN0W2ldLmlkLA0KICAgICAgICBpbmRleDogaSArIDEsDQogICAgICAgIGRldmljZUxvY2F0aW9uOiBkYXRhLmFsbG93TGlzdFtpXS5sb2NhdGlvbiwNCiAgICAgICAgZGV2aWNlTnVtYmVyOiBkYXRhLmFsbG93TGlzdFtpXS5udW1iZXIsDQogICAgICAgIGVkaXQ6IGksDQogICAgICB9Ow0KICAgICAgdGFibGVEYXRhLnB1c2goaXRlbSk7DQogICAgfQ0KICAgIGdldEl0ZW1CeUtleSh2bS5kYXRhLCAiYWxsb3dsaXN0IiwgImFsbG93bGlzdCIpLnRhYmxlRGF0YSA9IHRhYmxlRGF0YTsNCiAgICBnZXRJdGVtQnlLZXkodm0uZGF0YSwgImFsbG93bGlzdCIsICJhbGxvd2xpc3QiKS50YWJsZUZvb3RlckRhdGEuc3VtID0NCiAgICAgIGRhdGEuc3VtOw0KICAgIGdldEl0ZW1CeUtleSh2bS5kYXRhLCAiYWxsb3dsaXN0IiwgImFsbG93bGlzdCIpLnRhYmxlRm9vdGVyRGF0YS5wYWdlTnVtYmVyID0NCiAgICAgIGRhdGEucGFnZU51bTsNCiAgICBnZXRJdGVtQnlLZXkoDQogICAgICB2bS5kYXRhLA0KICAgICAgImFsbG93bGlzdCIsDQogICAgICAiYWxsb3dsaXN0Ig0KICAgICkudGFibGVGb290ZXJEYXRhLmN1clBhZ2UgPSBwYWdlOw0KICAgIGdldEl0ZW1CeUtleSh2bS5kYXRhLCAiYWxsb3dsaXN0IiwgImFsbG93bGlzdCIpLnNlbGVjdGVkUm93S2V5cyA9IFtdOw0KICB9KTsNCn0NCg0KZnVuY3Rpb24gb25DaGFuZ2VBbGxvd0xpc3Qodm0pIHsNCiAgbGV0IGFkZE1vZGFsRGF0YSA9IGdldEl0ZW1CeUtleSh2bS5kYXRhLCAiYWxsb3dsaXN0IiwgImFsbG93bGlzdCIpDQogICAgLnRhYmxlSGVhZERhdGEuYWRkTW9kYWxEYXRhOw0KICBsZXQgZGV2aWNlTG9hY3Rpb24gPQ0KICAgIGFkZE1vZGFsRGF0YS5pdGVtc1tnZXRJbmRleEJ5S2V5KGFkZE1vZGFsRGF0YS5pdGVtcywgImRldmljZUxvY2F0aW9uIildOw0KICBsZXQgZGV2aWNlTnVtYmVyID0NCiAgICBhZGRNb2RhbERhdGEuaXRlbXNbZ2V0SW5kZXhCeUtleShhZGRNb2RhbERhdGEuaXRlbXMsICJkZXZpY2VOdW1iZXIiKV07DQogIGxldCBpZCA9IGFkZE1vZGFsRGF0YS5rZXk7DQoNCiAgbGV0IGVyckZsYWcgPSBmYWxzZTsNCiAgaWYgKGRldmljZUxvYWN0aW9uLnZhbHVlID09ICIiKSB7DQogICAgZGV2aWNlTG9hY3Rpb24uaXNXYXJuID0gdHJ1ZTsNCiAgICBlcnJGbGFnID0gdHJ1ZTsNCiAgfQ0KDQogIGlmIChkZXZpY2VOdW1iZXIudmFsdWUgPT0gIiIpIHsNCiAgICBkZXZpY2VOdW1iZXIuaXNXYXJuID0gdHJ1ZTsNCiAgICBkZXZpY2VOdW1iZXIud2FybkxhYmVsID0gdm0uJHQoIkFsbG93SVBTSVBOb0VtcHR5Iik7DQogICAgZXJyRmxhZyA9IHRydWU7DQogIH0NCg0KICBpZiAoZXJyRmxhZykgew0KICAgIHJldHVybjsNCiAgfQ0KDQogIGxldCBkYXRhID0gew0KICAgIGxvY2F0aW9uOiBkZXZpY2VMb2FjdGlvbi52YWx1ZSwNCiAgICBudW1iZXI6IGRldmljZU51bWJlci52YWx1ZSwNCiAgICBpZDogaWQsDQogIH07DQoNCiAgbGV0IGFjdGlvbiA9IGlkID49IDAgPyAiZWRpdCIgOiAiYWRkIjsNCg0KICBsZXQgcmVxdWVzdERhdGEgPSB7DQogICAgdGFyZ2V0OiAicGhvbmVDYWxsRmVhdHVyZSIsDQogICAgYWN0aW9uOiBhY3Rpb24sDQogICAgZGF0YTogZGF0YSwNCiAgfTsNCiAgdm0uJGF4aW9zLnBvc3QoImFwaSIsIHJlcXVlc3REYXRhKS50aGVuKChyZXNwb25zZSkgPT4gew0KICAgIGxldCByZXQgPSByZXNwb25zZS5kYXRhLnJldGNvZGU7DQogICAgaWYgKHJldCA9PSAwKSB7DQogICAgICBkZXZpY2VMb2FjdGlvbi52YWx1ZSA9ICIiOw0KICAgICAgZGV2aWNlTnVtYmVyLnZhbHVlID0gIiI7DQogICAgICBsZXQgcGFnZSA9IDA7DQogICAgICBsZXQgdGFibGVJdGVtID0gZ2V0SXRlbUJ5S2V5KHZtLmRhdGEsICJhbGxvd2xpc3QiLCAiYWxsb3dsaXN0Iik7DQogICAgICBpZiAoYWN0aW9uID09ICJhZGQiKSB7DQogICAgICAgIC8v6aG16Z2i5pWw5o2u5Y+Y5YyWDQogICAgICAgIHBhZ2UgPSBNYXRoLmNlaWwoDQogICAgICAgICAgKHRhYmxlSXRlbS50YWJsZUZvb3RlckRhdGEuc3VtICsgMSkgLw0KICAgICAgICAgICAgdGFibGVJdGVtLnRhYmxlRm9vdGVyRGF0YS5wYWdlTnVtYmVyDQogICAgICAgICk7DQogICAgICB9IGVsc2Ugew0KICAgICAgICBwYWdlID0gdGFibGVJdGVtLnRhYmxlRm9vdGVyRGF0YS5jdXJQYWdlOw0KICAgICAgfQ0KICAgICAgZ2V0QWxsb3dUYWJsZURhdGEodm0sIHBhZ2UpOw0KICAgICAgLy/lhbPpl63nqpflj6PlubblsZXnpLrmiJDlip8NCiAgICAgIGFkZE1vZGFsRGF0YS52aXNpYmxlID0gZmFsc2U7DQogICAgICBzaG93UmVxdWVzdFN1Y2Nlc3Modm0pOw0KICAgIH0gZWxzZSBpZiAocmV0ID09IDcpIHsNCiAgICAgIGRldmljZU51bWJlci5pc1dhcm4gPSB0cnVlOw0KICAgICAgZGV2aWNlTnVtYmVyLndhcm5MYWJlbCA9IHZtLiR0KCJXaGlsZU51bWJlckFscmVhZHlFeGlzdCIpOw0KICAgIH0gZWxzZSB7DQogICAgICBzaG93RXJyb3JJbmZvKHZtLCB2bS4kdCgiV2hpbGVMaXN0QWRkRXJyIikpOw0KICAgIH0NCiAgfSk7DQp9DQoNCmZ1bmN0aW9uIG9uRGVsZXRlQWxsb3dMaXN0KHZtLCB0eXBlKSB7DQogIGlmICgNCiAgICAhY29uZmlybSgNCiAgICAgIHR5cGUgPT0gImFsbCIgPyB2bS4kdCgiRGVsZXRlQWxsQ29uZmlybSIpIDogdm0uJHQoIkRlbGV0ZVNlbGVjdGVkQ29uZmlybSIpDQogICAgKQ0KICApIHsNCiAgICByZXR1cm47DQogIH0NCiAgbGV0IHNlbGVjdGVkUm93S2V5cyA9IGdldEl0ZW1CeUtleSh2bS5kYXRhLCAiYWxsb3dsaXN0IiwgImFsbG93bGlzdCIpDQogICAgLnNlbGVjdGVkUm93S2V5czsNCiAgbGV0IHJlcXVlc3REYXRhID0gew0KICAgIHRhcmdldDogInBob25lQ2FsbEZlYXR1cmUiLA0KICAgIGFjdGlvbjogImRlbCIsDQogICAgZGF0YTogew0KICAgICAgdHlwZTogdHlwZSwNCiAgICAgIGlkczogc2VsZWN0ZWRSb3dLZXlzLA0KICAgIH0sDQogIH07DQogIHZtLiRheGlvcy5wb3N0KCJhcGkiLCByZXF1ZXN0RGF0YSkudGhlbigocmVzcG9uc2UpID0+IHsNCiAgICBzaG93UmVxdWVzdFN1Y2Nlc3Modm0sIHZtLiR0KCJEZWxldGVBbGxvd0xpc3RTdWNjZXNzIikpOw0KICAgIGlmICh0eXBlICE9ICJhbGwiKSB7DQogICAgICBsZXQgdGFibGVGb290ZXJEYXRhID0gZ2V0SXRlbUJ5S2V5KHZtLmRhdGEsICJhbGxvd2xpc3QiLCAiYWxsb3dsaXN0IikNCiAgICAgICAgLnRhYmxlRm9vdGVyRGF0YTsNCiAgICAgIGxldCBzdW1QYWdlID0gTWF0aC5jZWlsKA0KICAgICAgICAodGFibGVGb290ZXJEYXRhLnN1bSAtIHNlbGVjdGVkUm93S2V5cy5sZW5ndGgpIC8NCiAgICAgICAgICB0YWJsZUZvb3RlckRhdGEucGFnZU51bWJlcg0KICAgICAgKTsNCiAgICAgIHN1bVBhZ2UgPSBzdW1QYWdlID09IDAgPyAxIDogc3VtUGFnZTsNCiAgICAgIGxldCBwYWdlID0NCiAgICAgICAgdGFibGVGb290ZXJEYXRhLmN1clBhZ2UgPj0gc3VtUGFnZSA/IHN1bVBhZ2UgOiB0YWJsZUZvb3RlckRhdGEuY3VyUGFnZTsNCiAgICAgIGdldEFsbG93VGFibGVEYXRhKHZtLCBwYWdlKTsNCiAgICB9IGVsc2Ugew0KICAgICAgZ2V0QWxsb3dUYWJsZURhdGEodm0sIDEpOw0KICAgIH0NCiAgfSk7DQp9DQoNCmZ1bmN0aW9uIG9uRXhwb3J0KHZtLCB0eXBlKSB7DQogIGxldCByZXF1ZXN0RGF0YSA9IHsNCiAgICB0YXJnZXQ6ICJwaG9uZUNhbGxGZWF0dXJlIiwNCiAgICBhY3Rpb246ICJleHBvcnQiLA0KICAgIGRhdGE6IHsNCiAgICAgIHR5cGU6IHR5cGUsDQogICAgfSwNCiAgfTsNCiAgdm0uJGF4aW9zLnBvc3QoImFwaSIsIHJlcXVlc3REYXRhKS50aGVuKChyZXNwb25zZSkgPT4gew0KICAgIHNob3dSZXF1ZXN0U3VjY2Vzcyh2bSwgdm0uJHQoIkV4cG9ydFN1Y2Nlc3MiKSk7DQogICAgbGV0IGFkZHJlc3MgPSByZXNwb25zZS5kYXRhLmRhdGEuYWRkcmVzczsNCiAgICB3aW5kb3cub3BlbihhZGRyZXNzKTsNCiAgfSk7DQp9DQoNCmZ1bmN0aW9uIG9uSW1wb3J0KHZtKSB7DQogIGxldCBtb2RhbCA9IGdldEl0ZW1CeUtleSh2bS5kYXRhLCAiYWxsb3dsaXN0IiwgImFsbG93bGlzdCIpLnRhYmxlSGVhZERhdGENCiAgICAuaW1wb3J0TW9kYWxEYXRhOw0KICBsZXQgaXRlbSA9IG1vZGFsLml0ZW1zW2dldEluZGV4QnlLZXkobW9kYWwuaXRlbXMsICJpbXBvcnQiKV07DQogIGxldCBmaWxlTmFtZSA9IGl0ZW0udmFsdWUuZmlsZU5hbWU7DQogIGlmIChmaWxlTmFtZSA9PSAiIiB8fCBmaWxlTmFtZSA9PSB2bS4kdCgiVXBncmFkZUZpbGVQYXRoIikpIHsNCiAgICBzaG93RXJyb3JJbmZvKHZtLCB2bS4kdCgiRmlsZUVtcHR5V2FybmluZyIpKTsNCiAgICByZXR1cm47DQogIH0NCg0KICBtb2RhbC5jb25maXJtTG9hZGluZyA9IHRydWU7DQogIGNvbnN0IHVwRGF0YSA9IG5ldyBGb3JtRGF0YSgpOw0KICB1cERhdGEuYXBwZW5kKCJmaWxlIiwgaXRlbS52YWx1ZS5maWxlRGF0YSk7DQogIGF4aW9zDQogICAgLnBvc3QoImFwaS9waG9uZUNhbGxGZWF0dXJlL2ltcG9ydCIsIHVwRGF0YSwgew0KICAgICAgaGVhZGVyczogew0KICAgICAgICAiQ29udGVudC1UeXBlIjogIm11bHRpcGFydC9mb3JtLWRhdGEiLA0KICAgICAgfSwNCiAgICB9KQ0KICAgIC50aGVuKChyZXMpID0+IHsNCiAgICAgIGlmIChyZXMuZGF0YS5yZXRjb2RlID09IC0xKSB7DQogICAgICAgIHNob3dFcnJvckluZm8odm0sIHZtLiR0KCJXaGl0ZUxpc3RJbXBvcnRGYWlsIikpOw0KICAgICAgfSBlbHNlIGlmIChyZXMuZGF0YS5yZXRjb2RlID09IDIpIHsNCiAgICAgICAgc2hvd1dhcm5pbmdJbmZvKHZtLCB2bS4kdCgiV2hpdGVMaXN0SW1wb3J0RXhpc3RXYXJuaW5nIikpOw0KICAgICAgICBpdGVtLnZhbHVlLmZpbGVOYW1lID0gdm0uJHQoIlVwZ3JhZGVGaWxlUGF0aCIpOw0KICAgICAgICBpdGVtLnZhbHVlLmZpbGVEYXRhID0ge307DQogICAgICAgIG1vZGFsLnZpc2libGUgPSBmYWxzZTsNCiAgICAgIH0gZWxzZSBpZiAocmVzLmRhdGEucmV0Y29kZSA9PSAwKSB7DQogICAgICAgIHNob3dSZXF1ZXN0U3VjY2Vzcyh2bSwgdm0uJHQoIldoaXRlTGlzdEltcG9ydFN1Y2Nlc3MiKSk7DQogICAgICAgIGl0ZW0udmFsdWUuZmlsZU5hbWUgPSB2bS4kdCgiVXBncmFkZUZpbGVQYXRoIik7DQogICAgICAgIGl0ZW0udmFsdWUuZmlsZURhdGEgPSB7fTsNCiAgICAgICAgbW9kYWwudmlzaWJsZSA9IGZhbHNlOw0KICAgICAgfQ0KICAgICAgbW9kYWwuY29uZmlybUxvYWRpbmcgPSBmYWxzZTsNCiAgICAgIGxldCBwYWdlID0gZ2V0SXRlbUJ5S2V5KHZtLmRhdGEsICJhbGxvd2xpc3QiLCAiYWxsb3dsaXN0IikudGFibGVGb290ZXJEYXRhDQogICAgICAgIC5jdXJQYWdlOw0KICAgICAgZ2V0QWxsb3dUYWJsZURhdGEodm0sIHBhZ2UpOw0KICAgIH0pOw0KfQ0K"},{"version":3,"sources":["PhoneCallFeature.vue"],"names":[],"mappings":";;;;;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"PhoneCallFeature.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <CommonPage :data=\"data\" @onDataChange=\"onCommonPageDataChange($event)\"></CommonPage>\r\n</template>\r\n\r\n<script>\r\nimport CommonPage from \"@/components/CommonPage.vue\";\r\nimport moment from \"moment\";\r\nimport {\r\n  showRequestSuccess,\r\n  deepClone,\r\n  getEnableSelectItems,\r\n  getItemByKey,\r\n  checkRangeOfNumber,\r\n  getIndexByKey,\r\n  showErrorInfo,\r\n  checkFileFormat,\r\n  showWarningInfo,\r\n} from \"@/js/common.js\";\r\n\r\nconst returnCodeItems = [\r\n  { key: 404, label: \"404(Not Found)\" },\r\n  { key: 480, label: \"480(Temporarily Unavailable)\" },\r\n  { key: 486, label: \"486(Busy Here)\" },\r\n  { key: 603, label: \"603(Decline)\" },\r\n];\r\n\r\nexport default {\r\n  components: {\r\n    CommonPage,\r\n  },\r\n  data() {\r\n    return {\r\n      changedCfgData: {},\r\n      submitCfgData: {},\r\n      apiData: {},\r\n      data: {\r\n        getDataSuccess: false,\r\n      },\r\n    };\r\n  },\r\n  created() {\r\n    getData(this);\r\n  },\r\n  methods: {\r\n    onCommonPageDataChange: function (event) {\r\n      setChangedData(this, event);\r\n      //界面变化\r\n      handlerPageChanged(this);\r\n    },\r\n  },\r\n};\r\n\r\nfunction setChangedData(vm, event) {\r\n  if (\r\n    event.itemKey == \"Config.Features.DND.StartTime\" ||\r\n    event.itemKey == \"Config.Features.DND.EndTime\"\r\n  ) {\r\n    vm.changedCfgData[event.itemKey] =\r\n      event.newVal.toDate().getHours() +\r\n      \":\" +\r\n      event.newVal.toDate().getMinutes();\r\n  } else {\r\n    vm.changedCfgData[event.itemKey] = event.newVal;\r\n  }\r\n}\r\n\r\nfunction handlerPageChanged(vm) {\r\n  let scheduleModeItem = getItemByKey(\r\n    vm.data,\r\n    \"DND\",\r\n    \"Config.Features.DND.ScheduleMode\"\r\n  );\r\n  let dndStartTimeItem = getItemByKey(\r\n    vm.data,\r\n    \"DND\",\r\n    \"Config.Features.DND.StartTime\"\r\n  );\r\n  let dndEndTimeItem = getItemByKey(\r\n    vm.data,\r\n    \"DND\",\r\n    \"Config.Features.DND.EndTime\"\r\n  );\r\n  if (vm.changedCfgData[\"Config.Features.DND.WholeDay\"] == \"1\") {\r\n    scheduleModeItem.disabled = true;\r\n    dndStartTimeItem.disabled = true;\r\n    dndEndTimeItem.disabled = true;\r\n  } else {\r\n    scheduleModeItem.disabled = false;\r\n    if (vm.changedCfgData[\"Config.Features.DND.ScheduleMode\"] == \"1\") {\r\n      dndStartTimeItem.disabled = false;\r\n      dndEndTimeItem.disabled = false;\r\n    } else {\r\n      dndStartTimeItem.disabled = true;\r\n      dndEndTimeItem.disabled = true;\r\n    }\r\n  }\r\n\r\n  let startTimeMin =\r\n    vm.changedCfgData[\"Config.Features.DND.StartTime\"].split(\":\")[0] * 60 +\r\n    vm.changedCfgData[\"Config.Features.DND.StartTime\"].split(\":\")[1];\r\n  let endTimeMin =\r\n    vm.changedCfgData[\"Config.Features.DND.EndTime\"].split(\":\")[0] * 60 +\r\n    vm.changedCfgData[\"Config.Features.DND.EndTime\"].split(\":\")[1];\r\n  if (parseInt(startTimeMin) >= parseInt(endTimeMin)) {\r\n    dndEndTimeItem.showHint = true;\r\n  } else {\r\n    dndEndTimeItem.showHint = false;\r\n  }\r\n}\r\n\r\nfunction submitData(vm) {\r\n  vm.data.submitLoading = true;\r\n\r\n  let requestData = {\r\n    target: \"phoneCallFeature\",\r\n    action: \"set\",\r\n    configData: vm.submitCfgData,\r\n  };\r\n  vm.$axios.post(\"api\", requestData).then((response) => {\r\n    if (\"undefined\" != typeof response) {\r\n      showRequestSuccess(vm);\r\n    }\r\n    vm.data.submitLoading = false;\r\n  });\r\n}\r\n\r\nfunction getData(vm) {\r\n  vm.$axios.get(\"api/phoneCallFeature/info\").then((response) => {\r\n    vm.getDataSuccess = true;\r\n    vm.apiData = response.data;\r\n    vm.changedCfgData = deepClone(response.data.configData);\r\n    createPageData(vm);\r\n    handlerPageChanged(vm);\r\n  });\r\n}\r\n\r\nfunction getCommitData(vm) {\r\n  vm.submitCfgData = {};\r\n  for (var changedKey in vm.changedCfgData) {\r\n    if (vm.apiData.configData[changedKey] != vm.changedCfgData[changedKey]) {\r\n      vm.submitCfgData[changedKey] = vm.changedCfgData[changedKey];\r\n    }\r\n  }\r\n}\r\n\r\nfunction createPageData(vm) {\r\n  vm.data = {\r\n    getDataSuccess: true,\r\n    breadCrumb: {\r\n      firstTitle: vm.$t(\"Phone\"),\r\n      secondTitle: vm.$t(\"CallFeature\"),\r\n    },\r\n    onSubmit: function () {\r\n      if (!checkCommitData(vm)) {\r\n        return;\r\n      }\r\n      getCommitData(vm);\r\n      submitData(vm);\r\n    },\r\n    onCancel: function () {\r\n      vm.data.cancelLoading = true;\r\n      getData(vm);\r\n    },\r\n    submitLoading: false,\r\n    cancelLoading: false,\r\n    contents: [],\r\n  };\r\n\r\n  vm.data.contents.push(createForwardContent(vm));\r\n  vm.data.contents.push(createDNDContent(vm));\r\n  vm.data.contents.push(createAudioCallSettingContent(vm));\r\n  vm.data.contents.push(createOthersContent(vm));\r\n  vm.data.contents.push(createAllowlistsContent(vm));\r\n  getAllowTableData(vm, 1);\r\n}\r\n\r\nfunction createAllowlistsContent(vm) {\r\n  //添加框\r\n  let addModalData = {\r\n    title: vm.$t(\"AddLabel\") + \" \" + vm.$t(\"AutoAnswerWhitelist\"),\r\n    key: -1,\r\n    cancelBtnLabel: vm.$t(\"Cancel\"),\r\n    submitBtnLabel: vm.$t(\"Submit\"),\r\n    visible: false,\r\n    showFooter: true,\r\n    items: [\r\n      {\r\n        title: vm.$t(\"DeviceLocation\"),\r\n        type: \"input\",\r\n        key: \"deviceLocation\",\r\n        value: \"\",\r\n        isWarn: false,\r\n        warnLabel: vm.$t(\"AllowDeviceNoEmpty\"),\r\n        description: vm.$t(\"AllowDeviceLocationDesc\"),\r\n      },\r\n      {\r\n        title: vm.$t(\"DeviceNumber\"),\r\n        type: \"input\",\r\n        key: \"deviceNumber\",\r\n        value: \"\",\r\n        isWarn: false,\r\n        warnLabel: vm.$t(\"AllowIPSIPNoEmpty\"),\r\n        description: vm.$t(\"AllowSIPDesc\"),\r\n      },\r\n    ],\r\n    onConfirm: function () {\r\n      onChangeAllowList(vm);\r\n    },\r\n  };\r\n\r\n  //导入框\r\n  let importModalData = {\r\n    title: \" \",\r\n    cancelBtnLabel: vm.$t(\"Cancel\"),\r\n    submitBtnLabel: vm.$t(\"Import\"),\r\n    showFooter: true,\r\n    visible: false,\r\n    items: [\r\n      {\r\n        title: vm.$t(\"AllowListImportHint\"),\r\n        type: \"file-input\",\r\n        key: \"import\",\r\n        acceptFileType: \".xml,.csv\",\r\n        loading: false,\r\n        value: {\r\n          fileData: {},\r\n          fileName: vm.$t(\"UpgradeFilePath\"),\r\n        },\r\n        importBtnName: vm.$t(\"Reset\"),\r\n      },\r\n    ],\r\n    onConfirm: function () {\r\n      onImport(vm);\r\n    },\r\n    confirmLoading: false,\r\n  };\r\n\r\n  //表头数据\r\n  let tableHeadData = {\r\n    addModalData: addModalData,\r\n    importModalData: importModalData,\r\n    exportItems: [\r\n      { key: \"xml\", label: \"xml\" },\r\n      { key: \"csv\", label: \"csv\" },\r\n    ],\r\n    onExport: function (type) {\r\n      onExport(vm, type);\r\n    },\r\n  };\r\n\r\n  //表尾数据\r\n  let tableFooterData = {\r\n    onDelete: function () {\r\n      onDeleteAllowList(vm, \"select\");\r\n    },\r\n    onDeleteAll: function () {\r\n      onDeleteAllowList(vm, \"all\");\r\n    },\r\n    onPageChange: function (page) {\r\n      getAllowTableData(vm, page);\r\n    },\r\n    sum: 0,\r\n    pageNumber: 10,\r\n    curPage: 0,\r\n    deleteDisabled: true,\r\n    deleteAllDisabled: false,\r\n  };\r\n\r\n  //表格数据\r\n\r\n  let content = {\r\n    key: \"allowlist\",\r\n    title: vm.$t(\"AutoAnswerWhitelist\"),\r\n    titleDescription: vm.$t(\"AllowlistDesc\"),\r\n    items: [\r\n      {\r\n        type: \"table\",\r\n        key: \"allowlist\",\r\n        showHead: true,\r\n        showFooter: true,\r\n        showRowSelection: true,\r\n        selectedRowKeys: [],\r\n        tableHeadData: tableHeadData,\r\n        tableFooterData: tableFooterData,\r\n        tableData: [],\r\n        tableColumns: [\r\n          {\r\n            type: \"label\",\r\n            title: vm.$t(\"Index\"),\r\n            dataIndex: \"index\",\r\n            scopedSlots: { customRender: \"index\" },\r\n            align: \"center\",\r\n            width: \"10%\",\r\n          },\r\n          {\r\n            type: \"label\",\r\n            title: vm.$t(\"DeviceLocation\"),\r\n            dataIndex: \"deviceLocation\",\r\n            scopedSlots: { customRender: \"deviceLocation\" },\r\n            align: \"center\",\r\n            width: \"40%\",\r\n          },\r\n          {\r\n            type: \"label\",\r\n            title: vm.$t(\"DeviceNumber\"),\r\n            dataIndex: \"deviceNumber\",\r\n            scopedSlots: { customRender: \"deviceNumber\" },\r\n            align: \"center\",\r\n            width: \"40%\",\r\n          },\r\n          {\r\n            type: \"edit\",\r\n            title: vm.$t(\"EditLabel\"),\r\n            dataIndex: \"edit\",\r\n            scopedSlots: { customRender: \"edit\" },\r\n            align: \"center\",\r\n            width: \"10%\",\r\n            onEdit: function (index, key) {\r\n              let allowTableItem = getItemByKey(\r\n                vm.data,\r\n                \"allowlist\",\r\n                \"allowlist\"\r\n              );\r\n              //location\r\n              allowTableItem.tableHeadData.addModalData.items[\r\n                getIndexByKey(\r\n                  allowTableItem.tableHeadData.addModalData.items,\r\n                  \"deviceLocation\"\r\n                )\r\n              ].value = allowTableItem.tableData[index].deviceLocation;\r\n              //number\r\n              allowTableItem.tableHeadData.addModalData.items[\r\n                getIndexByKey(\r\n                  allowTableItem.tableHeadData.addModalData.items,\r\n                  \"deviceNumber\"\r\n                )\r\n              ].value = allowTableItem.tableData[index].deviceNumber;\r\n            },\r\n          },\r\n        ],\r\n      },\r\n    ],\r\n  };\r\n  return content;\r\n}\r\n\r\nfunction createOthersContent(vm) {\r\n  let content = {\r\n    key: \"others\",\r\n    title: vm.$t(\"Others\"),\r\n    titleDescription: vm.$t(\"CallFeatureOthersDesc\"),\r\n    items: [\r\n      {\r\n        title: vm.$t(\"ReturnCodeRefuse\"),\r\n        type: \"select\",\r\n        key: \"Config.Features.REJECT.ReturnCode\",\r\n        value: vm.apiData.configData[\"Config.Features.REJECT.ReturnCode\"],\r\n        selectItems: returnCodeItems,\r\n        description: vm.$t(\"ReturnCodeRefuseDesc\"),\r\n      },\r\n      {\r\n        title: vm.$t(\"AutoAnswerDelay\"),\r\n        type: \"input\",\r\n        key: \"Config.Features.AUTOANSWER.Delay\",\r\n        value: vm.apiData.configData[\"Config.Features.AUTOANSWER.Delay\"],\r\n        showHint: true,\r\n        hintContent: \"( 0~30\" + vm.$t(\"Second\") + \" )\",\r\n        isWarn: false,\r\n        warnLabel: vm.$t(\"AutoAnswerDelayRangeError\"),\r\n        description: vm.$t(\"AutoAnswerDelayDesc\"),\r\n      },\r\n      {\r\n        title: vm.$t(\"AnswerMode\"),\r\n        type: \"select\",\r\n        key: \"Config.Features.ANSWERMODE.Priority\",\r\n        value: vm.apiData.configData[\"Config.Features.ANSWERMODE.Priority\"],\r\n        selectItems: [\r\n          { key: 0, label: vm.$t(\"Audio\") },\r\n          { key: 1, label: vm.$t(\"Video\") },\r\n        ],\r\n        description: vm.$t(\"AnswerModeDesc\"),\r\n      },\r\n      {\r\n        title: vm.$t(\"AnswerTone\"),\r\n        type: \"select\",\r\n        key: \"Config.Settings.AUDIO.AnswerTone\",\r\n        value: vm.apiData.configData[\"Config.Settings.AUDIO.AnswerTone\"],\r\n        selectItems: [\r\n          { key: 0, label: vm.$t(\"Disabled\") },\r\n          { key: 1, label: vm.$t(\"Enabled\") },\r\n        ],\r\n        description: vm.$t(\"AnswerModeDesc\"),\r\n      },\r\n      {\r\n        title: vm.$t(\"HangupBusyTone\"),\r\n        type: \"checkbox\",\r\n        key: \"Config.Settings.GENERAL.HungUpBusyTone\",\r\n        value: vm.apiData.configData[\"Config.Settings.GENERAL.HungUpBusyTone\"],\r\n        description: vm.$t(\"BusyToneDesc\"),\r\n      },\r\n      {\r\n        title: vm.$t(\"IndoorAutoAnswer\"),\r\n        type: \"checkbox\",\r\n        key: \"Config.Features.AUTO_ANSWER.IndoorToIndoor\",\r\n        value:\r\n          vm.apiData.configData[\"Config.Features.AUTO_ANSWER.IndoorToIndoor\"],\r\n        description: vm.$t(\"IndoorAutoAnswerDesc\"),\r\n      },\r\n      {\r\n        title: vm.$t(\"DirectIPCall\"),\r\n        type: \"checkbox\",\r\n        key: \"Config.Settings.GENERAL.DirectIP\",\r\n        value: vm.apiData.configData[\"Config.Settings.GENERAL.DirectIP\"],\r\n        description: vm.$t(\"DirectIPCallDesc\"),\r\n      },\r\n      {\r\n        title: vm.$t(\"DirectIPCallPort\"),\r\n        type: \"input\",\r\n        key: \"Config.Settings.GENERAL.DirectIPPort\",\r\n        value: vm.apiData.configData[\"Config.Settings.GENERAL.DirectIPPort\"],\r\n        isWarn: false,\r\n        showHint: true,\r\n        hintContent: \"( 1~65535 )\",\r\n        description: vm.$t(\"DirectIPCallPortDesc\"),\r\n      },\r\n    ],\r\n  };\r\n  return content;\r\n}\r\n\r\nfunction createAudioCallSettingContent(vm) {\r\n  let content = {\r\n    key: \"audioCallSetting\",\r\n    title: vm.$t(\"AudioCallSetting\"),\r\n    titleDescription: vm.$t(\"AudioCallSettingDesc\"),\r\n    items: [\r\n      {\r\n        title: vm.$t(\"ReceiveLiveStream\"),\r\n        type: \"checkbox\",\r\n        key: \"Config.Features.AUDIO_CALL.ReceiveLiveStream\",\r\n        value:\r\n          vm.apiData.configData[\"Config.Features.AUDIO_CALL.ReceiveLiveStream\"],\r\n        description: vm.$t(\"ReceiveLiveDesc\"),\r\n      },\r\n    ],\r\n  };\r\n  return content;\r\n}\r\n\r\nfunction createForwardContent(vm) {\r\n  let noAnswerRingTimeItems = [];\r\n  for (let i = 0; i < 21; i++) {\r\n    noAnswerRingTimeItems.push({\r\n      key: i * 6,\r\n      label: \" \" + i * 6,\r\n    });\r\n  }\r\n\r\n  let content = {\r\n    key: \"forwardTransfer\",\r\n    title: vm.$t(\"ForwardTransfer\"),\r\n    titleDescription: vm.$t(\"CallFowardDesc\"),\r\n    items: [\r\n      {\r\n        title: vm.$t(\"ForwardAlways\"),\r\n        type: \"select\",\r\n        key: \"Config.Forward.ALWAYS.Enable\",\r\n        value: vm.apiData.configData[\"Config.Forward.ALWAYS.Enable\"],\r\n        selectItems: getEnableSelectItems(vm),\r\n        description: vm.$t(\"AlwaysTransferDesc\"),\r\n      },\r\n      {\r\n        title: vm.$t(\"AlwaysTargetNumber\"),\r\n        type: \"input\",\r\n        key: \"Config.Forward.ALWAYS.Target\",\r\n        value: vm.apiData.configData[\"Config.Forward.ALWAYS.Target\"],\r\n        isWarn: false,\r\n        warnLabel: vm.$t(\"TargetNumberNoEmpty\"),\r\n        description: vm.$t(\"AlwaysForNumberDesc\"),\r\n      },\r\n      {\r\n        title: vm.$t(\"ForwardBusy\"),\r\n        type: \"select\",\r\n        key: \"Config.Forward.BUSY.Enable\",\r\n        value: vm.apiData.configData[\"Config.Forward.BUSY.Enable\"],\r\n        selectItems: getEnableSelectItems(vm),\r\n        description: vm.$t(\"BusyTransferDesc\"),\r\n      },\r\n      {\r\n        title: vm.$t(\"BusyTargetNumber\"),\r\n        type: \"input\",\r\n        key: \"Config.Forward.BUSY.Target\",\r\n        value: vm.apiData.configData[\"Config.Forward.BUSY.Target\"],\r\n        isWarn: false,\r\n        warnLabel: vm.$t(\"TargetNumberNoEmpty\"),\r\n        description: vm.$t(\"BusyForNumberDesc\"),\r\n      },\r\n      {\r\n        title: vm.$t(\"ForwardNoAnswer\"),\r\n        type: \"select\",\r\n        key: \"Config.Forward.TIMEOUT.Enable\",\r\n        value: vm.apiData.configData[\"Config.Forward.TIMEOUT.Enable\"],\r\n        selectItems: getEnableSelectItems(vm),\r\n        description: vm.$t(\"NoAnswreTransferDesc\"),\r\n      },\r\n      {\r\n        title: vm.$t(\"NoAnswerTargetNumber\"),\r\n        type: \"input\",\r\n        key: \"Config.Forward.TIMEOUT.Target\",\r\n        value: vm.apiData.configData[\"Config.Forward.TIMEOUT.Target\"],\r\n        isWarn: false,\r\n        warnLabel: vm.$t(\"TargetNumberNoEmpty\"),\r\n        description: vm.$t(\"NoAnswerForNumberDesc\"),\r\n      },\r\n      {\r\n        title: vm.$t(\"NoAnswerRingTime\") + \" (\" + vm.$t(\"Second\") + \")\",\r\n        type: \"select\",\r\n        key: \"Config.Forward.TIMEOUT.Timeout\",\r\n        value: vm.apiData.configData[\"Config.Forward.TIMEOUT.Timeout\"],\r\n        selectItems: noAnswerRingTimeItems,\r\n        description: vm.$t(\"NoAnswerDurationDesc\"),\r\n      },\r\n    ],\r\n  };\r\n  return content;\r\n}\r\n\r\nfunction createDNDContent(vm) {\r\n  let dndStartTime = new Date();\r\n  dndStartTime.setHours(\r\n    vm.apiData.configData[\"Config.Features.DND.StartTime\"].split(\":\")[0]\r\n  );\r\n  dndStartTime.setMinutes(\r\n    vm.apiData.configData[\"Config.Features.DND.StartTime\"].split(\":\")[1]\r\n  );\r\n\r\n  let dndEndTime = new Date();\r\n  dndEndTime.setHours(\r\n    vm.apiData.configData[\"Config.Features.DND.EndTime\"].split(\":\")[0]\r\n  );\r\n  dndEndTime.setMinutes(\r\n    vm.apiData.configData[\"Config.Features.DND.EndTime\"].split(\":\")[1]\r\n  );\r\n\r\n  let content = {\r\n    key: \"DND\",\r\n    title: vm.$t(\"DND\"),\r\n    titleDescription: vm.$t(\"DNDDesc\"),\r\n    items: [\r\n      {\r\n        title: vm.$t(\"WholeDay\"),\r\n        type: \"checkbox\",\r\n        key: \"Config.Features.DND.WholeDay\",\r\n        value: vm.apiData.configData[\"Config.Features.DND.WholeDay\"],\r\n        description: vm.$t(\"WholeDayDesc\"),\r\n      },\r\n      {\r\n        title: vm.$t(\"DNDSchedule\"),\r\n        type: \"checkbox\",\r\n        key: \"Config.Features.DND.ScheduleMode\",\r\n        disabled: false,\r\n        value: vm.apiData.configData[\"Config.Features.DND.ScheduleMode\"],\r\n        description: vm.$t(\"ScheduleDesc\"),\r\n      },\r\n      {\r\n        title: vm.$t(\"DNDStartTime\"),\r\n        type: \"time\",\r\n        key: \"Config.Features.DND.StartTime\",\r\n        timeFormat: vm.apiData.configData[\"Config.Settings.DATETIME.TimeFormat\"] == 0 ? \"h:mm a\" : \"HH:mm\",\r\n        use12Hours: vm.apiData.configData[\"Config.Settings.DATETIME.TimeFormat\"] == 0 ? true : false,\r\n        value: moment(dndStartTime),\r\n        description: vm.$t(\"DNDStartTimeDesc\"),\r\n      },\r\n      {\r\n        title: vm.$t(\"DNDEndTime\"),\r\n        type: \"time\",\r\n        key: \"Config.Features.DND.EndTime\",\r\n        timeFormat: vm.apiData.configData[\"Config.Settings.DATETIME.TimeFormat\"] == 0 ? \"h:mm a\" : \"HH:mm\",\r\n        use12Hours: vm.apiData.configData[\"Config.Settings.DATETIME.TimeFormat\"] == 0 ? true : false,\r\n        value: moment(dndEndTime),\r\n        showHint: true,\r\n        hintContent: vm.$t(\"NextDay\"),\r\n        description: vm.$t(\"DNDEndTimeDesc\"),\r\n      },\r\n      {\r\n        title: vm.$t(\"ReturnCodeDND\"),\r\n        type: \"select\",\r\n        key: \"Config.Features.DND.ReturnCode\",\r\n        value: vm.apiData.configData[\"Config.Features.DND.ReturnCode\"],\r\n        selectItems: returnCodeItems,\r\n        description: vm.$t(\"ReturnCodeDNDDesc\"),\r\n      },\r\n    ],\r\n  };\r\n  return content;\r\n}\r\n\r\nfunction checkCommitData(vm) {\r\n  return checkForwardData(vm) && checkOthersData(vm);\r\n}\r\n\r\nfunction checkOthersData(vm) {\r\n  let success = true;\r\n\r\n  if (\r\n    !checkRangeOfNumber(\r\n      vm.changedCfgData[\"Config.Features.AUTOANSWER.Delay\"],\r\n      0,\r\n      30\r\n    ) ||\r\n    \"\" == vm.changedCfgData[\"Config.Features.AUTOANSWER.Delay\"]\r\n  ) {\r\n    let item = getItemByKey(\r\n      vm.data,\r\n      \"others\",\r\n      \"Config.Features.AUTOANSWER.Delay\"\r\n    );\r\n    item.isWarn = true;\r\n    success = false;\r\n  }\r\n\r\n  let directIpPortitem = getItemByKey(\r\n    vm.data,\r\n    \"others\",\r\n    \"Config.Settings.GENERAL.DirectIPPort\"\r\n  );\r\n  if (\r\n    !checkRangeOfNumber(\r\n      vm.changedCfgData[\"Config.Settings.GENERAL.DirectIPPort\"],\r\n      1,\r\n      65535\r\n    )\r\n  ) {\r\n    directIpPortitem.isWarn = true;\r\n    directIpPortitem.warnLabel = vm.$t(\"DirectIPPortRangeError\");\r\n    success = false;\r\n  }\r\n  if (\r\n    vm.changedCfgData[\"Config.Settings.GENERAL.DirectIPPort\"] == \"5062\" ||\r\n    vm.changedCfgData[\"Config.Settings.GENERAL.DirectIPPort\"] == \"5063\"\r\n  ) {\r\n    directIpPortitem.isWarn = true;\r\n    directIpPortitem.warnLabel = vm.$t(\"SameSipPortErr\");\r\n    success = false;\r\n  }\r\n  return success;\r\n}\r\n\r\nfunction checkForwardData(vm) {\r\n  let success = true;\r\n  if (\r\n    vm.changedCfgData[\"Config.Forward.ALWAYS.Enable\"] == \"1\" &&\r\n    vm.changedCfgData[\"Config.Forward.ALWAYS.Target\"] == \"\"\r\n  ) {\r\n    let item = getItemByKey(\r\n      vm.data,\r\n      \"forwardTransfer\",\r\n      \"Config.Forward.ALWAYS.Target\"\r\n    );\r\n    item.isWarn = true;\r\n    success = false;\r\n  }\r\n  if (\r\n    vm.changedCfgData[\"Config.Forward.BUSY.Enable\"] == \"1\" &&\r\n    vm.changedCfgData[\"Config.Forward.BUSY.Target\"] == \"\"\r\n  ) {\r\n    let item = getItemByKey(\r\n      vm.data,\r\n      \"forwardTransfer\",\r\n      \"Config.Forward.BUSY.Target\"\r\n    );\r\n    item.isWarn = true;\r\n    success = false;\r\n  }\r\n  if (\r\n    vm.changedCfgData[\"Config.Forward.TIMEOUT.Enable\"] == \"1\" &&\r\n    vm.changedCfgData[\"Config.Forward.TIMEOUT.Target\"] == \"\"\r\n  ) {\r\n    let item = getItemByKey(\r\n      vm.data,\r\n      \"forwardTransfer\",\r\n      \"Config.Forward.TIMEOUT.Target\"\r\n    );\r\n    item.isWarn = true;\r\n    success = false;\r\n  }\r\n  return success;\r\n}\r\n\r\nfunction getAllowTableData(vm, page) {\r\n  vm.$axios.get(\"api/phoneCallFeature/get?page=\" + page).then((response) => {\r\n    let tableData = [];\r\n    let data = response.data.data;\r\n    for (let i = 0; i < data.allowList.length; i++) {\r\n      let item = {\r\n        key: data.allowList[i].id,\r\n        index: i + 1,\r\n        deviceLocation: data.allowList[i].location,\r\n        deviceNumber: data.allowList[i].number,\r\n        edit: i,\r\n      };\r\n      tableData.push(item);\r\n    }\r\n    getItemByKey(vm.data, \"allowlist\", \"allowlist\").tableData = tableData;\r\n    getItemByKey(vm.data, \"allowlist\", \"allowlist\").tableFooterData.sum =\r\n      data.sum;\r\n    getItemByKey(vm.data, \"allowlist\", \"allowlist\").tableFooterData.pageNumber =\r\n      data.pageNum;\r\n    getItemByKey(\r\n      vm.data,\r\n      \"allowlist\",\r\n      \"allowlist\"\r\n    ).tableFooterData.curPage = page;\r\n    getItemByKey(vm.data, \"allowlist\", \"allowlist\").selectedRowKeys = [];\r\n  });\r\n}\r\n\r\nfunction onChangeAllowList(vm) {\r\n  let addModalData = getItemByKey(vm.data, \"allowlist\", \"allowlist\")\r\n    .tableHeadData.addModalData;\r\n  let deviceLoaction =\r\n    addModalData.items[getIndexByKey(addModalData.items, \"deviceLocation\")];\r\n  let deviceNumber =\r\n    addModalData.items[getIndexByKey(addModalData.items, \"deviceNumber\")];\r\n  let id = addModalData.key;\r\n\r\n  let errFlag = false;\r\n  if (deviceLoaction.value == \"\") {\r\n    deviceLoaction.isWarn = true;\r\n    errFlag = true;\r\n  }\r\n\r\n  if (deviceNumber.value == \"\") {\r\n    deviceNumber.isWarn = true;\r\n    deviceNumber.warnLabel = vm.$t(\"AllowIPSIPNoEmpty\");\r\n    errFlag = true;\r\n  }\r\n\r\n  if (errFlag) {\r\n    return;\r\n  }\r\n\r\n  let data = {\r\n    location: deviceLoaction.value,\r\n    number: deviceNumber.value,\r\n    id: id,\r\n  };\r\n\r\n  let action = id >= 0 ? \"edit\" : \"add\";\r\n\r\n  let requestData = {\r\n    target: \"phoneCallFeature\",\r\n    action: action,\r\n    data: data,\r\n  };\r\n  vm.$axios.post(\"api\", requestData).then((response) => {\r\n    let ret = response.data.retcode;\r\n    if (ret == 0) {\r\n      deviceLoaction.value = \"\";\r\n      deviceNumber.value = \"\";\r\n      let page = 0;\r\n      let tableItem = getItemByKey(vm.data, \"allowlist\", \"allowlist\");\r\n      if (action == \"add\") {\r\n        //页面数据变化\r\n        page = Math.ceil(\r\n          (tableItem.tableFooterData.sum + 1) /\r\n            tableItem.tableFooterData.pageNumber\r\n        );\r\n      } else {\r\n        page = tableItem.tableFooterData.curPage;\r\n      }\r\n      getAllowTableData(vm, page);\r\n      //关闭窗口并展示成功\r\n      addModalData.visible = false;\r\n      showRequestSuccess(vm);\r\n    } else if (ret == 7) {\r\n      deviceNumber.isWarn = true;\r\n      deviceNumber.warnLabel = vm.$t(\"WhileNumberAlreadyExist\");\r\n    } else {\r\n      showErrorInfo(vm, vm.$t(\"WhileListAddErr\"));\r\n    }\r\n  });\r\n}\r\n\r\nfunction onDeleteAllowList(vm, type) {\r\n  if (\r\n    !confirm(\r\n      type == \"all\" ? vm.$t(\"DeleteAllConfirm\") : vm.$t(\"DeleteSelectedConfirm\")\r\n    )\r\n  ) {\r\n    return;\r\n  }\r\n  let selectedRowKeys = getItemByKey(vm.data, \"allowlist\", \"allowlist\")\r\n    .selectedRowKeys;\r\n  let requestData = {\r\n    target: \"phoneCallFeature\",\r\n    action: \"del\",\r\n    data: {\r\n      type: type,\r\n      ids: selectedRowKeys,\r\n    },\r\n  };\r\n  vm.$axios.post(\"api\", requestData).then((response) => {\r\n    showRequestSuccess(vm, vm.$t(\"DeleteAllowListSuccess\"));\r\n    if (type != \"all\") {\r\n      let tableFooterData = getItemByKey(vm.data, \"allowlist\", \"allowlist\")\r\n        .tableFooterData;\r\n      let sumPage = Math.ceil(\r\n        (tableFooterData.sum - selectedRowKeys.length) /\r\n          tableFooterData.pageNumber\r\n      );\r\n      sumPage = sumPage == 0 ? 1 : sumPage;\r\n      let page =\r\n        tableFooterData.curPage >= sumPage ? sumPage : tableFooterData.curPage;\r\n      getAllowTableData(vm, page);\r\n    } else {\r\n      getAllowTableData(vm, 1);\r\n    }\r\n  });\r\n}\r\n\r\nfunction onExport(vm, type) {\r\n  let requestData = {\r\n    target: \"phoneCallFeature\",\r\n    action: \"export\",\r\n    data: {\r\n      type: type,\r\n    },\r\n  };\r\n  vm.$axios.post(\"api\", requestData).then((response) => {\r\n    showRequestSuccess(vm, vm.$t(\"ExportSuccess\"));\r\n    let address = response.data.data.address;\r\n    window.open(address);\r\n  });\r\n}\r\n\r\nfunction onImport(vm) {\r\n  let modal = getItemByKey(vm.data, \"allowlist\", \"allowlist\").tableHeadData\r\n    .importModalData;\r\n  let item = modal.items[getIndexByKey(modal.items, \"import\")];\r\n  let fileName = item.value.fileName;\r\n  if (fileName == \"\" || fileName == vm.$t(\"UpgradeFilePath\")) {\r\n    showErrorInfo(vm, vm.$t(\"FileEmptyWarning\"));\r\n    return;\r\n  }\r\n\r\n  modal.confirmLoading = true;\r\n  const upData = new FormData();\r\n  upData.append(\"file\", item.value.fileData);\r\n  axios\r\n    .post(\"api/phoneCallFeature/import\", upData, {\r\n      headers: {\r\n        \"Content-Type\": \"multipart/form-data\",\r\n      },\r\n    })\r\n    .then((res) => {\r\n      if (res.data.retcode == -1) {\r\n        showErrorInfo(vm, vm.$t(\"WhiteListImportFail\"));\r\n      } else if (res.data.retcode == 2) {\r\n        showWarningInfo(vm, vm.$t(\"WhiteListImportExistWarning\"));\r\n        item.value.fileName = vm.$t(\"UpgradeFilePath\");\r\n        item.value.fileData = {};\r\n        modal.visible = false;\r\n      } else if (res.data.retcode == 0) {\r\n        showRequestSuccess(vm, vm.$t(\"WhiteListImportSuccess\"));\r\n        item.value.fileName = vm.$t(\"UpgradeFilePath\");\r\n        item.value.fileData = {};\r\n        modal.visible = false;\r\n      }\r\n      modal.confirmLoading = false;\r\n      let page = getItemByKey(vm.data, \"allowlist\", \"allowlist\").tableFooterData\r\n        .curPage;\r\n      getAllowTableData(vm, page);\r\n    });\r\n}\r\n</script>"]}]}