{"remainingRequest":"/workspace3/minjie.chen/gitlab-work/advance-indoor/resources/www/MODELESS/NORMAL/htdocs/node_modules/vue-loader/lib/index.js??vue-loader-options!/workspace3/minjie.chen/gitlab-work/advance-indoor/resources/www/MODELESS/NORMAL/htdocs/src/components/ModalFileInput.vue?vue&type=script&lang=js&","dependencies":[{"path":"/workspace3/minjie.chen/gitlab-work/advance-indoor/resources/www/MODELESS/NORMAL/htdocs/src/components/ModalFileInput.vue","mtime":1600155105018},{"path":"/workspace3/minjie.chen/gitlab-work/advance-indoor/resources/www/MODELESS/NORMAL/htdocs/node_modules/cache-loader/dist/cjs.js","mtime":1600155105894},{"path":"/workspace3/minjie.chen/gitlab-work/advance-indoor/resources/www/MODELESS/NORMAL/htdocs/node_modules/babel-loader/lib/index.js","mtime":1600155105338},{"path":"/workspace3/minjie.chen/gitlab-work/advance-indoor/resources/www/MODELESS/NORMAL/htdocs/node_modules/cache-loader/dist/cjs.js","mtime":1600155105894},{"path":"/workspace3/minjie.chen/gitlab-work/advance-indoor/resources/www/MODELESS/NORMAL/htdocs/node_modules/vue-loader/lib/index.js","mtime":1600155105414}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBQb3BvdmVyIGZyb20gIkAvY29tcG9uZW50cy9Qb3BvdmVyLnZ1ZSI7CmltcG9ydCB7IGNoZWNrRmlsZUZvcm1hdCwgc2hvd0Vycm9ySW5mbyB9IGZyb20gIkAvanMvY29tbW9uLmpzIjsKZXhwb3J0IGRlZmF1bHQgewogIGNvbXBvbmVudHM6IHsKICAgIFBvcG92ZXIsCiAgfSwKICBwcm9wczogewogICAgc2hvd0Rlc2NyaXB0aW9uOiB7IHR5cGU6IEJvb2xlYW4sIGRlZmF1bHQ6IGZhbHNlIH0sCiAgICBkZXNjcmlwdGlvbkNvbnRlbnQ6IFN0cmluZywKICAgIGxhYmVsVGl0bGU6IFN0cmluZywKICAgIGFjY2VwdEZpbGVUeXBlOiB7IHR5cGU6IFN0cmluZywgZGVmYXVsdDogIiIgfSwKICAgIGltcG9ydEJ0bk5hbWU6IHsgdHlwZTogU3RyaW5nLCBkZWZhdWx0OiAiSW1wb3J0IiB9LAogICAgdXBsb2FkRnVuY3Rpb246IHsKICAgICAgdHlwZTogRnVuY3Rpb24sCiAgICAgIGRlZmF1bHQ6IGZ1bmN0aW9uICgpIHsKICAgICAgICBjb25zb2xlLmxvZygiY2xpY2sgaW1wb3J0Iik7CiAgICAgIH0sCiAgICB9LAogICAgdmFsdWU6IE9iamVjdCwKICAgIG1heFNpemU6IHsgdHlwZTogTnVtYmVyLCBkZWZhdWx0OiA1MCAqIDEwMjQgKiAxMDI0IH0sCiAgICBpbWdSZXNvbHV0aW9uV2lkdGg6IHsgdHlwZTogTnVtYmVyLCBkZWZhdWx0OiAtMSB9LAogICAgaW1nUmVzb2x1dGlvbkhlaWdodDogeyB0eXBlOiBOdW1iZXIsIGRlZmF1bHQ6IC0xIH0sCiAgfSwKICBtZXRob2RzOiB7CiAgICBiZWZvcmVVcGxvYWQ6IGZ1bmN0aW9uIChpbmZvKSB7CiAgICAgIC8vY2hlY2sgZm9ybWF0CiAgICAgIGxldCBhY2NlcHRUeXBlcyA9IHRoaXMuYWNjZXB0RmlsZVR5cGUuc3BsaXQoIiwiKTsKICAgICAgbGV0IGNoZWNrU3VjY2VzcyA9IGZhbHNlOwogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGFjY2VwdFR5cGVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgaWYgKGNoZWNrRmlsZUZvcm1hdChpbmZvLm5hbWUsIGFjY2VwdFR5cGVzW2ldLCBhY2NlcHRUeXBlc1tpXS5sZW5ndGgpKSB7CiAgICAgICAgICBjaGVja1N1Y2Nlc3MgPSB0cnVlOwogICAgICAgIH0KICAgICAgfQogICAgICBpZiAoIWNoZWNrU3VjY2VzcykgewogICAgICAgIHNob3dFcnJvckluZm8odGhpcywgdGhpcy4kdCgiRmlsZUZvcm1hdFdhcm5pbmciKSk7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICAgIC8vY2hlY2sgZmlsZSBzaXplCiAgICAgIGlmICh0aGlzLm1heFNpemUgPiAwICYmIGluZm8uc2l6ZSA+IHRoaXMubWF4U2l6ZSkgewogICAgICAgIHNob3dFcnJvckluZm8odGhpcywgdGhpcy4kdCgiVXBsb2FkaW5nRmlsZVRvb0xhcmdlV2FybmluZyIpKTsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgICAgLy9jaGVjayBmaWxlIG5hbWUKICAgICAgaWYgKGluZm8ubmFtZS5sZW5ndGggPiAxMjcpIHsKICAgICAgICBzaG93RXJyb3JJbmZvKHRoaXMsIHRoaXMuJHQoIldhcm5pbmdGaWxlTmFtZVRvb0xvbmciKSk7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICAvL2NoZWNrIGltZyByZXNvbHV0aW9uCiAgICAgIGlmICgKICAgICAgICAoY2hlY2tGaWxlRm9ybWF0KGluZm8ubmFtZSwgIi5QTkciLCA0KSB8fAogICAgICAgICAgY2hlY2tGaWxlRm9ybWF0KGluZm8ubmFtZSwgIi5KUEciLCA0KSB8fAogICAgICAgICAgY2hlY2tGaWxlRm9ybWF0KGluZm8ubmFtZSwgIi5KUEVHIiwgNSkpICYmCiAgICAgICAgdGhpcy5pbWdSZXNvbHV0aW9uV2lkdGggPiAwICYmCiAgICAgICAgdGhpcy5pbWdSZXNvbHV0aW9uSGVpZ2h0ID4gMAogICAgICApIHsKICAgICAgICB2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsKICAgICAgICByZWFkZXIucmVhZEFzRGF0YVVSTChpbmZvKTsKICAgICAgICB2YXIgdm0gPSB0aGlzOwogICAgICAgIHJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICB2YXIgaW1nID0gbmV3IEltYWdlKCk7CiAgICAgICAgICBpbWcuc3JjID0gcmVhZGVyLnJlc3VsdDsKICAgICAgICAgIGltZy5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICBpbWcud2lkdGggPiB2bS5pbWdSZXNvbHV0aW9uV2lkdGggfHwKICAgICAgICAgICAgICBpbWcuaGVpZ2h0ID4gdm0uaW1nUmVzb2x1dGlvbkhlaWdodAogICAgICAgICAgICApIHsKICAgICAgICAgICAgICBzaG93RXJyb3JJbmZvKHZtLCB2bS4kdCgiSW1hZ2VSZXNvbHV0aW9uRXJyIikpOwogICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBpbmZvLmhlaWdodCA9IGltZy5oZWlnaHQ7CiAgICAgICAgICAgICAgaW5mby53aWR0aCA9IGltZy53aWR0aDsKICAgICAgICAgICAgICB2bS5maWxlRGF0YSA9IGluZm87CiAgICAgICAgICAgICAgdm0udmFsdWUuZmlsZU5hbWUgPSBpbmZvLm5hbWU7CiAgICAgICAgICAgICAgdm0ub25DaGFuZ2UoKTsKICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICAgIH07CiAgICAgICAgICBpbWcub25lcnJvciA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgLy/lm77niYfliqDovb3plJnor68KICAgICAgICAgICAgc2hvd0Vycm9ySW5mbyh2bSwgdm0uJHQoIkZpbGVGb3JtYXRXYXJuaW5nIikpOwogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICB9OwogICAgICAgIH07CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy9kb25lCiAgICAgICAgdGhpcy5maWxlRGF0YSA9IGluZm87CiAgICAgICAgdGhpcy52YWx1ZS5maWxlTmFtZSA9IGluZm8ubmFtZTsKICAgICAgICB0aGlzLm9uQ2hhbmdlKCk7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICB9LAogICAgb25DaGFuZ2U6IGZ1bmN0aW9uICgpIHsKICAgICAgbGV0IGRhdGEgPSB7CiAgICAgICAgZmlsZU5hbWU6IHRoaXMudmFsdWUuZmlsZU5hbWUsCiAgICAgICAgZmlsZURhdGE6IHRoaXMuZmlsZURhdGEsCiAgICAgIH07CiAgICAgIHRoaXMuJGVtaXQoImNoYW5nZSIsIGRhdGEpOwogICAgfSwKICAgIG9uQ2FuY2VsOiBmdW5jdGlvbiAoKSB7CiAgICAgIHRoaXMudmFsdWUuZmlsZU5hbWUgPSB0aGlzLiR0KCJVcGdyYWRlRmlsZVBhdGgiKTsKICAgICAgdGhpcy5maWxlRGF0YSA9IHt9OwogICAgICB0aGlzLm9uQ2hhbmdlKCk7CiAgICB9LAogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIC8vIGZpbGVOYW1lOiB0aGlzLiR0KCJVcGdyYWRlRmlsZVBhdGgiKSwKICAgICAgZmlsZURhdGE6IHt9LAogICAgICBpbXBvcnRCdG5EaXNhYmxlZDogdHJ1ZSwKICAgIH07CiAgfSwKICB3YXRjaDogewogICAgdmFsdWUobmV3VmFsLCBvbGRWYWwpIHsKICAgICAgbGV0IGZpbGVOYW1lID0gbmV3VmFsLmZpbGVOYW1lOwogICAgICBpZiAoZmlsZU5hbWUgIT0gIiIgJiYgZmlsZU5hbWUgIT0gdGhpcy4kdCgiVXBncmFkZUZpbGVQYXRoIikpIHsKICAgICAgICB0aGlzLmltcG9ydEJ0bkRpc2FibGVkID0gZmFsc2U7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5pbXBvcnRCdG5EaXNhYmxlZCA9IHRydWU7CiAgICAgIH0KICAgIH0sCiAgfSwKfTsK"},{"version":3,"sources":["ModalFileInput.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ModalFileInput.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div class=\"ak-modal-file-input-div\">\n    <div>\n      <label class=\"ak-modal-file-input-title-label\">{{labelTitle}}</label>\n    </div>\n    <div :style=\"{display:'flex'}\">\n      <div class=\"ak-modal-file-input-file-name\">\n        <label>{{value.fileName}}</label>\n        <a-upload\n          name=\"file\"\n          :showUploadList=\"false\"\n          :accept=\"acceptFileType\"\n          :beforeUpload=\"beforeUpload\"\n          :style=\"{float:'right'}\"\n        >\n          <a-button type=\"file\" class=\"ak-modal-file-input-file-button\">{{$t('UpgradeFile')}}</a-button>\n        </a-upload>\n      </div>\n      <a-button\n        type=\"primary\"\n        class=\"ak-modal-file-input-btn\"\n        @click=\"onCancel\"\n        :disabled=\"importBtnDisabled\"\n      >{{ importBtnName }}</a-button>\n\n      <Popover\n        :showDescription=\"showDescription\"\n        :descriptionContent=\"descriptionContent\"\n        :style=\"{paddingLeft:'50px'}\"\n      ></Popover>\n    </div>\n  </div>\n</template>\n\n<script>\nimport Popover from \"@/components/Popover.vue\";\nimport { checkFileFormat, showErrorInfo } from \"@/js/common.js\";\nexport default {\n  components: {\n    Popover,\n  },\n  props: {\n    showDescription: { type: Boolean, default: false },\n    descriptionContent: String,\n    labelTitle: String,\n    acceptFileType: { type: String, default: \"\" },\n    importBtnName: { type: String, default: \"Import\" },\n    uploadFunction: {\n      type: Function,\n      default: function () {\n        console.log(\"click import\");\n      },\n    },\n    value: Object,\n    maxSize: { type: Number, default: 50 * 1024 * 1024 },\n    imgResolutionWidth: { type: Number, default: -1 },\n    imgResolutionHeight: { type: Number, default: -1 },\n  },\n  methods: {\n    beforeUpload: function (info) {\n      //check format\n      let acceptTypes = this.acceptFileType.split(\",\");\n      let checkSuccess = false;\n      for (let i = 0; i < acceptTypes.length; i++) {\n        if (checkFileFormat(info.name, acceptTypes[i], acceptTypes[i].length)) {\n          checkSuccess = true;\n        }\n      }\n      if (!checkSuccess) {\n        showErrorInfo(this, this.$t(\"FileFormatWarning\"));\n        return false;\n      }\n      //check file size\n      if (this.maxSize > 0 && info.size > this.maxSize) {\n        showErrorInfo(this, this.$t(\"UploadingFileTooLargeWarning\"));\n        return false;\n      }\n      //check file name\n      if (info.name.length > 127) {\n        showErrorInfo(this, this.$t(\"WarningFileNameTooLong\"));\n        return false;\n      }\n\n      //check img resolution\n      if (\n        (checkFileFormat(info.name, \".PNG\", 4) ||\n          checkFileFormat(info.name, \".JPG\", 4) ||\n          checkFileFormat(info.name, \".JPEG\", 5)) &&\n        this.imgResolutionWidth > 0 &&\n        this.imgResolutionHeight > 0\n      ) {\n        var reader = new FileReader();\n        reader.readAsDataURL(info);\n        var vm = this;\n        reader.onload = function () {\n          var img = new Image();\n          img.src = reader.result;\n          img.onload = function () {\n            if (\n              img.width > vm.imgResolutionWidth ||\n              img.height > vm.imgResolutionHeight\n            ) {\n              showErrorInfo(vm, vm.$t(\"ImageResolutionErr\"));\n              return false;\n            } else {\n              info.height = img.height;\n              info.width = img.width;\n              vm.fileData = info;\n              vm.value.fileName = info.name;\n              vm.onChange();\n              return false;\n            }\n          };\n          img.onerror = function () {\n            //图片加载错误\n            showErrorInfo(vm, vm.$t(\"FileFormatWarning\"));\n            return false;\n          };\n        };\n      } else {\n        //done\n        this.fileData = info;\n        this.value.fileName = info.name;\n        this.onChange();\n        return false;\n      }\n    },\n    onChange: function () {\n      let data = {\n        fileName: this.value.fileName,\n        fileData: this.fileData,\n      };\n      this.$emit(\"change\", data);\n    },\n    onCancel: function () {\n      this.value.fileName = this.$t(\"UpgradeFilePath\");\n      this.fileData = {};\n      this.onChange();\n    },\n  },\n  data() {\n    return {\n      // fileName: this.$t(\"UpgradeFilePath\"),\n      fileData: {},\n      importBtnDisabled: true,\n    };\n  },\n  watch: {\n    value(newVal, oldVal) {\n      let fileName = newVal.fileName;\n      if (fileName != \"\" && fileName != this.$t(\"UpgradeFilePath\")) {\n        this.importBtnDisabled = false;\n      } else {\n        this.importBtnDisabled = true;\n      }\n    },\n  },\n};\n</script>\n\n<style lang=\"less\" scoped>\n.ak-modal-file-input-div {\n  padding-left: 153px;\n  font-size: 16px;\n  margin-top: 25px;\n}\n\n.ak-modal-file-input-title-label {\n  max-width: 700px;\n  display: inline-block;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  padding-top: 4px;\n  margin-bottom: 26px;\n  color: #333333;\n}\n\n.ak-modal-file-input-hint-label {\n  color: #9a9a9a;\n  margin-left: 10px;\n  padding-top: 4px;\n}\n\n.ak-modal-file-input-file-name {\n  width: 380px;\n  border: 1px solid rgba(201, 201, 201, 1);\n  border-radius: 3px;\n  height: 32px;\n  background: rgba(249, 249, 249, 1);\n  color: #999999;\n  font-size: 16px;\n  padding-left: 16px;\n  font-weight: 400;\n}\n\n.ak-modal-file-input-file-button {\n  float: right;\n  width: 110px;\n  border-radius: 3px;\n  border: none;\n  background: #0087f7;\n  font-size: 16px;\n  color: #ffffff;\n  height: 30px !important;\n}\n\n.ak-modal-file-input-file-name > label {\n  display: inline-block;\n  margin-top: 2px;\n  max-width: 250px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n\n/deep/.ant-btn:hover,\n.ant-btn:focus,\n.ant-btn:active,\n.ant-btn.active {\n  background: #0087f7;\n  color: #ffffff;\n}\n\n.ak-modal-file-input-btn {\n  width: 120px;\n  background: #0087f7;\n  color: #ffffff;\n  font-size: 16px;\n  margin-left: 30px;\n}\n</style>"]}]}