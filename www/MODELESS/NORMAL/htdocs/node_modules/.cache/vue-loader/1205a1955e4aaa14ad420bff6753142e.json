{"remainingRequest":"/workspace3/minjie.chen/gitlab-work/advance-indoor/resources/www/MODELESS/NORMAL/htdocs/node_modules/vue-loader/lib/index.js??vue-loader-options!/workspace3/minjie.chen/gitlab-work/advance-indoor/resources/www/MODELESS/NORMAL/htdocs/src/views/PhoneRelay.vue?vue&type=script&lang=js&","dependencies":[{"path":"/workspace3/minjie.chen/gitlab-work/advance-indoor/resources/www/MODELESS/NORMAL/htdocs/src/views/PhoneRelay.vue","mtime":1600155105014},{"path":"/workspace3/minjie.chen/gitlab-work/advance-indoor/resources/www/MODELESS/NORMAL/htdocs/node_modules/babel-loader/lib/index.js","mtime":1600155105338},{"path":"/workspace3/minjie.chen/gitlab-work/advance-indoor/resources/www/MODELESS/NORMAL/htdocs/node_modules/cache-loader/dist/cjs.js","mtime":1600155105894},{"path":"/workspace3/minjie.chen/gitlab-work/advance-indoor/resources/www/MODELESS/NORMAL/htdocs/node_modules/vue-loader/lib/index.js","mtime":1600155105414}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KCmltcG9ydCBDb21tb25QYWdlIGZyb20gIkAvY29tcG9uZW50cy9Db21tb25QYWdlLnZ1ZSI7CmltcG9ydCB7CiAgc2hvd1JlcXVlc3RTdWNjZXNzLAogIGRlZXBDbG9uZSwKICBub3RDb250YWluSW52YWxpZCwKICBnZXRJdGVtQnlLZXksCiAgY2hlY2tJcEFkZHIsCn0gZnJvbSAiQC9qcy9jb21tb24uanMiOwoKZXhwb3J0IGRlZmF1bHQgewogIGNvbXBvbmVudHM6IHsKICAgIENvbW1vblBhZ2UsCiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgc3RhdHVzSXRlbXM6IFsKICAgICAgICB7IGtleTogMCwgbGFiZWw6IHRoaXMuJHQoIkRpc2FibGVkIikgfSwKICAgICAgICB7IGtleTogMSwgbGFiZWw6IHRoaXMuJHQoIkVuYWJsZWQiKSB9LAogICAgICBdLAogICAgICBjaGFuZ2VkQ2ZnRGF0YToge30sCiAgICAgIHN1Ym1pdENmZ0RhdGE6IHt9LAogICAgICBhcGlEYXRhOiB7fSwKICAgICAgZGF0YTogewogICAgICAgIGdldERhdGFTdWNjZXNzOiBmYWxzZSwKICAgICAgfSwKICAgIH07CiAgfSwKICBjcmVhdGVkKCkgewogICAgZ2V0RGF0YSh0aGlzKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIG9uQ29tbW9uUGFnZURhdGFDaGFuZ2U6IGZ1bmN0aW9uIChldmVudCkgewogICAgICBzZXRDaGFuZ2VkRGF0YSh0aGlzLCBldmVudCk7CiAgICAgIC8v55WM6Z2i5Y+Y5YyWCiAgICAgIGhhbmRsZXJQYWdlQ2hhbmdlZCh0aGlzKTsKICAgIH0sCiAgfSwKfTsKCmZ1bmN0aW9uIHNldENoYW5nZWREYXRhKHZtLCBldmVudCkgewogIGlmICgKICAgIGV2ZW50LmNvbnRlbnRLZXkgPT0gInJlbGF5U2V0dGluZyIgfHwKICAgIGV2ZW50LmNvbnRlbnRLZXkgPT0gIm9wZW5SZWxheVZpYUh0dHAiIHx8CiAgICBldmVudC5jb250ZW50S2V5ID09ICJyZW1vdGVDb250cm9sIiB8fAogICAgZXZlbnQuY29udGVudEtleSA9PSAid2ViUmVsYXkiCiAgKSB7CiAgICB2bS5jaGFuZ2VkQ2ZnRGF0YVtldmVudC5pdGVtS2V5XSA9IGV2ZW50Lm5ld1ZhbDsKICB9IGVsc2UgaWYgKAogICAgZXZlbnQuY29udGVudEtleSA9PSAic29mdGtleUluVGFsa2luZyIgJiYKICAgIGV2ZW50Lml0ZW1LZXkgPT0gInNvZnRrZXlJblRhbGtpbmciCiAgKSB7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGV2ZW50Lm5ld1ZhbC5sZW5ndGg7IGkrKykgewogICAgICB2bS5jaGFuZ2VkQ2ZnRGF0YVsiQ29uZmlnLkRvb3JTZXR0aW5nLlJFTEFZLlRhbGtpbmdTdGF0dXMiICsgKGkgKyAxKV0gPQogICAgICAgIGV2ZW50Lm5ld1ZhbFtpXS5zdGF0dXMudmFsdWU7CiAgICAgIHZtLmNoYW5nZWRDZmdEYXRhWwogICAgICAgICJDb25maWcuRG9vclNldHRpbmcuUkVMQVkuVGFsa2luZ0NvbERpc3BsYXlOYW1lIiArIChpICsgMSkKICAgICAgXSA9IGV2ZW50Lm5ld1ZhbFtpXS5kaXNwbGF5TmFtZS52YWx1ZTsKICAgICAgdm0uY2hhbmdlZENmZ0RhdGFbIkNvbmZpZy5Eb29yU2V0dGluZy5SRUxBWS5UYWxraW5nUmVsYXlUeXBlIiArIChpICsgMSldID0KICAgICAgICBldmVudC5uZXdWYWxbaV0udHlwZS52YWx1ZTsKICAgIH0KICB9IGVsc2UgaWYgKAogICAgZXZlbnQuY29udGVudEtleSA9PSAic29mdGtleUluSG9tZU9yTW9yZSIgJiYKICAgIGV2ZW50Lml0ZW1LZXkgPT0gInNvZnRrZXlJbkhvbWVPck1vcmUiCiAgKSB7CiAgICB2bS5jaGFuZ2VkQ2ZnRGF0YVsiQ29uZmlnLkRvb3JTZXR0aW5nLlJFTEFZLklkbGVTdGF0dXMiXSA9CiAgICAgIGV2ZW50Lm5ld1ZhbFswXS5zdGF0dXMudmFsdWU7CiAgICB2bS5jaGFuZ2VkQ2ZnRGF0YVsiQ29uZmlnLkRvb3JTZXR0aW5nLlJFTEFZLklkbGVEaXNwbGF5TmFtZSJdID0KICAgICAgZXZlbnQubmV3VmFsWzBdLmRpc3BsYXlOYW1lLnZhbHVlOwogICAgdm0uY2hhbmdlZENmZ0RhdGFbIkNvbmZpZy5Eb29yU2V0dGluZy5SRUxBWS5JZGxlUmVsYXlUeXBlIl0gPQogICAgICBldmVudC5uZXdWYWxbMF0udHlwZS52YWx1ZTsKICB9IGVsc2UgaWYgKAogICAgZXZlbnQuY29udGVudEtleSA9PSAic29mdGtleUluQ2FsbFByZXZpZXciICYmCiAgICBldmVudC5pdGVtS2V5ID09ICJzb2Z0a2V5SW5DYWxsUHJldmlldyIKICApIHsKICAgIHZtLmNoYW5nZWRDZmdEYXRhWyJDb25maWcuRG9vclNldHRpbmcuUkVMQVkuSW5jb21pbmdTdGF0dXMiXSA9CiAgICAgIGV2ZW50Lm5ld1ZhbFswXS5zdGF0dXMudmFsdWU7CiAgICB2bS5jaGFuZ2VkQ2ZnRGF0YVsiQ29uZmlnLkRvb3JTZXR0aW5nLlJFTEFZLkluY29taW5nRGlzcGxheU5hbWUiXSA9CiAgICAgIGV2ZW50Lm5ld1ZhbFswXS5kaXNwbGF5TmFtZS52YWx1ZTsKICAgIHZtLmNoYW5nZWRDZmdEYXRhWyJDb25maWcuRG9vclNldHRpbmcuUkVMQVkuSW5jb21pbmdSZWxheVR5cGUiXSA9CiAgICAgIGV2ZW50Lm5ld1ZhbFswXS50eXBlLnZhbHVlOwogIH0gZWxzZSBpZiAoCiAgICBldmVudC5jb250ZW50S2V5ID09ICJzb2Z0a2V5SW5Nb25pdG9yIiAmJgogICAgZXZlbnQuaXRlbUtleSA9PSAic29mdGtleUluTW9uaXRvciIKICApIHsKICAgIHZtLmNoYW5nZWRDZmdEYXRhWyJDb25maWcuRG9vclNldHRpbmcuUkVMQVkuTW9uaXRvclN0YXR1cyJdID0KICAgICAgZXZlbnQubmV3VmFsWzBdLnN0YXR1cy52YWx1ZTsKICAgIHZtLmNoYW5nZWRDZmdEYXRhWyJDb25maWcuRG9vclNldHRpbmcuUkVMQVkuTW9uaXRvckRpc3BsYXlOYW1lIl0gPQogICAgICBldmVudC5uZXdWYWxbMF0uZGlzcGxheU5hbWUudmFsdWU7CiAgICB2bS5jaGFuZ2VkQ2ZnRGF0YVsiQ29uZmlnLkRvb3JTZXR0aW5nLlJFTEFZLk1vbml0b3JSZWxheVR5cGUiXSA9CiAgICAgIGV2ZW50Lm5ld1ZhbFswXS50eXBlLnZhbHVlOwogIH0gZWxzZSBpZiAoCiAgICBldmVudC5jb250ZW50S2V5ID09ICJyZW1vdGVSZWxheUJ5SHR0cCIgJiYKICAgIGV2ZW50Lml0ZW1LZXkgPT0gInJlbW90ZVJlbGF5QnlIdHRwIiAmJgogICAgZXZlbnQudGFibGVPcGVyYXRlVHlwZSAhPSAic2VsZWN0aW9uIgogICkgewogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBldmVudC5uZXdWYWwubGVuZ3RoOyBpKyspIHsKICAgICAgdm0uY2hhbmdlZENmZ0RhdGFbIkNvbmZpZy5Eb29yU2V0dGluZy5SRU1PVEVSRUxBWS5SZW1vdGVJUCIgKyBpXSA9CiAgICAgICAgZXZlbnQubmV3VmFsW2ldLnJlbW90ZUlwLnZhbHVlOwogICAgICB2bS5jaGFuZ2VkQ2ZnRGF0YVsiQ29uZmlnLkRvb3JTZXR0aW5nLlJFTU9URVJFTEFZLlJlbW90ZVVSTCIgKyBpXSA9CiAgICAgICAgZXZlbnQubmV3VmFsW2ldLnJlbW90ZUFkZHJlc3MudmFsdWU7CiAgICAgIHZtLmNoYW5nZWRDZmdEYXRhWyJDb25maWcuRG9vclNldHRpbmcuUkVNT1RFUkVMQVkuUmVtb3RlVXNlciIgKyBpXSA9CiAgICAgICAgZXZlbnQubmV3VmFsW2ldLnVzZXJuYW1lLnZhbHVlOwogICAgICB2bS5jaGFuZ2VkQ2ZnRGF0YVsiQ29uZmlnLkRvb3JTZXR0aW5nLlJFTU9URVJFTEFZLlJlbW90ZVBhc3N3ZCIgKyBpXSA9CiAgICAgICAgZXZlbnQubmV3VmFsW2ldLnBhc3N3b3JkLnZhbHVlOwogICAgICBsZXQgZG9vck51bSA9ICIiOwogICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGV2ZW50Lm5ld1ZhbFtpXS5kb29yTnVtLnZhbHVlLmxlbmd0aDsgaisrKSB7CiAgICAgICAgZG9vck51bSArPSBldmVudC5uZXdWYWxbaV0uZG9vck51bS52YWx1ZVtqXTsKICAgICAgICBpZiAoaiAhPSBldmVudC5uZXdWYWxbaV0uZG9vck51bS52YWx1ZS5sZW5ndGggLSAxKSB7CiAgICAgICAgICBkb29yTnVtICs9ICIsIjsKICAgICAgICB9CiAgICAgIH0KICAgICAgdm0uY2hhbmdlZENmZ0RhdGFbCiAgICAgICAgIkNvbmZpZy5Eb29yU2V0dGluZy5SRU1PVEVSRUxBWS5SZW1vdGVEb29yTnVtIiArIGkKICAgICAgXSA9IGRvb3JOdW07CiAgICB9CiAgfSBlbHNlIGlmICgKICAgIGV2ZW50LmNvbnRlbnRLZXkgPT0gIndlYlJlbGF5QWN0aW9uU2V0dGluZyIgJiYKICAgIGV2ZW50Lml0ZW1LZXkgPT0gIndlYlJlbGF5QWN0aW9uU2V0dGluZyIKICApIHsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZXZlbnQubmV3VmFsLmxlbmd0aDsgaSsrKSB7CiAgICAgIHZtLmNoYW5nZWRDZmdEYXRhWyJDb25maWcuRG9vclNldHRpbmcuV0VCUkVMQVkuV2ViUmVsYXlJUCIgKyBpXSA9CiAgICAgICAgZXZlbnQubmV3VmFsW2ldLmlwLnZhbHVlOwogICAgICB2bS5jaGFuZ2VkQ2ZnRGF0YVsiQ29uZmlnLkRvb3JTZXR0aW5nLldFQlJFTEFZLldlYlJlbGF5U0lQIiArIGldID0KICAgICAgICBldmVudC5uZXdWYWxbaV0uc2lwLnZhbHVlOwogICAgICB2bS5jaGFuZ2VkQ2ZnRGF0YVsiQ29uZmlnLkRvb3JTZXR0aW5nLldFQlJFTEFZLldlYkFjdGlvbiIgKyBpXSA9CiAgICAgICAgZXZlbnQubmV3VmFsW2ldLmFjdGlvbi52YWx1ZTsKICAgIH0KICB9Cn0KCmZ1bmN0aW9uIGhhbmRsZXJQYWdlQ2hhbmdlZCh2bSkgewogIGlmICh2bS5jaGFuZ2VkQ2ZnRGF0YVsiQ29uZmlnLkRvb3JTZXR0aW5nLlJFTEFZLlJlbGF5T25XZWIiXSA9PSAwKSB7CiAgICBnZXRJdGVtQnlLZXkoCiAgICAgIHZtLmRhdGEsCiAgICAgICJvcGVuUmVsYXlWaWFIdHRwIiwKICAgICAgIkNvbmZpZy5Eb29yU2V0dGluZy5SRUxBWS5SZWxheU9uV2ViVXNlciIKICAgICkuZGlzYWJsZWQgPSB0cnVlOwogICAgZ2V0SXRlbUJ5S2V5KAogICAgICB2bS5kYXRhLAogICAgICAib3BlblJlbGF5VmlhSHR0cCIsCiAgICAgICJDb25maWcuRG9vclNldHRpbmcuUkVMQVkuUmVsYXlPbldlYlB3ZCIKICAgICkuZGlzYWJsZWQgPSB0cnVlOwogIH0gZWxzZSB7CiAgICBnZXRJdGVtQnlLZXkoCiAgICAgIHZtLmRhdGEsCiAgICAgICJvcGVuUmVsYXlWaWFIdHRwIiwKICAgICAgIkNvbmZpZy5Eb29yU2V0dGluZy5SRUxBWS5SZWxheU9uV2ViVXNlciIKICAgICkuZGlzYWJsZWQgPSBmYWxzZTsKICAgIGdldEl0ZW1CeUtleSgKICAgICAgdm0uZGF0YSwKICAgICAgIm9wZW5SZWxheVZpYUh0dHAiLAogICAgICAiQ29uZmlnLkRvb3JTZXR0aW5nLlJFTEFZLlJlbGF5T25XZWJQd2QiCiAgICApLmRpc2FibGVkID0gZmFsc2U7CiAgfQogIGdldEl0ZW1CeUtleSgKICAgIHZtLmRhdGEsCiAgICAicmVsYXlTZXR0aW5nIiwKICAgICJDb25maWcuRG9vclNldHRpbmcuUkVMQVkuRFRNRkNvZGUyIgogICkuaXNIaWRlID0gdm0uYXBpRGF0YS5kYXRhLnN1cHBvcnRUaHJlZUR0bWYgIT0gMTsKICBnZXRJdGVtQnlLZXkoCiAgICB2bS5kYXRhLAogICAgInJlbGF5U2V0dGluZyIsCiAgICAiQ29uZmlnLkRvb3JTZXR0aW5nLlJFTEFZLkRUTUZDb2RlMyIKICApLmlzSGlkZSA9IHZtLmFwaURhdGEuZGF0YS5zdXBwb3J0VGhyZWVEdG1mICE9IDE7Cn0KCmZ1bmN0aW9uIHN1Ym1pdERhdGEodm0pIHsKICB2bS5kYXRhLnN1Ym1pdExvYWRpbmcgPSB0cnVlOwoKICBsZXQgcmVxdWVzdERhdGEgPSB7CiAgICB0YXJnZXQ6ICJwaG9uZVJlbGF5IiwKICAgIGFjdGlvbjogInNldCIsCiAgICBjb25maWdEYXRhOiB2bS5zdWJtaXRDZmdEYXRhLAogIH07CiAgdm0uJGF4aW9zLnBvc3QoImFwaSIsIHJlcXVlc3REYXRhKS50aGVuKChyZXNwb25zZSkgPT4gewogICAgc2hvd1JlcXVlc3RTdWNjZXNzKHZtKTsKICAgIHZtLmRhdGEuc3VibWl0TG9hZGluZyA9IGZhbHNlOwogIH0pOwp9CgpmdW5jdGlvbiBnZXREYXRhKHZtKSB7CiAgdm0uJGF4aW9zLmdldCgiYXBpL3Bob25lUmVsYXkvaW5mbyIpLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICB2bS5nZXREYXRhU3VjY2VzcyA9IHRydWU7CiAgICB2bS5hcGlEYXRhID0gcmVzcG9uc2UuZGF0YTsKICAgIHZtLmNoYW5nZWRDZmdEYXRhID0gZGVlcENsb25lKHJlc3BvbnNlLmRhdGEuY29uZmlnRGF0YSk7CiAgICBjcmVhdGVQYWdlRGF0YSh2bSk7CiAgICBoYW5kbGVyUGFnZUNoYW5nZWQodm0pOwogIH0pOwp9CgpmdW5jdGlvbiBnZXRDb21taXREYXRhKHZtKSB7CiAgdm0uc3VibWl0Q2ZnRGF0YSA9IHt9OwogIGZvciAodmFyIGNoYW5nZWRLZXkgaW4gdm0uY2hhbmdlZENmZ0RhdGEpIHsKICAgIGlmICh2bS5hcGlEYXRhLmNvbmZpZ0RhdGFbY2hhbmdlZEtleV0gIT0gdm0uY2hhbmdlZENmZ0RhdGFbY2hhbmdlZEtleV0pIHsKICAgICAgdm0uc3VibWl0Q2ZnRGF0YVtjaGFuZ2VkS2V5XSA9IHZtLmNoYW5nZWRDZmdEYXRhW2NoYW5nZWRLZXldOwogICAgfQogIH0KfQoKZnVuY3Rpb24gY2hlY2tDb21taXREYXRhKHZtKSB7CiAgcmV0dXJuICgKICAgIGNoZWNrUmVtb3RlQ29udHJvbCh2bSkgJiYKICAgIGNoZWNrUmVtb3RlUmVsYXlIdHRwKHZtKSAmJgogICAgY2hlY2tXZWJSZWxheSh2bSkgJiYKICAgIGNoZWNrV2ViUmVsYXlBY3Rpb25TZXR0aW5nKHZtKQogICk7Cn0KCmZ1bmN0aW9uIGNoZWNrV2ViUmVsYXlBY3Rpb25TZXR0aW5nKHZtKSB7CiAgbGV0IHN1Y2Nlc3MgPSB0cnVlOwogIGZvciAobGV0IGkgPSAwOyBpIDwgdm0uYXBpRGF0YS5kYXRhLndlYlJlbGF5QWN0aW9uTWF4TnVtOyBpKyspIHsKICAgIGxldCB0YWJsZURhdGEgPSBnZXRJdGVtQnlLZXkoCiAgICAgIHZtLmRhdGEsCiAgICAgICJ3ZWJSZWxheUFjdGlvblNldHRpbmciLAogICAgICAid2ViUmVsYXlBY3Rpb25TZXR0aW5nIgogICAgKS50YWJsZURhdGE7CiAgICB0YWJsZURhdGFbaV0uaXAuaXNXYXJuID0gZmFsc2U7CiAgICB0YWJsZURhdGFbaV0uc2lwLmlzV2FybiA9IGZhbHNlOwogICAgdGFibGVEYXRhW2ldLmFjdGlvbi5pc1dhcm4gPSBmYWxzZTsKICAgIGlmICgKICAgICAgdm0uY2hhbmdlZENmZ0RhdGFbIkNvbmZpZy5Eb29yU2V0dGluZy5XRUJSRUxBWS5XZWJSZWxheUlQIiArIGldID09ICIiICYmCiAgICAgIHZtLmNoYW5nZWRDZmdEYXRhWyJDb25maWcuRG9vclNldHRpbmcuV0VCUkVMQVkuV2ViUmVsYXlTSVAiICsgaV0gPT0gIiIgJiYKICAgICAgdm0uY2hhbmdlZENmZ0RhdGFbIkNvbmZpZy5Eb29yU2V0dGluZy5XRUJSRUxBWS5XZWJBY3Rpb24iICsgaV0gIT0gIiIKICAgICkgewogICAgICB0YWJsZURhdGFbaV0uaXAuaXNXYXJuID0gdHJ1ZTsKICAgICAgdGFibGVEYXRhW2ldLnNpcC5pc1dhcm4gPSB0cnVlOwogICAgICBzdWNjZXNzID0gZmFsc2U7CiAgICB9CiAgICBpZiAoCiAgICAgICh2bS5jaGFuZ2VkQ2ZnRGF0YVsiQ29uZmlnLkRvb3JTZXR0aW5nLldFQlJFTEFZLldlYlJlbGF5SVAiICsgaV0gIT0gIiIgfHwKICAgICAgICB2bS5jaGFuZ2VkQ2ZnRGF0YVsiQ29uZmlnLkRvb3JTZXR0aW5nLldFQlJFTEFZLldlYlJlbGF5U0lQIiArIGldICE9CiAgICAgICAgICAiIikgJiYKICAgICAgdm0uY2hhbmdlZENmZ0RhdGFbIkNvbmZpZy5Eb29yU2V0dGluZy5XRUJSRUxBWS5XZWJBY3Rpb24iICsgaV0gPT0gIiIKICAgICkgewogICAgICB0YWJsZURhdGFbaV0uYWN0aW9uLmlzV2FybiA9IHRydWU7CiAgICAgIHN1Y2Nlc3MgPSBmYWxzZTsKICAgIH0KICB9CiAgcmV0dXJuIHN1Y2Nlc3M7Cn0KCmZ1bmN0aW9uIGNoZWNrV2ViUmVsYXkodm0pIHsKICBsZXQgc3VjY2VzcyA9IHRydWU7CiAgaWYgKAogICAgdm0uY2hhbmdlZENmZ0RhdGFbIkNvbmZpZy5Eb29yU2V0dGluZy5XRUJSRUxBWS5JcEFkZHJlc3MiXSAhPSAiIiAmJgogICAgIWNoZWNrSXBBZGRyKHZtLmNoYW5nZWRDZmdEYXRhWyJDb25maWcuRG9vclNldHRpbmcuV0VCUkVMQVkuSXBBZGRyZXNzIl0pCiAgKSB7CiAgICBnZXRJdGVtQnlLZXkoCiAgICAgIHZtLmRhdGEsCiAgICAgICJ3ZWJSZWxheSIsCiAgICAgICJDb25maWcuRG9vclNldHRpbmcuV0VCUkVMQVkuSXBBZGRyZXNzIgogICAgKS5pc1dhcm4gPSB0cnVlOwogICAgc3VjY2VzcyA9IGZhbHNlOwogIH0KICByZXR1cm4gc3VjY2VzczsKfQoKZnVuY3Rpb24gY2hlY2tSZW1vdGVSZWxheUh0dHAodm0pIHsKICBsZXQgc3VjY2VzcyA9IHRydWU7CiAgZm9yIChsZXQgaSA9IDA7IGkgPCB2bS5hcGlEYXRhLmRhdGEubWF4UmVtb3RlUmVsYXlOdW07IGkrKykgewogICAgaWYgKAogICAgICAodm0uY2hhbmdlZENmZ0RhdGFbIkNvbmZpZy5Eb29yU2V0dGluZy5SRU1PVEVSRUxBWS5SZW1vdGVVUkwiICsgaV0gIT0KICAgICAgICAiIiB8fAogICAgICAgIHZtLmNoYW5nZWRDZmdEYXRhWyJDb25maWcuRG9vclNldHRpbmcuUkVNT1RFUkVMQVkuUmVtb3RlVXNlciIgKyBpXSAhPQogICAgICAgICAgIiIpICYmCiAgICAgIHZtLmNoYW5nZWRDZmdEYXRhWyJDb25maWcuRG9vclNldHRpbmcuUkVNT1RFUkVMQVkuUmVtb3RlSVAiICsgaV0gPT0gIiIKICAgICkgewogICAgICBsZXQgdGFibGVEYXRhID0gZ2V0SXRlbUJ5S2V5KAogICAgICAgIHZtLmRhdGEsCiAgICAgICAgInJlbW90ZVJlbGF5QnlIdHRwIiwKICAgICAgICAicmVtb3RlUmVsYXlCeUh0dHAiCiAgICAgICkudGFibGVEYXRhOwogICAgICB0YWJsZURhdGFbaV0ucmVtb3RlSXAuaXNXYXJuID0gdHJ1ZTsKICAgICAgc3VjY2VzcyA9IGZhbHNlOwogICAgfQogIH0KICByZXR1cm4gc3VjY2VzczsKfQoKZnVuY3Rpb24gY2hlY2tSZW1vdGVDb250cm9sKHZtKSB7CiAgbGV0IHN1Y2Nlc3MgPSB0cnVlOwogIGlmICgKICAgICFub3RDb250YWluSW52YWxpZCgKICAgICAgdm0uY2hhbmdlZENmZ0RhdGFbIkNvbmZpZy5GZWF0dXJlcy5SRU1PVEVDT05UUk9MLkFjdGlvblVSSUFsbG93SVBMaXN0Il0KICAgICkKICApIHsKICAgIGdldEl0ZW1CeUtleSgKICAgICAgdm0uZGF0YSwKICAgICAgInJlbW90ZUNvbnRyb2wiLAogICAgICAiQ29uZmlnLkZlYXR1cmVzLlJFTU9URUNPTlRST0wuQWN0aW9uVVJJQWxsb3dJUExpc3QiCiAgICApLmlzV2FybiA9IHRydWU7CiAgICBzdWNjZXNzID0gZmFsc2U7CiAgfQogIHJldHVybiBzdWNjZXNzOwp9CgpmdW5jdGlvbiBjcmVhdGVQYWdlRGF0YSh2bSkgewogIHZtLmRhdGEgPSB7CiAgICBnZXREYXRhU3VjY2VzczogdHJ1ZSwKICAgIGJyZWFkQ3J1bWI6IHsKICAgICAgZmlyc3RUaXRsZTogdm0uJHQoIlBob25lIiksCiAgICAgIHNlY29uZFRpdGxlOiB2bS4kdCgiUmVsYXkiKSwKICAgIH0sCiAgICBvblN1Ym1pdDogZnVuY3Rpb24gKCkgewogICAgICBpZiAoIWNoZWNrQ29tbWl0RGF0YSh2bSkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgZ2V0Q29tbWl0RGF0YSh2bSk7CiAgICAgIHN1Ym1pdERhdGEodm0pOwogICAgfSwKICAgIG9uQ2FuY2VsOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZtLmRhdGEuY2FuY2VsTG9hZGluZyA9IHRydWU7CiAgICAgIGdldERhdGEodm0pOwogICAgfSwKICAgIHN1Ym1pdExvYWRpbmc6IGZhbHNlLAogICAgY2FuY2VsTG9hZGluZzogZmFsc2UsCiAgICBjb250ZW50czogW10sCiAgfTsKCiAgdm0uZGF0YS5jb250ZW50cy5wdXNoKGNyZWF0ZVJlbGF5U2V0dGluZ0NvbnRlbnQodm0pKTsKICB2bS5kYXRhLmNvbnRlbnRzLnB1c2goY3JlYXRlUmVtb3RlQ29udHJvbENvbnRlbnQodm0pKTsKICB2bS5kYXRhLmNvbnRlbnRzLnB1c2goY3JlYXRlT3BlblJlbGF5VmlhSHR0cENvbnRlbnQodm0pKTsKICB2bS5kYXRhLmNvbnRlbnRzLnB1c2goY3JlYXRlU29mdGtleUluVGFsa2luZ0NvbnRlbnQodm0pKTsKICB2bS5kYXRhLmNvbnRlbnRzLnB1c2goY3JlYXRlU29mdGtleUluSG9tZU9yTW9yZUNvbnRlbnQodm0pKTsKICB2bS5kYXRhLmNvbnRlbnRzLnB1c2goY3JlYXRlU29mdGtleUluTW9uaXRvckNvbnRlbnQodm0pKTsKICB2bS5kYXRhLmNvbnRlbnRzLnB1c2goY3JlYXRlU29mdGtleUluQ2FsbFByZXZpZXdDb250ZW50KHZtKSk7CiAgdm0uZGF0YS5jb250ZW50cy5wdXNoKGNyZWF0ZVJlbW90ZVJlbGF5QnlIdHRwQ29udGVudCh2bSkpOwogIHZtLmRhdGEuY29udGVudHMucHVzaChjcmVhdGVXZWJSZWxheUNvbnRlbnQodm0pKTsKICB2bS5kYXRhLmNvbnRlbnRzLnB1c2goY3JlYXRlV2ViUmVsYXlBY3Rpb25TZXR0aW5nQ29udGVudCh2bSkpOwp9CgpmdW5jdGlvbiBjcmVhdGVXZWJSZWxheUFjdGlvblNldHRpbmdDb250ZW50KHZtKSB7CiAgLy90YWJsZSBkYXRhCiAgbGV0IHRhYmxlRGF0YSA9IFtdOwogIGZvciAobGV0IGkgPSAwOyBpIDwgdm0uYXBpRGF0YS5kYXRhLndlYlJlbGF5QWN0aW9uTWF4TnVtOyBpKyspIHsKICAgIGxldCBpdGVtID0gewogICAgICBrZXk6IGksCiAgICAgIGFjdGlvbklkOiB2bS4kdCgiV2ViUmVsYXlDb2xJZCIpICsgIiAiICsgKGkgKyAxKSwKICAgICAgaXA6IHsKICAgICAgICB2YWx1ZToKICAgICAgICAgIHZtLmFwaURhdGEuY29uZmlnRGF0YVsiQ29uZmlnLkRvb3JTZXR0aW5nLldFQlJFTEFZLldlYlJlbGF5SVAiICsgaV0sCiAgICAgICAgaXNXYXJuOiBmYWxzZSwKICAgICAgICB3YXJuTGFiZWw6IHZtLiR0KCJWYWx1ZUVtcHR5V2FybmluZyIpLAogICAgICB9LAogICAgICBzaXA6IHsKICAgICAgICB2YWx1ZToKICAgICAgICAgIHZtLmFwaURhdGEuY29uZmlnRGF0YVsiQ29uZmlnLkRvb3JTZXR0aW5nLldFQlJFTEFZLldlYlJlbGF5U0lQIiArIGldLAogICAgICAgIGlzV2FybjogZmFsc2UsCiAgICAgICAgd2FybkxhYmVsOiB2bS4kdCgiVmFsdWVFbXB0eVdhcm5pbmciKSwKICAgICAgfSwKICAgICAgYWN0aW9uOiB7CiAgICAgICAgdmFsdWU6CiAgICAgICAgICB2bS5hcGlEYXRhLmNvbmZpZ0RhdGFbIkNvbmZpZy5Eb29yU2V0dGluZy5XRUJSRUxBWS5XZWJBY3Rpb24iICsgaV0sCiAgICAgICAgaXNXYXJuOiBmYWxzZSwKICAgICAgICB3YXJuTGFiZWw6IHZtLiR0KCJWYWx1ZUVtcHR5V2FybmluZyIpLAogICAgICB9LAogICAgfTsKICAgIHRhYmxlRGF0YS5wdXNoKGl0ZW0pOwogIH0KICAvL2NvbnRlbnQKICBsZXQgY29udGVudCA9IHsKICAgIGtleTogIndlYlJlbGF5QWN0aW9uU2V0dGluZyIsCiAgICB0aXRsZTogdm0uJHQoIldlYlJlbGF5QWN0aW9uU2V0dGluZyIpLAogICAgdGl0bGVEZXNjcmlwdGlvbjogdm0uJHQoIldlYlJlbGF5QWN0aW9uU2V0dGluZyIpLAogICAgaXRlbXM6IFsKICAgICAgewogICAgICAgIHR5cGU6ICJ0YWJsZSIsCiAgICAgICAga2V5OiAid2ViUmVsYXlBY3Rpb25TZXR0aW5nIiwKICAgICAgICB0YWJsZUNvbHVtbnM6IFsKICAgICAgICAgIHsKICAgICAgICAgICAgdHlwZTogImxhYmVsIiwKICAgICAgICAgICAgdGl0bGU6IHZtLiR0KCJXZWJSZWxheUNvbElkIiksCiAgICAgICAgICAgIGRhdGFJbmRleDogImFjdGlvbklkIiwKICAgICAgICAgICAgc2NvcGVkU2xvdHM6IHsgY3VzdG9tUmVuZGVyOiAiYWN0aW9uSWQiIH0sCiAgICAgICAgICAgIGFsaWduOiAiY2VudGVyIiwKICAgICAgICAgICAgc2VsZWN0SXRlbXM6IHZtLnN0YXR1c0l0ZW1zLAogICAgICAgICAgICB3aWR0aDogIjEwJSIsCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICB0eXBlOiAiaW5wdXQiLAogICAgICAgICAgICB0aXRsZTogdm0uJHQoIklQIiksCiAgICAgICAgICAgIGRhdGFJbmRleDogImlwIiwKICAgICAgICAgICAgc2NvcGVkU2xvdHM6IHsgY3VzdG9tUmVuZGVyOiAiaXAiIH0sCiAgICAgICAgICAgIGFsaWduOiAiY2VudGVyIiwKICAgICAgICAgICAgd2lkdGg6ICIzMCUiLAogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgdHlwZTogImlucHV0IiwKICAgICAgICAgICAgdGl0bGU6IHZtLiR0KCJTSVAiKSwKICAgICAgICAgICAgZGF0YUluZGV4OiAic2lwIiwKICAgICAgICAgICAgc2NvcGVkU2xvdHM6IHsgY3VzdG9tUmVuZGVyOiAic2lwIiB9LAogICAgICAgICAgICBhbGlnbjogImNlbnRlciIsCiAgICAgICAgICAgIHdpZHRoOiAiMzAlIiwKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIHR5cGU6ICJpbnB1dCIsCiAgICAgICAgICAgIHRpdGxlOiB2bS4kdCgiV2ViUmVsYXlDb2xBY3Rpb24iKSwKICAgICAgICAgICAgZGF0YUluZGV4OiAiYWN0aW9uIiwKICAgICAgICAgICAgc2NvcGVkU2xvdHM6IHsgY3VzdG9tUmVuZGVyOiAiYWN0aW9uIiB9LAogICAgICAgICAgICBhbGlnbjogImNlbnRlciIsCiAgICAgICAgICAgIHdpZHRoOiAiMzAlIiwKICAgICAgICAgICAgbWF4TGVuZ3RoOiAxMjcsCiAgICAgICAgICB9LAogICAgICAgIF0sCiAgICAgICAgdGFibGVEYXRhOiB0YWJsZURhdGEsCiAgICAgIH0sCiAgICBdLAogIH07CiAgcmV0dXJuIGNvbnRlbnQ7Cn0KCmZ1bmN0aW9uIGNyZWF0ZVdlYlJlbGF5Q29udGVudCh2bSkgewogIGxldCBjb250ZW50ID0gewogICAga2V5OiAid2ViUmVsYXkiLAogICAgdGl0bGU6IHZtLiR0KCJXZWJSZWxheSIpLAogICAgdGl0bGVEZXNjcmlwdGlvbjogdm0uJHQoIldlYlJlbGF5IiksCiAgICBpdGVtczogWwogICAgICB7CiAgICAgICAgdGl0bGU6IHZtLiR0KCJXZWJSZWxheUlQQWRkcmVzcyIpLAogICAgICAgIHR5cGU6ICJpbnB1dCIsCiAgICAgICAga2V5OiAiQ29uZmlnLkRvb3JTZXR0aW5nLldFQlJFTEFZLklwQWRkcmVzcyIsCiAgICAgICAgdmFsdWU6IHZtLmFwaURhdGEuY29uZmlnRGF0YVsiQ29uZmlnLkRvb3JTZXR0aW5nLldFQlJFTEFZLklwQWRkcmVzcyJdLAogICAgICAgIGlzV2FybjogZmFsc2UsCiAgICAgICAgd2FybkxhYmVsOiB2bS4kdCgiSXBGb3JtYXRFcnJvciIpLAogICAgICB9LAogICAgICB7CiAgICAgICAgdGl0bGU6IHZtLiR0KCJXZWJSZWxheVVzZXIiKSwKICAgICAgICB0eXBlOiAiaW5wdXQiLAogICAgICAgIGtleTogIkNvbmZpZy5Eb29yU2V0dGluZy5XRUJSRUxBWS5Vc2VyTmFtZSIsCiAgICAgICAgdmFsdWU6IHZtLmFwaURhdGEuY29uZmlnRGF0YVsiQ29uZmlnLkRvb3JTZXR0aW5nLldFQlJFTEFZLlVzZXJOYW1lIl0sCiAgICAgIH0sCiAgICAgIHsKICAgICAgICB0aXRsZTogdm0uJHQoIldlYlJlbGF5UHdkIiksCiAgICAgICAgaW5wdXRUeXBlOiAicGFzc3dvcmQiLAogICAgICAgIHR5cGU6ICJpbnB1dCIsCiAgICAgICAga2V5OiAiQ29uZmlnLkRvb3JTZXR0aW5nLldFQlJFTEFZLlBhc3N3ZCIsCiAgICAgICAgdmFsdWU6IHZtLmFwaURhdGEuY29uZmlnRGF0YVsiQ29uZmlnLkRvb3JTZXR0aW5nLldFQlJFTEFZLlBhc3N3ZCJdLAogICAgICB9LAogICAgXSwKICB9OwogIHJldHVybiBjb250ZW50Owp9CgpmdW5jdGlvbiBjcmVhdGVSZW1vdGVSZWxheUJ5SHR0cENvbnRlbnQodm0pIHsKICAvL2Rvb3JudW0gaXRlbXMKICBsZXQgZG9vck51bUl0ZW1zID0gW107CiAgZm9yIChsZXQgaSA9IDE7IGkgPD0gNDsgaSsrKSB7CiAgICBsZXQgaXRlbSA9IHsKICAgICAga2V5OiBpLAogICAgICBsYWJlbDogaSwKICAgIH07CiAgICBkb29yTnVtSXRlbXMucHVzaChpdGVtKTsKICB9CiAgLy90YWJsZWRhdGEKICBsZXQgdGFibGVEYXRhID0gW107CiAgZm9yIChsZXQgaSA9IDA7IGkgPCB2bS5hcGlEYXRhLmRhdGEubWF4UmVtb3RlUmVsYXlOdW07IGkrKykgewogICAgbGV0IGl0ZW0gPSB7CiAgICAgIGtleTogaSwKICAgICAgaW5kZXg6IGkgKyAxLAogICAgICByZW1vdGVJcDogewogICAgICAgIHZhbHVlOgogICAgICAgICAgdm0uYXBpRGF0YS5jb25maWdEYXRhWyJDb25maWcuRG9vclNldHRpbmcuUkVNT1RFUkVMQVkuUmVtb3RlSVAiICsgaV0sCiAgICAgICAgaXNXYXJuOiBmYWxzZSwKICAgICAgICB3YXJuTGFiZWw6IHZtLiR0KCJWYWx1ZUVtcHR5V2FybmluZyIpLAogICAgICB9LAogICAgICByZW1vdGVBZGRyZXNzOiB7CiAgICAgICAgdmFsdWU6CiAgICAgICAgICB2bS5hcGlEYXRhLmNvbmZpZ0RhdGFbIkNvbmZpZy5Eb29yU2V0dGluZy5SRU1PVEVSRUxBWS5SZW1vdGVVUkwiICsgaV0sCiAgICAgICAgaXNXYXJuOiBmYWxzZSwKICAgICAgfSwKICAgICAgdXNlcm5hbWU6IHsKICAgICAgICB2YWx1ZToKICAgICAgICAgIHZtLmFwaURhdGEuY29uZmlnRGF0YVsKICAgICAgICAgICAgIkNvbmZpZy5Eb29yU2V0dGluZy5SRU1PVEVSRUxBWS5SZW1vdGVVc2VyIiArIGkKICAgICAgICAgIF0sCiAgICAgICAgaXNXYXJuOiBmYWxzZSwKICAgICAgfSwKICAgICAgcGFzc3dvcmQ6IHsKICAgICAgICB2YWx1ZToKICAgICAgICAgIHZtLmFwaURhdGEuY29uZmlnRGF0YVsKICAgICAgICAgICAgIkNvbmZpZy5Eb29yU2V0dGluZy5SRU1PVEVSRUxBWS5SZW1vdGVQYXNzd2QiICsgaQogICAgICAgICAgXSwKICAgICAgICBpc1dhcm46IGZhbHNlLAogICAgICB9LAogICAgICBkb29yTnVtOiB7CiAgICAgICAgdmFsdWU6CiAgICAgICAgICB2bS5hcGlEYXRhLmNvbmZpZ0RhdGFbCiAgICAgICAgICAgICJDb25maWcuRG9vclNldHRpbmcuUkVNT1RFUkVMQVkuUmVtb3RlRG9vck51bSIgKyBpCiAgICAgICAgICBdID09ICIiCiAgICAgICAgICAgID8gWyIxIiwgIjIiLCAiMyIsICI0Il0KICAgICAgICAgICAgOiB2bS5hcGlEYXRhLmNvbmZpZ0RhdGFbCiAgICAgICAgICAgICAgICAiQ29uZmlnLkRvb3JTZXR0aW5nLlJFTU9URVJFTEFZLlJlbW90ZURvb3JOdW0iICsgaQogICAgICAgICAgICAgIF0uc3BsaXQoIiwiKSwKICAgICAgICBpc1dhcm46IGZhbHNlLAogICAgICB9LAogICAgfTsKICAgIHRhYmxlRGF0YS5wdXNoKGl0ZW0pOwogIH0KICAvL2NvbnRlbnQKICBsZXQgY29udGVudCA9IHsKICAgIGtleTogInJlbW90ZVJlbGF5QnlIdHRwIiwKICAgIHRpdGxlOiB2bS4kdCgiUmVtb3RlUmVsYXlTZXR0aW5nIiksCiAgICB0aXRsZURlc2NyaXB0aW9uOiB2bS4kdCgiUmVtb3RlUmVsYXlTZXR0aW5nIiksCiAgICBpdGVtczogWwogICAgICB7CiAgICAgICAgdHlwZTogInRhYmxlIiwKICAgICAgICBrZXk6ICJyZW1vdGVSZWxheUJ5SHR0cCIsCiAgICAgICAgLy8gc2hvd1Jvd1NlbGVjdGlvbjogdHJ1ZSwKICAgICAgICAvLyBzZWxlY3RlZFJvd0tleXM6IFtdLAogICAgICAgIHRhYmxlQ29sdW1uczogWwogICAgICAgICAgewogICAgICAgICAgICB0eXBlOiAibGFiZWwiLAogICAgICAgICAgICB0aXRsZTogdm0uJHQoIkluZGV4IiksCiAgICAgICAgICAgIGRhdGFJbmRleDogImluZGV4IiwKICAgICAgICAgICAgc2NvcGVkU2xvdHM6IHsgY3VzdG9tUmVuZGVyOiAiaW5kZXgiIH0sCiAgICAgICAgICAgIGFsaWduOiAiY2VudGVyIiwKICAgICAgICAgICAgd2lkdGg6ICI3JSIsCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICB0eXBlOiAiaW5wdXQiLAogICAgICAgICAgICB0aXRsZTogdm0uJHQoIlJlbW90ZVJlbGF5SVAiKSwKICAgICAgICAgICAgZGF0YUluZGV4OiAicmVtb3RlSXAiLAogICAgICAgICAgICBzY29wZWRTbG90czogeyBjdXN0b21SZW5kZXI6ICJyZW1vdGVJcCIgfSwKICAgICAgICAgICAgYWxpZ246ICJjZW50ZXIiLAogICAgICAgICAgICB3aWR0aDogIjE4JSIsCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICB0eXBlOiAiaW5wdXQiLAogICAgICAgICAgICB0aXRsZTogdm0uJHQoIlJlbW90ZVJlbGF5VVJMIiksCiAgICAgICAgICAgIGRhdGFJbmRleDogInJlbW90ZUFkZHJlc3MiLAogICAgICAgICAgICBzY29wZWRTbG90czogeyBjdXN0b21SZW5kZXI6ICJyZW1vdGVBZGRyZXNzIiB9LAogICAgICAgICAgICBhbGlnbjogImNlbnRlciIsCiAgICAgICAgICAgIHdpZHRoOiAiMTglIiwKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIHR5cGU6ICJpbnB1dCIsCiAgICAgICAgICAgIHRpdGxlOiB2bS4kdCgiVXNlck5hbWUiKSwKICAgICAgICAgICAgZGF0YUluZGV4OiAidXNlcm5hbWUiLAogICAgICAgICAgICBzY29wZWRTbG90czogeyBjdXN0b21SZW5kZXI6ICJ1c2VybmFtZSIgfSwKICAgICAgICAgICAgYWxpZ246ICJjZW50ZXIiLAogICAgICAgICAgICB3aWR0aDogIjE4JSIsCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICB0eXBlOiAiaW5wdXQiLAogICAgICAgICAgICB0aXRsZTogdm0uJHQoIlBhc3N3b3JkIiksCiAgICAgICAgICAgIGRhdGFJbmRleDogInBhc3N3b3JkIiwKICAgICAgICAgICAgc2NvcGVkU2xvdHM6IHsgY3VzdG9tUmVuZGVyOiAicGFzc3dvcmQiIH0sCiAgICAgICAgICAgIGFsaWduOiAiY2VudGVyIiwKICAgICAgICAgICAgd2lkdGg6ICIxOCUiLAogICAgICAgICAgICBpbnB1dFR5cGU6ICJwYXNzd29yZCIsCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICB0eXBlOiAic2VsZWN0IiwKICAgICAgICAgICAgdGl0bGU6IHZtLiR0KCJEb29yTnVtIiksCiAgICAgICAgICAgIGRhdGFJbmRleDogImRvb3JOdW0iLAogICAgICAgICAgICBzY29wZWRTbG90czogeyBjdXN0b21SZW5kZXI6ICJkb29yTnVtIiB9LAogICAgICAgICAgICBhbGlnbjogImNlbnRlciIsCiAgICAgICAgICAgIHdpZHRoOiAiMTglIiwKICAgICAgICAgICAgbW9kZTogIm11bHRpcGxlIiwKICAgICAgICAgICAgc2VsZWN0SXRlbXM6IGRvb3JOdW1JdGVtcywKICAgICAgICAgIH0sCiAgICAgICAgXSwKICAgICAgICB0YWJsZURhdGE6IHRhYmxlRGF0YSwKICAgICAgfSwKICAgIF0sCiAgfTsKICByZXR1cm4gY29udGVudDsKfQoKZnVuY3Rpb24gY3JlYXRlU29mdGtleUluQ2FsbFByZXZpZXdDb250ZW50KHZtKSB7CiAgLy90YWJsZSBkYXRhCiAgbGV0IHRhYmxlRGF0YSA9IFsKICAgIHsKICAgICAga2V5OiAwLAogICAgICBzdGF0dXM6IHsKICAgICAgICB2YWx1ZTogdm0uYXBpRGF0YS5jb25maWdEYXRhWyJDb25maWcuRG9vclNldHRpbmcuUkVMQVkuSW5jb21pbmdTdGF0dXMiXSwKICAgICAgICBpc1dhcm46IGZhbHNlLAogICAgICB9LAogICAgICBkaXNwbGF5TmFtZTogewogICAgICAgIHZhbHVlOgogICAgICAgICAgdm0uYXBpRGF0YS5jb25maWdEYXRhWyJDb25maWcuRG9vclNldHRpbmcuUkVMQVkuSW5jb21pbmdEaXNwbGF5TmFtZSJdLAogICAgICAgIGlzV2FybjogZmFsc2UsCiAgICAgIH0sCiAgICAgIHR5cGU6IHsKICAgICAgICB2YWx1ZToKICAgICAgICAgIHZtLmFwaURhdGEuY29uZmlnRGF0YVsiQ29uZmlnLkRvb3JTZXR0aW5nLlJFTEFZLkluY29taW5nUmVsYXlUeXBlIl0sCiAgICAgICAgaXNXYXJuOiBmYWxzZSwKICAgICAgfSwKICAgIH0sCiAgXTsKICAvL3R5cGUgaXRlbXMKICBsZXQgdHlwZUl0ZW1zID0gW107CiAgdHlwZUl0ZW1zLnB1c2goeyBrZXk6IDMsIGxhYmVsOiB2bS4kdCgiUmVtb3RlUmVsYXlIVFRQIikgfSk7CiAgdHlwZUl0ZW1zLnB1c2goeyBrZXk6IDQsIGxhYmVsOiB2bS4kdCgiV2ViUmVsYXlBY3Rpb24iKSB9KTsKICBpZiAodm0uYXBpRGF0YS5kYXRhLmNvbm5lY3RNb2RlID09IDIpIHsKICAgIHR5cGVJdGVtcy5wdXNoKHsga2V5OiAxNiwgbGFiZWw6IHZtLiR0KCJDb25maWdPbkNsb3VkIikgfSk7CiAgfQogIC8vY29udGVudAogIGxldCBjb250ZW50ID0gewogICAga2V5OiAic29mdGtleUluQ2FsbFByZXZpZXciLAogICAgdGl0bGU6IHZtLiR0KCJDYWxsUHJldmlld1BhZ2VUaXRsZSIpLAogICAgdGl0bGVEZXNjcmlwdGlvbjogdm0uJHQoIkNhbGxQcmV2aWV3UGFnZVRpdGxlIiksCiAgICBpdGVtczogWwogICAgICB7CiAgICAgICAgdHlwZTogInRhYmxlIiwKICAgICAgICBrZXk6ICJzb2Z0a2V5SW5DYWxsUHJldmlldyIsCiAgICAgICAgdGFibGVDb2x1bW5zOiBbCiAgICAgICAgICB7CiAgICAgICAgICAgIHR5cGU6ICJzZWxlY3QiLAogICAgICAgICAgICB0aXRsZTogdm0uJHQoIlN0YXR1cyIpLAogICAgICAgICAgICBkYXRhSW5kZXg6ICJzdGF0dXMiLAogICAgICAgICAgICBzY29wZWRTbG90czogeyBjdXN0b21SZW5kZXI6ICJzdGF0dXMiIH0sCiAgICAgICAgICAgIGFsaWduOiAiY2VudGVyIiwKICAgICAgICAgICAgc2VsZWN0SXRlbXM6IHZtLnN0YXR1c0l0ZW1zLAogICAgICAgICAgICB3aWR0aDogIjMwJSIsCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICB0eXBlOiAiaW5wdXQiLAogICAgICAgICAgICB0aXRsZTogdm0uJHQoIkRpc3BsYXlOYW1lIiksCiAgICAgICAgICAgIGRhdGFJbmRleDogImRpc3BsYXlOYW1lIiwKICAgICAgICAgICAgc2NvcGVkU2xvdHM6IHsgY3VzdG9tUmVuZGVyOiAiZGlzcGxheU5hbWUiIH0sCiAgICAgICAgICAgIGFsaWduOiAiY2VudGVyIiwKICAgICAgICAgICAgd2lkdGg6ICIzMCUiLAogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgdHlwZTogInNlbGVjdCIsCiAgICAgICAgICAgIHRpdGxlOiB2bS4kdCgiVHlwZSIpLAogICAgICAgICAgICBkYXRhSW5kZXg6ICJ0eXBlIiwKICAgICAgICAgICAgc2NvcGVkU2xvdHM6IHsgY3VzdG9tUmVuZGVyOiAidHlwZSIgfSwKICAgICAgICAgICAgYWxpZ246ICJjZW50ZXIiLAogICAgICAgICAgICBzZWxlY3RJdGVtczogdHlwZUl0ZW1zLAogICAgICAgICAgICB3aWR0aDogIjQwJSIsCiAgICAgICAgICB9LAogICAgICAgIF0sCiAgICAgICAgdGFibGVEYXRhOiB0YWJsZURhdGEsCiAgICAgIH0sCiAgICBdLAogIH07CiAgcmV0dXJuIGNvbnRlbnQ7Cn0KCmZ1bmN0aW9uIGNyZWF0ZVNvZnRrZXlJbk1vbml0b3JDb250ZW50KHZtKSB7CiAgLy90YWJsZSBkYXRhCiAgbGV0IHRhYmxlRGF0YSA9IFsKICAgIHsKICAgICAga2V5OiAwLAogICAgICBzdGF0dXM6IHsKICAgICAgICB2YWx1ZTogdm0uYXBpRGF0YS5jb25maWdEYXRhWyJDb25maWcuRG9vclNldHRpbmcuUkVMQVkuTW9uaXRvclN0YXR1cyJdLAogICAgICAgIGlzV2FybjogZmFsc2UsCiAgICAgIH0sCiAgICAgIGRpc3BsYXlOYW1lOiB7CiAgICAgICAgdmFsdWU6CiAgICAgICAgICB2bS5hcGlEYXRhLmNvbmZpZ0RhdGFbIkNvbmZpZy5Eb29yU2V0dGluZy5SRUxBWS5Nb25pdG9yRGlzcGxheU5hbWUiXSwKICAgICAgICBpc1dhcm46IGZhbHNlLAogICAgICB9LAogICAgICB0eXBlOiB7CiAgICAgICAgdmFsdWU6CiAgICAgICAgICB2bS5hcGlEYXRhLmNvbmZpZ0RhdGFbIkNvbmZpZy5Eb29yU2V0dGluZy5SRUxBWS5Nb25pdG9yUmVsYXlUeXBlIl0sCiAgICAgICAgaXNXYXJuOiBmYWxzZSwKICAgICAgfSwKICAgIH0sCiAgXTsKICAvL3R5cGUgaXRlbXMKICBsZXQgdHlwZUl0ZW1zID0gW107CiAgdHlwZUl0ZW1zLnB1c2goeyBrZXk6IDMsIGxhYmVsOiB2bS4kdCgiUmVtb3RlUmVsYXlIVFRQIikgfSk7CiAgdHlwZUl0ZW1zLnB1c2goeyBrZXk6IDQsIGxhYmVsOiB2bS4kdCgiV2ViUmVsYXlBY3Rpb24iKSB9KTsKICBpZiAodm0uYXBpRGF0YS5kYXRhLmNvbm5lY3RNb2RlID09IDIpIHsKICAgIHR5cGVJdGVtcy5wdXNoKHsga2V5OiAxNiwgbGFiZWw6IHZtLiR0KCJDb25maWdPbkNsb3VkIikgfSk7CiAgfQogIC8vY29udGVudAogIGxldCBjb250ZW50ID0gewogICAga2V5OiAic29mdGtleUluTW9uaXRvciIsCiAgICB0aXRsZTogdm0uJHQoIk1vbml0b3JQYWdlVGl0bGUiKSwKICAgIHRpdGxlRGVzY3JpcHRpb246IHZtLiR0KCJNb25pdG9yUGFnZVRpdGxlIiksCiAgICBpdGVtczogWwogICAgICB7CiAgICAgICAgdHlwZTogInRhYmxlIiwKICAgICAgICBrZXk6ICJzb2Z0a2V5SW5Nb25pdG9yIiwKICAgICAgICB0YWJsZUNvbHVtbnM6IFsKICAgICAgICAgIHsKICAgICAgICAgICAgdHlwZTogInNlbGVjdCIsCiAgICAgICAgICAgIHRpdGxlOiB2bS4kdCgiU3RhdHVzIiksCiAgICAgICAgICAgIGRhdGFJbmRleDogInN0YXR1cyIsCiAgICAgICAgICAgIHNjb3BlZFNsb3RzOiB7IGN1c3RvbVJlbmRlcjogInN0YXR1cyIgfSwKICAgICAgICAgICAgYWxpZ246ICJjZW50ZXIiLAogICAgICAgICAgICBzZWxlY3RJdGVtczogdm0uc3RhdHVzSXRlbXMsCiAgICAgICAgICAgIHdpZHRoOiAiMzAlIiwKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIHR5cGU6ICJpbnB1dCIsCiAgICAgICAgICAgIHRpdGxlOiB2bS4kdCgiRGlzcGxheU5hbWUiKSwKICAgICAgICAgICAgZGF0YUluZGV4OiAiZGlzcGxheU5hbWUiLAogICAgICAgICAgICBzY29wZWRTbG90czogeyBjdXN0b21SZW5kZXI6ICJkaXNwbGF5TmFtZSIgfSwKICAgICAgICAgICAgYWxpZ246ICJjZW50ZXIiLAogICAgICAgICAgICB3aWR0aDogIjMwJSIsCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICB0eXBlOiAic2VsZWN0IiwKICAgICAgICAgICAgdGl0bGU6IHZtLiR0KCJUeXBlIiksCiAgICAgICAgICAgIGRhdGFJbmRleDogInR5cGUiLAogICAgICAgICAgICBzY29wZWRTbG90czogeyBjdXN0b21SZW5kZXI6ICJ0eXBlIiB9LAogICAgICAgICAgICBhbGlnbjogImNlbnRlciIsCiAgICAgICAgICAgIHNlbGVjdEl0ZW1zOiB0eXBlSXRlbXMsCiAgICAgICAgICAgIHdpZHRoOiAiNDAlIiwKICAgICAgICAgIH0sCiAgICAgICAgXSwKICAgICAgICB0YWJsZURhdGE6IHRhYmxlRGF0YSwKICAgICAgfSwKICAgIF0sCiAgfTsKICByZXR1cm4gY29udGVudDsKfQoKZnVuY3Rpb24gY3JlYXRlU29mdGtleUluSG9tZU9yTW9yZUNvbnRlbnQodm0pIHsKICAvL3RhYmxlIGRhdGEKICBsZXQgdGFibGVEYXRhID0gWwogICAgewogICAgICBrZXk6IDAsCiAgICAgIHN0YXR1czogewogICAgICAgIHZhbHVlOiB2bS5hcGlEYXRhLmNvbmZpZ0RhdGFbIkNvbmZpZy5Eb29yU2V0dGluZy5SRUxBWS5JZGxlU3RhdHVzIl0sCiAgICAgICAgaXNXYXJuOiBmYWxzZSwKICAgICAgICBkaXNhYmxlZDogdHJ1ZSwKICAgICAgfSwKICAgICAgZGlzcGxheU5hbWU6IHsKICAgICAgICB2YWx1ZToKICAgICAgICAgIHZtLmFwaURhdGEuY29uZmlnRGF0YVsiQ29uZmlnLkRvb3JTZXR0aW5nLlJFTEFZLklkbGVEaXNwbGF5TmFtZSJdLAogICAgICAgIGlzV2FybjogZmFsc2UsCiAgICAgIH0sCiAgICAgIHR5cGU6IHsKICAgICAgICB2YWx1ZTogdm0uYXBpRGF0YS5jb25maWdEYXRhWyJDb25maWcuRG9vclNldHRpbmcuUkVMQVkuSWRsZVJlbGF5VHlwZSJdLAogICAgICAgIGlzV2FybjogZmFsc2UsCiAgICAgIH0sCiAgICB9LAogIF07CiAgLy90eXBlIGl0ZW1zCiAgbGV0IHR5cGVJdGVtcyA9IFtdOwogIGZvciAobGV0IGkgPSAwOyBpIDwgdm0uYXBpRGF0YS5kYXRhLm1heFJlbW90ZVJlbGF5TnVtOyBpKyspIHsKICAgIGxldCBpdGVtID0gewogICAgICBrZXk6IGkgKyAxLAogICAgICBsYWJlbDogdm0uJHQoIlJlbW90ZVJlbGF5SFRUUCIpICsgKGkgKyAxKSwKICAgIH07CiAgICB0eXBlSXRlbXMucHVzaChpdGVtKTsKICB9CiAgLy9jb250ZW50CiAgbGV0IGNvbnRlbnQgPSB7CiAgICBrZXk6ICJzb2Z0a2V5SW5Ib21lT3JNb3JlIiwKICAgIHRpdGxlOiB2bS4kdCgiSG9tZU9yTW9yZVBhZ2VUaXRsZSIpLAogICAgdGl0bGVEZXNjcmlwdGlvbjogdm0uJHQoIkhvbWVPck1vcmVQYWdlVGl0bGUiKSwKICAgIGl0ZW1zOiBbCiAgICAgIHsKICAgICAgICB0eXBlOiAidGFibGUiLAogICAgICAgIGtleTogInNvZnRrZXlJbkhvbWVPck1vcmUiLAogICAgICAgIHRhYmxlQ29sdW1uczogWwogICAgICAgICAgewogICAgICAgICAgICB0eXBlOiAic2VsZWN0IiwKICAgICAgICAgICAgdGl0bGU6IHZtLiR0KCJTdGF0dXMiKSwKICAgICAgICAgICAgZGF0YUluZGV4OiAic3RhdHVzIiwKICAgICAgICAgICAgc2NvcGVkU2xvdHM6IHsgY3VzdG9tUmVuZGVyOiAic3RhdHVzIiB9LAogICAgICAgICAgICBhbGlnbjogImNlbnRlciIsCiAgICAgICAgICAgIHNlbGVjdEl0ZW1zOiB2bS5zdGF0dXNJdGVtcywKICAgICAgICAgICAgd2lkdGg6ICIzMCUiLAogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgdHlwZTogImlucHV0IiwKICAgICAgICAgICAgdGl0bGU6IHZtLiR0KCJEaXNwbGF5TmFtZSIpLAogICAgICAgICAgICBkYXRhSW5kZXg6ICJkaXNwbGF5TmFtZSIsCiAgICAgICAgICAgIHNjb3BlZFNsb3RzOiB7IGN1c3RvbVJlbmRlcjogImRpc3BsYXlOYW1lIiB9LAogICAgICAgICAgICBhbGlnbjogImNlbnRlciIsCiAgICAgICAgICAgIHdpZHRoOiAiMzAlIiwKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIHR5cGU6ICJzZWxlY3QiLAogICAgICAgICAgICB0aXRsZTogdm0uJHQoIlR5cGUiKSwKICAgICAgICAgICAgZGF0YUluZGV4OiAidHlwZSIsCiAgICAgICAgICAgIHNjb3BlZFNsb3RzOiB7IGN1c3RvbVJlbmRlcjogInR5cGUiIH0sCiAgICAgICAgICAgIGFsaWduOiAiY2VudGVyIiwKICAgICAgICAgICAgc2VsZWN0SXRlbXM6IHR5cGVJdGVtcywKICAgICAgICAgICAgd2lkdGg6ICI0MCUiLAogICAgICAgICAgfSwKICAgICAgICBdLAogICAgICAgIHRhYmxlRGF0YTogdGFibGVEYXRhLAogICAgICB9LAogICAgXSwKICB9OwogIHJldHVybiBjb250ZW50Owp9CgpmdW5jdGlvbiBjcmVhdGVTb2Z0a2V5SW5UYWxraW5nQ29udGVudCh2bSkgewogIC8vdHlwZSBpdGVtcwogIGxldCB0eXBlSXRlbXMgPSBbXTsKICB0eXBlSXRlbXMucHVzaCh7IGtleTogMywgbGFiZWw6IHZtLiR0KCJSZW1vdGVSZWxheUhUVFAiKSB9KTsKICBpZiAodm0uYXBpRGF0YS5kYXRhLm1heFJlbGF5U29mdGtleU51bSA9PSAzKSB7CiAgICBpZiAodm0uYXBpRGF0YS5kYXRhLnN1cHBvcnRUaHJlZUR0bWYgPT0gMSkgewogICAgICB0eXBlSXRlbXMucHVzaCh7IGtleTogMiwgbGFiZWw6IHZtLiR0KCJSZW1vdGVSZWxheURUTUYiKSArICIxIiB9KTsKICAgICAgdHlwZUl0ZW1zLnB1c2goeyBrZXk6IDE0LCBsYWJlbDogdm0uJHQoIlJlbW90ZVJlbGF5RFRNRiIpICsgIjIiIH0pOwogICAgICB0eXBlSXRlbXMucHVzaCh7IGtleTogMTUsIGxhYmVsOiB2bS4kdCgiUmVtb3RlUmVsYXlEVE1GIikgKyAiMyIgfSk7CiAgICB9IGVsc2UgewogICAgICB0eXBlSXRlbXMucHVzaCh7IGtleTogMiwgbGFiZWw6IHZtLiR0KCJSZW1vdGVSZWxheURUTUYiKSB9KTsKICAgIH0KICAgIGlmICh2bS5hcGlEYXRhLmRhdGEuc3VwcG9ydFJlbGF5QiA9PSAxKSB7CiAgICAgIHR5cGVJdGVtcy5wdXNoKHsga2V5OiAwLCBsYWJlbDogdm0uJHQoIkxvY2FsUmVsYXkiKSArICIxIiB9KTsKICAgICAgdHlwZUl0ZW1zLnB1c2goeyBrZXk6IDEsIGxhYmVsOiB2bS4kdCgiTG9jYWxSZWxheSIpICsgIjIiIH0pOwogICAgfSBlbHNlIHsKICAgICAgdHlwZUl0ZW1zLnB1c2goeyBrZXk6IDAsIGxhYmVsOiB2bS4kdCgiTG9jYWxSZWxheSIpIH0pOwogICAgfQogIH0gZWxzZSB7CiAgICB0eXBlSXRlbXMucHVzaCh7IGtleTogMiwgbGFiZWw6IHZtLiR0KCJSZW1vdGVSZWxheURUTUYiKSB9KTsKICAgIHR5cGVJdGVtcy5wdXNoKHsga2V5OiAwLCBsYWJlbDogdm0uJHQoIkxvY2FsUmVsYXkiKSB9KTsKICB9CiAgdHlwZUl0ZW1zLnB1c2goeyBrZXk6IDQsIGxhYmVsOiB2bS4kdCgiV2ViUmVsYXlBY3Rpb25WYWx1ZSIpIH0pOwogIC8vdGFibGUgZGF0YQogIGxldCB0YWJsZURhdGEgPSBbXTsKICBmb3IgKGxldCBpID0gMDsgaSA8IHZtLmFwaURhdGEuZGF0YS5tYXhSZWxheVNvZnRrZXlOdW07IGkrKykgewogICAgbGV0IGl0ZW0gPSB7CiAgICAgIGtleTogaSwKICAgICAga2V5TGFiZWw6IHZtLiR0KCJLZXkiKSArIChpICsgMSksCiAgICAgIHN0YXR1czogewogICAgICAgIHZhbHVlOgogICAgICAgICAgdm0uYXBpRGF0YS5jb25maWdEYXRhWwogICAgICAgICAgICAiQ29uZmlnLkRvb3JTZXR0aW5nLlJFTEFZLlRhbGtpbmdTdGF0dXMiICsgKGkgKyAxKQogICAgICAgICAgXSwKICAgICAgICBpc1dhcm46IGZhbHNlLAogICAgICB9LAogICAgICBkaXNwbGF5TmFtZTogewogICAgICAgIHZhbHVlOgogICAgICAgICAgdm0uYXBpRGF0YS5jb25maWdEYXRhWwogICAgICAgICAgICAiQ29uZmlnLkRvb3JTZXR0aW5nLlJFTEFZLlRhbGtpbmdDb2xEaXNwbGF5TmFtZSIgKyAoaSArIDEpCiAgICAgICAgICBdLAogICAgICAgIGlzV2FybjogZmFsc2UsCiAgICAgIH0sCiAgICAgIHR5cGU6IHsKICAgICAgICB2YWx1ZToKICAgICAgICAgIHZtLmFwaURhdGEuY29uZmlnRGF0YVsKICAgICAgICAgICAgIkNvbmZpZy5Eb29yU2V0dGluZy5SRUxBWS5UYWxraW5nUmVsYXlUeXBlIiArIChpICsgMSkKICAgICAgICAgIF0sCiAgICAgICAgaXNXYXJuOiBmYWxzZSwKICAgICAgfSwKICAgIH07CiAgICB0YWJsZURhdGEucHVzaChpdGVtKTsKICB9CiAgLy9jb250ZW50CiAgbGV0IGNvbnRlbnQgPSB7CiAgICBrZXk6ICJzb2Z0a2V5SW5UYWxraW5nIiwKICAgIHRpdGxlOiB2bS4kdCgiU29mdEtleUluVGFsa2luZyIpLAogICAgdGl0bGVEZXNjcmlwdGlvbjogdm0uJHQoIlNvZnRLZXlJblRhbGtpbmciKSwKICAgIGl0ZW1zOiBbCiAgICAgIHsKICAgICAgICB0eXBlOiAidGFibGUiLAogICAgICAgIGtleTogInNvZnRrZXlJblRhbGtpbmciLAogICAgICAgIHRhYmxlQ29sdW1uczogWwogICAgICAgICAgewogICAgICAgICAgICB0eXBlOiAibGFiZWwiLAogICAgICAgICAgICB0aXRsZTogdm0uJHQoIktleSIpLAogICAgICAgICAgICBkYXRhSW5kZXg6ICJrZXlMYWJlbCIsCiAgICAgICAgICAgIHNjb3BlZFNsb3RzOiB7IGN1c3RvbVJlbmRlcjogImtleUxhYmVsIiB9LAogICAgICAgICAgICBhbGlnbjogImNlbnRlciIsCiAgICAgICAgICAgIHdpZHRoOiAiMTAlIiwKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIHR5cGU6ICJzZWxlY3QiLAogICAgICAgICAgICB0aXRsZTogdm0uJHQoIlN0YXR1cyIpLAogICAgICAgICAgICBkYXRhSW5kZXg6ICJzdGF0dXMiLAogICAgICAgICAgICBzY29wZWRTbG90czogeyBjdXN0b21SZW5kZXI6ICJzdGF0dXMiIH0sCiAgICAgICAgICAgIGFsaWduOiAiY2VudGVyIiwKICAgICAgICAgICAgc2VsZWN0SXRlbXM6IHZtLnN0YXR1c0l0ZW1zLAogICAgICAgICAgICB3aWR0aDogIjMwJSIsCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICB0eXBlOiAiaW5wdXQiLAogICAgICAgICAgICB0aXRsZTogdm0uJHQoIkRpc3BsYXlOYW1lIiksCiAgICAgICAgICAgIGRhdGFJbmRleDogImRpc3BsYXlOYW1lIiwKICAgICAgICAgICAgc2NvcGVkU2xvdHM6IHsgY3VzdG9tUmVuZGVyOiAiZGlzcGxheU5hbWUiIH0sCiAgICAgICAgICAgIGFsaWduOiAiY2VudGVyIiwKICAgICAgICAgICAgd2lkdGg6ICIzMCUiLAogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgdHlwZTogInNlbGVjdCIsCiAgICAgICAgICAgIHRpdGxlOiB2bS4kdCgiVHlwZSIpLAogICAgICAgICAgICBkYXRhSW5kZXg6ICJ0eXBlIiwKICAgICAgICAgICAgc2NvcGVkU2xvdHM6IHsgY3VzdG9tUmVuZGVyOiAidHlwZSIgfSwKICAgICAgICAgICAgYWxpZ246ICJjZW50ZXIiLAogICAgICAgICAgICBzZWxlY3RJdGVtczogdHlwZUl0ZW1zLAogICAgICAgICAgICB3aWR0aDogIjMwJSIsCiAgICAgICAgICB9LAogICAgICAgIF0sCiAgICAgICAgdGFibGVEYXRhOiB0YWJsZURhdGEsCiAgICAgIH0sCiAgICBdLAogIH07CiAgcmV0dXJuIGNvbnRlbnQ7Cn0KCmZ1bmN0aW9uIGNyZWF0ZU9wZW5SZWxheVZpYUh0dHBDb250ZW50KHZtKSB7CiAgbGV0IGNvbnRlbnQgPSB7CiAgICBrZXk6ICJvcGVuUmVsYXlWaWFIdHRwIiwKICAgIHRpdGxlOiB2bS4kdCgiT3BlblJlbGF5U2V0dGluZyIpLAogICAgdGl0bGVEZXNjcmlwdGlvbjogdm0uJHQoIk9wZW5SZWxheVNldHRpbmciKSwKICAgIGl0ZW1zOiBbCiAgICAgIHsKICAgICAgICB0aXRsZTogdm0uJHQoIlN3aXRjaCIpLAogICAgICAgIHR5cGU6ICJjaGVja2JveCIsCiAgICAgICAga2V5OiAiQ29uZmlnLkRvb3JTZXR0aW5nLlJFTEFZLlJlbGF5T25XZWIiLAogICAgICAgIHZhbHVlOiB2bS5hcGlEYXRhLmNvbmZpZ0RhdGFbIkNvbmZpZy5Eb29yU2V0dGluZy5SRUxBWS5SZWxheU9uV2ViIl0sCiAgICAgIH0sCiAgICAgIHsKICAgICAgICB0aXRsZTogdm0uJHQoIlJlbW90ZVJlbGF5VXNlciIpLAogICAgICAgIHR5cGU6ICJpbnB1dCIsCiAgICAgICAga2V5OiAiQ29uZmlnLkRvb3JTZXR0aW5nLlJFTEFZLlJlbGF5T25XZWJVc2VyIiwKICAgICAgICB2YWx1ZTogdm0uYXBpRGF0YS5jb25maWdEYXRhWyJDb25maWcuRG9vclNldHRpbmcuUkVMQVkuUmVsYXlPbldlYlVzZXIiXSwKICAgICAgICBkaXNhYmxlZDogZmFsc2UsCiAgICAgIH0sCiAgICAgIHsKICAgICAgICB0aXRsZTogdm0uJHQoIlJlbW90ZVJlbGF5UGFzc3dkIiksCiAgICAgICAgdHlwZTogImlucHV0IiwKICAgICAgICBrZXk6ICJDb25maWcuRG9vclNldHRpbmcuUkVMQVkuUmVsYXlPbldlYlB3ZCIsCiAgICAgICAgdmFsdWU6IHZtLmFwaURhdGEuY29uZmlnRGF0YVsiQ29uZmlnLkRvb3JTZXR0aW5nLlJFTEFZLlJlbGF5T25XZWJQd2QiXSwKICAgICAgICBkaXNhYmxlZDogZmFsc2UsCiAgICAgICAgaW5wdXRUeXBlOiAicGFzc3dvcmQiLAogICAgICB9LAogICAgXSwKICB9OwogIHJldHVybiBjb250ZW50Owp9CgpmdW5jdGlvbiBjcmVhdGVSZW1vdGVDb250cm9sQ29udGVudCh2bSkgewogIGxldCBjb250ZW50ID0gewogICAga2V5OiAicmVtb3RlQ29udHJvbCIsCiAgICB0aXRsZTogdm0uJHQoIlJlbW90ZUNvbnRyb2wiKSwKICAgIHRpdGxlRGVzY3JpcHRpb246IHZtLiR0KCJSZW1vdGVDb250cm9sIiksCiAgICBpdGVtczogWwogICAgICB7CiAgICAgICAgdGl0bGU6IHZtLiR0KCJBbGxvd2VkQWNjZXNzSVBMaXN0IiksCiAgICAgICAgdHlwZTogImlucHV0IiwKICAgICAgICBrZXk6ICJDb25maWcuRmVhdHVyZXMuUkVNT1RFQ09OVFJPTC5BY3Rpb25VUklBbGxvd0lQTGlzdCIsCiAgICAgICAgdmFsdWU6CiAgICAgICAgICB2bS5hcGlEYXRhLmNvbmZpZ0RhdGFbCiAgICAgICAgICAgICJDb25maWcuRmVhdHVyZXMuUkVNT1RFQ09OVFJPTC5BY3Rpb25VUklBbGxvd0lQTGlzdCIKICAgICAgICAgIF0sCiAgICAgICAgaXNXYXJuOiBmYWxzZSwKICAgICAgICB3YXJuTGFiZWw6IHZtLiR0KCJQbGVhc2VDaGVja0FsYXJtU3VibWl0RGF0YSIpLAogICAgICB9LAogICAgXSwKICB9OwogIHJldHVybiBjb250ZW50Owp9CgpmdW5jdGlvbiBjcmVhdGVSZWxheVNldHRpbmdDb250ZW50KHZtKSB7CiAgLy9kZWxheSBpdGVtcwogIGxldCBkZWxheUl0ZW1zID0gW107CiAgZm9yIChsZXQgaSA9IDA7IGkgPD0gNjA7IGkrKykgewogICAgbGV0IGl0ZW0gPSB7CiAgICAgIGtleTogaSwKICAgICAgbGFiZWw6IGksCiAgICB9OwogICAgZGVsYXlJdGVtcy5wdXNoKGl0ZW0pOwogIH0KICBkZWxheUl0ZW1zLnB1c2goeyBrZXk6IC0xLCBsYWJlbDogdm0uJHQoIk5ldmVyIikgfSk7CgogIC8vcmVsYXkgdHlwZQogIGxldCByZWxheVR5cGVJdGVtcyA9IFtdOwogIHJlbGF5VHlwZUl0ZW1zLnB1c2goeyBrZXk6IDAsIGxhYmVsOiB2bS4kdCgiT3BlbkRvb3IiKSB9KTsKICBpZiAodm0uYXBpRGF0YS5kYXRhLmNoaW1lQmVsbFR5cGUgPT0gMSkgewogICAgcmVsYXlUeXBlSXRlbXMucHVzaCh7IGtleTogMSwgbGFiZWw6IHZtLiR0KCJFeHRlbnNpb25TcGVha2VyIikgfSk7CiAgfSBlbHNlIGlmICh2bS5hcGlEYXRhLmRhdGEuY2hpbWVCZWxsVHlwZSA9PSAyKSB7CiAgICByZWxheVR5cGVJdGVtcy5wdXNoKHsga2V5OiAyLCBsYWJlbDogdm0uJHQoIkNoaW1lQmVsbCIpIH0pOwogIH0gZWxzZSB7CiAgICByZWxheVR5cGVJdGVtcy5wdXNoKHsga2V5OiAyLCBsYWJlbDogdm0uJHQoIkNoaW1lQmVsbCIpIH0pOwogICAgaWYgKHZtLmFwaURhdGEuZGF0YS5zdXBwb3J0SGlkZVNPU0FjdGlvbiAhPSAxKSB7CiAgICAgIHJlbGF5VHlwZUl0ZW1zLnB1c2goeyBrZXk6IDMsIGxhYmVsOiB2bS4kdCgiU09TQWN0aW9uIikgfSk7CiAgICB9CiAgfQoKICBsZXQgY29udGVudCA9IHsKICAgIGtleTogInJlbGF5U2V0dGluZyIsCiAgICB0aXRsZTogdm0uJHQoIlJlbGF5U2V0dGluZyIpLAogICAgdGl0bGVEZXNjcmlwdGlvbjogdm0uJHQoIlJlbGF5U2V0dGluZyIpLAogICAgaXRlbXM6IFsKICAgICAgewogICAgICAgIHRpdGxlOiB2bS4kdCgiTG9jYWxSZWxheSIpICsgIjEiLAogICAgICAgIHR5cGU6ICJsYWJlbCIsCiAgICAgICAga2V5OiAibG9jYWxSZWxheTEiLAogICAgICAgIHZhbHVlOiAiIiwKICAgICAgICB0aXRsZUJvbGQ6IHRydWUsCiAgICAgIH0sCiAgICAgIHsKICAgICAgICB0aXRsZTogdm0uJHQoIlJlbGF5RGVsYXlOYW1lMSIpLAogICAgICAgIHR5cGU6ICJzZWxlY3QiLAogICAgICAgIGtleTogIkNvbmZpZy5Eb29yU2V0dGluZy5SRUxBWS5EZWxheTEiLAogICAgICAgIHZhbHVlOiB2bS5hcGlEYXRhLmNvbmZpZ0RhdGFbIkNvbmZpZy5Eb29yU2V0dGluZy5SRUxBWS5EZWxheTEiXSwKICAgICAgICBzZWxlY3RJdGVtczogZGVsYXlJdGVtcywKICAgICAgfSwKICAgICAgewogICAgICAgIHRpdGxlOiB2bS4kdCgiTG9jYWxSZWxheVR5cGVOYW1lMSIpLAogICAgICAgIHR5cGU6ICJzZWxlY3QiLAogICAgICAgIGtleTogIkNvbmZpZy5Eb29yU2V0dGluZy5SRUxBWS5Mb2NhbFJlbGF5VHlwZTEiLAogICAgICAgIHZhbHVlOgogICAgICAgICAgdm0uYXBpRGF0YS5jb25maWdEYXRhWyJDb25maWcuRG9vclNldHRpbmcuUkVMQVkuTG9jYWxSZWxheVR5cGUxIl0sCiAgICAgICAgc2VsZWN0SXRlbXM6IHJlbGF5VHlwZUl0ZW1zLAogICAgICB9LAogICAgICB7CiAgICAgICAgdGl0bGU6IHZtLiR0KCJMb2NhbFJlbGF5IikgKyAiMiIsCiAgICAgICAgdHlwZTogImxhYmVsIiwKICAgICAgICBrZXk6ICJsb2NhbFJlbGF5MiIsCiAgICAgICAgdmFsdWU6ICIiLAogICAgICAgIHRpdGxlQm9sZDogdHJ1ZSwKICAgICAgfSwKICAgICAgewogICAgICAgIHRpdGxlOiB2bS4kdCgiUmVsYXlEZWxheU5hbWUyIiksCiAgICAgICAgdHlwZTogInNlbGVjdCIsCiAgICAgICAga2V5OiAiQ29uZmlnLkRvb3JTZXR0aW5nLlJFTEFZLkRlbGF5MiIsCiAgICAgICAgdmFsdWU6IHZtLmFwaURhdGEuY29uZmlnRGF0YVsiQ29uZmlnLkRvb3JTZXR0aW5nLlJFTEFZLkRlbGF5MiJdLAogICAgICAgIHNlbGVjdEl0ZW1zOiBkZWxheUl0ZW1zLAogICAgICB9LAogICAgICB7CiAgICAgICAgdGl0bGU6IHZtLiR0KCJMb2NhbFJlbGF5VHlwZU5hbWUyIiksCiAgICAgICAgdHlwZTogInNlbGVjdCIsCiAgICAgICAga2V5OiAiQ29uZmlnLkRvb3JTZXR0aW5nLlJFTEFZLkxvY2FsUmVsYXlUeXBlMiIsCiAgICAgICAgdmFsdWU6CiAgICAgICAgICB2bS5hcGlEYXRhLmNvbmZpZ0RhdGFbIkNvbmZpZy5Eb29yU2V0dGluZy5SRUxBWS5Mb2NhbFJlbGF5VHlwZTIiXSwKICAgICAgICBzZWxlY3RJdGVtczogcmVsYXlUeXBlSXRlbXMsCiAgICAgIH0sCiAgICAgIHsKICAgICAgICB0aXRsZTogdm0uJHQoIlJlbW90ZVJlbGF5IiksCiAgICAgICAgdHlwZTogImxhYmVsIiwKICAgICAgICBrZXk6ICJyZW1vdGVSZWxheSIsCiAgICAgICAgdmFsdWU6ICIiLAogICAgICAgIHRpdGxlQm9sZDogdHJ1ZSwKICAgICAgfSwKICAgICAgewogICAgICAgIHRpdGxlOiB2bS4kdCgiRFRNRiIpICsgIjEgIiArIHZtLiR0KCJDb2RlIiksCiAgICAgICAgdHlwZTogImlucHV0IiwKICAgICAgICBrZXk6ICJDb25maWcuRG9vclNldHRpbmcuUkVMQVkuRFRNRkNvZGUiLAogICAgICAgIHZhbHVlOiB2bS5hcGlEYXRhLmNvbmZpZ0RhdGFbIkNvbmZpZy5Eb29yU2V0dGluZy5SRUxBWS5EVE1GQ29kZSJdLAogICAgICB9LAogICAgICB7CiAgICAgICAgdGl0bGU6IHZtLiR0KCJEVE1GIikgKyAiMiAiICsgdm0uJHQoIkNvZGUiKSwKICAgICAgICB0eXBlOiAiaW5wdXQiLAogICAgICAgIGtleTogIkNvbmZpZy5Eb29yU2V0dGluZy5SRUxBWS5EVE1GQ29kZTIiLAogICAgICAgIHZhbHVlOiB2bS5hcGlEYXRhLmNvbmZpZ0RhdGFbIkNvbmZpZy5Eb29yU2V0dGluZy5SRUxBWS5EVE1GQ29kZTIiXSwKICAgICAgICBpc0hpZGU6IGZhbHNlLAogICAgICB9LAogICAgICB7CiAgICAgICAgdGl0bGU6IHZtLiR0KCJEVE1GIikgKyAiMyAiICsgdm0uJHQoIkNvZGUiKSwKICAgICAgICB0eXBlOiAiaW5wdXQiLAogICAgICAgIGtleTogIkNvbmZpZy5Eb29yU2V0dGluZy5SRUxBWS5EVE1GQ29kZTMiLAogICAgICAgIHZhbHVlOiB2bS5hcGlEYXRhLmNvbmZpZ0RhdGFbIkNvbmZpZy5Eb29yU2V0dGluZy5SRUxBWS5EVE1GQ29kZTMiXSwKICAgICAgICBpc0hpZGU6IGZhbHNlLAogICAgICB9LAogICAgXSwKICB9OwogIHJldHVybiBjb250ZW50Owp9Cg=="},null]}