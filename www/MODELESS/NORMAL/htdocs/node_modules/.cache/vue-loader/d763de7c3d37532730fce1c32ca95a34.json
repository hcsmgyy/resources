{"remainingRequest":"/workspace3/minjie.chen/gitlab-work/advance-indoor/resources/www/MODELESS/NORMAL/htdocs/node_modules/vue-loader/lib/index.js??vue-loader-options!/workspace3/minjie.chen/gitlab-work/advance-indoor/resources/www/MODELESS/NORMAL/htdocs/src/views/PhoneDisplaySetting.vue?vue&type=script&lang=js&","dependencies":[{"path":"/workspace3/minjie.chen/gitlab-work/advance-indoor/resources/www/MODELESS/NORMAL/htdocs/src/views/PhoneDisplaySetting.vue","mtime":1600155105014},{"path":"/workspace3/minjie.chen/gitlab-work/advance-indoor/resources/www/MODELESS/NORMAL/htdocs/node_modules/babel-loader/lib/index.js","mtime":1600155105338},{"path":"/workspace3/minjie.chen/gitlab-work/advance-indoor/resources/www/MODELESS/NORMAL/htdocs/node_modules/cache-loader/dist/cjs.js","mtime":1600155105894},{"path":"/workspace3/minjie.chen/gitlab-work/advance-indoor/resources/www/MODELESS/NORMAL/htdocs/node_modules/vue-loader/lib/index.js","mtime":1600155105414}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KCmltcG9ydCBDb21tb25QYWdlIGZyb20gIkAvY29tcG9uZW50cy9Db21tb25QYWdlLnZ1ZSI7CmltcG9ydCB7CiAgc2hvd1JlcXVlc3RTdWNjZXNzLAogIGRlZXBDbG9uZSwKICBjaGVja0ZpbGVGb3JtYXQsCiAgc2hvd0Vycm9ySW5mbywKICBnZXRJdGVtQnlLZXksCn0gZnJvbSAiQC9qcy9jb21tb24uanMiOwppbXBvcnQgeyBnZXRPcHRpb25zQnlMYWJlbCB9IGZyb20gIkAvanMvY29tbW9uS2V5cy5qcyI7CgpleHBvcnQgZGVmYXVsdCB7CiAgY29tcG9uZW50czogewogICAgQ29tbW9uUGFnZSwKICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICB3YWxscGFwZXJGaWxlSXRlbXM6IFtdLAogICAgICBzY3JlZW5TYXZlclR5cGVJdGVtczogW10sCiAgICAgIHNjcmVlblNhdmVyUGljdHVyZUl0ZW1zOiBbXSwKICAgICAgc2NyZWVuU2F2ZXJWaWRlb0l0ZW1zOiBbXSwKICAgICAgdHlwZUl0ZW1zOiBbXSwKICAgICAgYXBwU2VsZWN0SXRlbXM6IFtdLAogICAgICBjaGFuZ2VkQ2ZnRGF0YToge30sCiAgICAgIHN1Ym1pdENmZ0RhdGE6IHt9LAogICAgICBhcGlEYXRhOiB7fSwKICAgICAgZGF0YTogewogICAgICAgIGdldERhdGFTdWNjZXNzOiBmYWxzZSwKICAgICAgfSwKICAgIH07CiAgfSwKICBjcmVhdGVkKCkgewogICAgZ2V0RGF0YSh0aGlzKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIG9uQ29tbW9uUGFnZURhdGFDaGFuZ2U6IGZ1bmN0aW9uIChldmVudCkgewogICAgICBzZXRDaGFuZ2VkRGF0YSh0aGlzLCBldmVudCk7CiAgICAgIC8v55WM6Z2i5Y+Y5YyWCiAgICAgIGhhbmRsZXJQYWdlQ2hhbmdlZCh0aGlzLCBldmVudCk7CiAgICB9LAogIH0sCn07CgpmdW5jdGlvbiBzZXRDaGFuZ2VkRGF0YSh2bSwgZXZlbnQpIHsKICBpZiAoZXZlbnQuY29udGVudEtleSA9PSAiaG9tZXBhZ2UiICYmIGV2ZW50Lml0ZW1LZXkgPT0gImhvbWVwYWdlIikgewogICAgbGV0IHRhYmxlRGF0YSA9IGV2ZW50Lm5ld1ZhbDsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGFibGVEYXRhLmxlbmd0aDsgaSsrKSB7CiAgICAgIHZtLmNoYW5nZWRDZmdEYXRhWyJDb25maWcuSW5kb29yLlBBR0UxQVJFQSIgKyAoaSArIDEpICsgIi5EaXNwbGF5VHlwZSJdID0KICAgICAgICB0YWJsZURhdGFbaV0udHlwZS52YWx1ZTsKICAgICAgdm0uY2hhbmdlZENmZ0RhdGFbIkNvbmZpZy5JbmRvb3IuUEFHRTFBUkVBIiArIChpICsgMSkgKyAiLkxBQkVMIl0gPQogICAgICAgIHRhYmxlRGF0YVtpXS5sYWJlbC52YWx1ZTsKICAgICAgdm0uY2hhbmdlZENmZ0RhdGFbIkNvbmZpZy5JbmRvb3IuUEFHRTFBUkVBIiArIChpICsgMSkgKyAiLlZhbHVlIl0gPQogICAgICAgIHRhYmxlRGF0YVtpXS52YWx1ZS52YWx1ZTsKCiAgICAgIGlmIChldmVudC5uZXdWYWxbaV0uaWNvbi5maWxlTmFtZSAhPSBldmVudC5vbGRWYWxbaV0uaWNvbi5maWxlTmFtZSkgewogICAgICAgIHZtLmNoYW5nZWRDZmdEYXRhWyJDb25maWcuSW5kb29yLlBBR0UxQVJFQSIgKyAoaSArIDEpICsgIi5JQ09OIl0gPQogICAgICAgICAgdGFibGVEYXRhW2ldLmljb24uZmlsZU5hbWUgPT0gdm0uJHQoIlVwZ3JhZGVGaWxlUGF0aCIpCiAgICAgICAgICAgID8gIiIKICAgICAgICAgICAgOiB0YWJsZURhdGFbaV0uaWNvbi5maWxlTmFtZTsKICAgICAgfQogICAgfQogIH0gZWxzZSBpZiAoZXZlbnQuY29udGVudEtleSA9PSAibW9yZXBhZ2UiICYmIGV2ZW50Lml0ZW1LZXkgPT0gIm1vcmVwYWdlIikgewogICAgbGV0IHRhYmxlRGF0YSA9IGV2ZW50Lm5ld1ZhbDsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGFibGVEYXRhLmxlbmd0aDsgaSsrKSB7CiAgICAgIHZtLmNoYW5nZWRDZmdEYXRhWyJDb25maWcuSW5kb29yLlBBR0UyQVJFQSIgKyAoaSArIDEpICsgIi5EaXNwbGF5VHlwZSJdID0KICAgICAgICB0YWJsZURhdGFbaV0udHlwZS52YWx1ZTsKICAgICAgdm0uY2hhbmdlZENmZ0RhdGFbIkNvbmZpZy5JbmRvb3IuUEFHRTJBUkVBIiArIChpICsgMSkgKyAiLkxBQkVMIl0gPQogICAgICAgIHRhYmxlRGF0YVtpXS5sYWJlbC52YWx1ZTsKICAgICAgdm0uY2hhbmdlZENmZ0RhdGFbIkNvbmZpZy5JbmRvb3IuUEFHRTJBUkVBIiArIChpICsgMSkgKyAiLlZhbHVlIl0gPQogICAgICAgIHRhYmxlRGF0YVtpXS52YWx1ZS52YWx1ZTsKCiAgICAgIGlmIChldmVudC5uZXdWYWxbaV0uaWNvbi5maWxlTmFtZSAhPSBldmVudC5vbGRWYWxbaV0uaWNvbi5maWxlTmFtZSkgewogICAgICAgIHZtLmNoYW5nZWRDZmdEYXRhWyJDb25maWcuSW5kb29yLlBBR0UyQVJFQSIgKyAoaSArIDEpICsgIi5JQ09OIl0gPQogICAgICAgICAgdGFibGVEYXRhW2ldLmljb24uZmlsZU5hbWUgPT0gdm0uJHQoIlVwZ3JhZGVGaWxlUGF0aCIpCiAgICAgICAgICAgID8gIiIKICAgICAgICAgICAgOiB0YWJsZURhdGFbaV0uaWNvbi5maWxlTmFtZTsKICAgICAgfQogICAgfQogIH0gZWxzZSB7CiAgICB2bS5jaGFuZ2VkQ2ZnRGF0YVtldmVudC5pdGVtS2V5XSA9IGV2ZW50Lm5ld1ZhbDsKICB9Cn0KCmZ1bmN0aW9uIGhhbmRsZXJQYWdlQ2hhbmdlZCh2bSwgZXZlbnQpIHsKICAvL2hvbWVwYWdlCiAgbGV0IGhvbWVwYWdlSXRlbSA9IGdldEl0ZW1CeUtleSh2bS5kYXRhLCAiaG9tZXBhZ2UiLCAiaG9tZXBhZ2UiKTsKICBsZXQgaG9tZXBhZ2VUYWJsZURhdGEgPSBob21lcGFnZUl0ZW0udGFibGVEYXRhOwogIGZvciAobGV0IGkgPSAwOyBpIDwgaG9tZXBhZ2VUYWJsZURhdGEubGVuZ3RoOyBpKyspIHsKICAgIC8vdHlwZeaYr+WQpuebuOWQjAogICAgaG9tZXBhZ2VUYWJsZURhdGFbaV0udHlwZS5pc1dhcm4gPSBmYWxzZTsKICAgIGZvciAobGV0IGogPSAwOyBqIDwgaG9tZXBhZ2VUYWJsZURhdGEubGVuZ3RoOyBqKyspIHsKICAgICAgaWYgKAogICAgICAgIGkgIT0gaiAmJgogICAgICAgIGhvbWVwYWdlVGFibGVEYXRhW2pdLnR5cGUudmFsdWUgPT0gaG9tZXBhZ2VUYWJsZURhdGFbaV0udHlwZS52YWx1ZSAmJgogICAgICAgIGhvbWVwYWdlVGFibGVEYXRhW2pdLnR5cGUudmFsdWUgIT0KICAgICAgICAgIGdldEFyZWFUeXBlQnlMYWJlbCgiQ3VzdG9tIEFQSyIsIHZtKSAmJgogICAgICAgIGhvbWVwYWdlVGFibGVEYXRhW2pdLnR5cGUudmFsdWUgIT0gZ2V0QXJlYVR5cGVCeUxhYmVsKCJCcm93c2VyIiwgdm0pICYmCiAgICAgICAgaG9tZXBhZ2VUYWJsZURhdGFbal0udHlwZS52YWx1ZSAhPSBnZXRBcmVhVHlwZUJ5TGFiZWwoIk4vQSIsIHZtKQogICAgICApIHsKICAgICAgICBob21lcGFnZVRhYmxlRGF0YVtpXS50eXBlLmlzV2FybiA9IHRydWU7CiAgICAgICAgaG9tZXBhZ2VUYWJsZURhdGFbal0udHlwZS5pc1dhcm4gPSB0cnVlOwogICAgICB9CiAgICB9CiAgICAvL2ljb27mmL7npLrkuI7lkKYKICAgIGlmIChob21lcGFnZVRhYmxlRGF0YVtpXS50eXBlLnZhbHVlID09IGdldEFyZWFUeXBlQnlMYWJlbCgiRE5EIiwgdm0pKSB7CiAgICAgIGhvbWVwYWdlVGFibGVEYXRhW2ldLmljb24uaXNTaG93ID0gZmFsc2U7CiAgICB9IGVsc2UgewogICAgICBob21lcGFnZVRhYmxlRGF0YVtpXS5pY29uLmlzU2hvdyA9IHRydWU7CiAgICB9CiAgICAvL2xhYmVs5piv5ZCm56aB55SoCiAgICBpZiAoCiAgICAgIGhvbWVwYWdlVGFibGVEYXRhW2ldLnR5cGUudmFsdWUgPT0gZ2V0QXJlYVR5cGVCeUxhYmVsKCJETkQiLCB2bSkgfHwKICAgICAgaG9tZXBhZ2VUYWJsZURhdGFbaV0udHlwZS52YWx1ZSA9PSBnZXRBcmVhVHlwZUJ5TGFiZWwoIlVubG9jayIsIHZtKQogICAgKSB7CiAgICAgIGhvbWVwYWdlVGFibGVEYXRhW2ldLmxhYmVsLmRpc2FibGVkID0gdHJ1ZTsKICAgIH0gZWxzZSB7CiAgICAgIGhvbWVwYWdlVGFibGVEYXRhW2ldLmxhYmVsLmRpc2FibGVkID0gZmFsc2U7CiAgICB9CiAgICAvL3ZhbHVl5piv5ZCm56aB55SoCiAgICBpZiAoCiAgICAgIGhvbWVwYWdlVGFibGVEYXRhW2ldLnR5cGUudmFsdWUgPT0gZ2V0QXJlYVR5cGVCeUxhYmVsKCJDdXN0b20gQVBLIiwgdm0pIHx8CiAgICAgIGhvbWVwYWdlVGFibGVEYXRhW2ldLnR5cGUudmFsdWUgPT0gZ2V0QXJlYVR5cGVCeUxhYmVsKCJCcm93c2VyIiwgdm0pCiAgICApIHsKICAgICAgaG9tZXBhZ2VUYWJsZURhdGFbaV0udmFsdWUuZGlzYWJsZWQgPSBmYWxzZTsKICAgIH0gZWxzZSB7CiAgICAgIGhvbWVwYWdlVGFibGVEYXRhW2ldLnZhbHVlLmRpc2FibGVkID0gdHJ1ZTsKICAgIH0KICAgIC8vdmFsdWXlgLznmoRpbnB1dOWSjHNlbGVjdOahhuWPmOaNogogICAgaWYgKAogICAgICBob21lcGFnZVRhYmxlRGF0YVtpXS50eXBlLnZhbHVlID09IGdldEFyZWFUeXBlQnlMYWJlbCgiQ3VzdG9tIEFQSyIsIHZtKQogICAgKSB7CiAgICAgIGhvbWVwYWdlVGFibGVEYXRhW2ldLnZhbHVlLml0ZW1UeXBlID0gInNlbGVjdCI7CiAgICAgIGhvbWVwYWdlVGFibGVEYXRhW2ldLnZhbHVlLmRpc2FibGVkID0gZmFsc2U7CiAgICB9IGVsc2UgewogICAgICBob21lcGFnZVRhYmxlRGF0YVtpXS52YWx1ZS5pdGVtVHlwZSA9ICJpbnB1dCI7CiAgICB9CgogICAgLy90eXBl5Y+Y5YyW5pe2bGFiZWzlgLzmm7TmlrDvvIx2YWx1ZeWAvOabtOaWsAogICAgaWYgKAogICAgICAidW5kZWZpbmVkIiAhPSB0eXBlb2YgZXZlbnQgJiYKICAgICAgZXZlbnQuaXRlbUtleSA9PSAiaG9tZXBhZ2UiICYmCiAgICAgIGV2ZW50LmNvbnRlbnRLZXkgPT0gImhvbWVwYWdlIgogICAgKSB7CiAgICAgIGlmIChldmVudC5uZXdWYWxbaV0udHlwZS52YWx1ZSAhPSBldmVudC5vbGRWYWxbaV0udHlwZS52YWx1ZSkgewogICAgICAgIGlmICgKICAgICAgICAgIHZtLmFwaURhdGEuY29uZmlnRGF0YVsKICAgICAgICAgICAgIkNvbmZpZy5JbmRvb3IuUEFHRTFBUkVBIiArIChpICsgMSkgKyAiLkxBQkVMIgogICAgICAgICAgXSAhPSAiIiAmJgogICAgICAgICAgdm0uYXBpRGF0YS5jb25maWdEYXRhWwogICAgICAgICAgICAiQ29uZmlnLkluZG9vci5QQUdFMUFSRUEiICsgKGkgKyAxKSArICIuRGlzcGxheVR5cGUiCiAgICAgICAgICBdID09IGV2ZW50Lm5ld1ZhbFtpXS50eXBlLnZhbHVlCiAgICAgICAgKSB7CiAgICAgICAgICB0YWJsZURhdGFbaV0ubGFiZWwudmFsdWUgPQogICAgICAgICAgICB2bS5hcGlEYXRhLmNvbmZpZ0RhdGFbCiAgICAgICAgICAgICAgIkNvbmZpZy5JbmRvb3IuUEFHRTFBUkVBIiArIChpICsgMSkgKyAiLkxBQkVMIgogICAgICAgICAgICBdOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBob21lcGFnZVRhYmxlRGF0YVtpXS5sYWJlbC52YWx1ZSA9IGdldE9wdGlvbnNCeUxhYmVsKAogICAgICAgICAgICB2bSwKICAgICAgICAgICAgZ2V0QXJlYVR5cGVCeUtleShob21lcGFnZVRhYmxlRGF0YVtpXS50eXBlLnZhbHVlLCB2bSkKICAgICAgICAgICk7CiAgICAgICAgICB2bS5jaGFuZ2VkQ2ZnRGF0YVsiQ29uZmlnLkluZG9vci5QQUdFMUFSRUEiICsgKGkgKyAxKSArICIuTEFCRUwiXSA9CiAgICAgICAgICAgIGhvbWVwYWdlVGFibGVEYXRhW2ldLmxhYmVsLnZhbHVlOwogICAgICAgIH0KICAgICAgICBpZiAoCiAgICAgICAgICB2bS5hcGlEYXRhLmNvbmZpZ0RhdGFbCiAgICAgICAgICAgICJDb25maWcuSW5kb29yLlBBR0UxQVJFQSIgKyAoaSArIDEpICsgIi5EaXNwbGF5VHlwZSIKICAgICAgICAgIF0gPT0gZXZlbnQubmV3VmFsW2ldLnR5cGUudmFsdWUKICAgICAgICApIHsKICAgICAgICAgIGhvbWVwYWdlVGFibGVEYXRhW2ldLnZhbHVlLnZhbHVlID0KICAgICAgICAgICAgdm0uYXBpRGF0YS5jb25maWdEYXRhWwogICAgICAgICAgICAgICJDb25maWcuSW5kb29yLlBBR0UxQVJFQSIgKyAoaSArIDEpICsgIi5WYWx1ZSIKICAgICAgICAgICAgXTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaG9tZXBhZ2VUYWJsZURhdGFbaV0udmFsdWUudmFsdWUgPSAiIjsKICAgICAgICAgIHZtLmNoYW5nZWRDZmdEYXRhWyJDb25maWcuSW5kb29yLlBBR0UxQVJFQSIgKyAoaSArIDEpICsgIi5WYWx1ZSJdID0KICAgICAgICAgICAgIiI7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQogIC8vbW9yZXBhZ2UKICBsZXQgbW9yZXBhZ2VJdGVtID0gZ2V0SXRlbUJ5S2V5KHZtLmRhdGEsICJtb3JlcGFnZSIsICJtb3JlcGFnZSIpOwogIGxldCBtb3JlcGFnZVRhYmxlRGF0YSA9IG1vcmVwYWdlSXRlbS50YWJsZURhdGE7CiAgZm9yIChsZXQgaSA9IDA7IGkgPCBtb3JlcGFnZVRhYmxlRGF0YS5sZW5ndGg7IGkrKykgewogICAgLy90eXBl5piv5ZCm55u45ZCMCiAgICBtb3JlcGFnZVRhYmxlRGF0YVtpXS50eXBlLmlzV2FybiA9IGZhbHNlOwogICAgZm9yIChsZXQgaiA9IDA7IGogPCBtb3JlcGFnZVRhYmxlRGF0YS5sZW5ndGg7IGorKykgewogICAgICBpZiAoCiAgICAgICAgaSAhPSBqICYmCiAgICAgICAgbW9yZXBhZ2VUYWJsZURhdGFbal0udHlwZS52YWx1ZSA9PSBtb3JlcGFnZVRhYmxlRGF0YVtpXS50eXBlLnZhbHVlICYmCiAgICAgICAgbW9yZXBhZ2VUYWJsZURhdGFbal0udHlwZS52YWx1ZSAhPQogICAgICAgICAgZ2V0QXJlYVR5cGVCeUxhYmVsKCJDdXN0b20gQVBLIiwgdm0pICYmCiAgICAgICAgbW9yZXBhZ2VUYWJsZURhdGFbal0udHlwZS52YWx1ZSAhPSBnZXRBcmVhVHlwZUJ5TGFiZWwoIkJyb3dzZXIiLCB2bSkgJiYKICAgICAgICBtb3JlcGFnZVRhYmxlRGF0YVtqXS50eXBlLnZhbHVlICE9IGdldEFyZWFUeXBlQnlMYWJlbCgiTi9BIiwgdm0pCiAgICAgICkgewogICAgICAgIG1vcmVwYWdlVGFibGVEYXRhW2ldLnR5cGUuaXNXYXJuID0gdHJ1ZTsKICAgICAgICBtb3JlcGFnZVRhYmxlRGF0YVtqXS50eXBlLmlzV2FybiA9IHRydWU7CiAgICAgIH0KICAgIH0KICAgIC8vaWNvbuaYvuekuuS4juWQpgogICAgaWYgKG1vcmVwYWdlVGFibGVEYXRhW2ldLnR5cGUudmFsdWUgPT0gZ2V0QXJlYVR5cGVCeUxhYmVsKCJETkQiLCB2bSkpIHsKICAgICAgbW9yZXBhZ2VUYWJsZURhdGFbaV0uaWNvbi5pc1Nob3cgPSBmYWxzZTsKICAgIH0gZWxzZSB7CiAgICAgIG1vcmVwYWdlVGFibGVEYXRhW2ldLmljb24uaXNTaG93ID0gdHJ1ZTsKICAgIH0KICAgIC8vbGFiZWzmmK/lkKbnpoHnlKgKICAgIGlmICgKICAgICAgbW9yZXBhZ2VUYWJsZURhdGFbaV0udHlwZS52YWx1ZSA9PSBnZXRBcmVhVHlwZUJ5TGFiZWwoIkRORCIsIHZtKSB8fAogICAgICBtb3JlcGFnZVRhYmxlRGF0YVtpXS50eXBlLnZhbHVlID09IGdldEFyZWFUeXBlQnlMYWJlbCgiVW5sb2NrIiwgdm0pCiAgICApIHsKICAgICAgbW9yZXBhZ2VUYWJsZURhdGFbaV0ubGFiZWwuZGlzYWJsZWQgPSB0cnVlOwogICAgfSBlbHNlIHsKICAgICAgbW9yZXBhZ2VUYWJsZURhdGFbaV0ubGFiZWwuZGlzYWJsZWQgPSBmYWxzZTsKICAgIH0KICAgIC8vdmFsdWXmmK/lkKbnpoHnlKgKICAgIGlmICgKICAgICAgbW9yZXBhZ2VUYWJsZURhdGFbaV0udHlwZS52YWx1ZSA9PSBnZXRBcmVhVHlwZUJ5TGFiZWwoIkN1c3RvbSBBUEsiLCB2bSkgfHwKICAgICAgbW9yZXBhZ2VUYWJsZURhdGFbaV0udHlwZS52YWx1ZSA9PSBnZXRBcmVhVHlwZUJ5TGFiZWwoIkJyb3dzZXIiLCB2bSkKICAgICkgewogICAgICBtb3JlcGFnZVRhYmxlRGF0YVtpXS52YWx1ZS5kaXNhYmxlZCA9IGZhbHNlOwogICAgfSBlbHNlIHsKICAgICAgbW9yZXBhZ2VUYWJsZURhdGFbaV0udmFsdWUuZGlzYWJsZWQgPSB0cnVlOwogICAgfQogICAgLy92YWx1ZeWAvOeahGlucHV05ZKMc2VsZWN05qGG5Y+Y5o2iCiAgICBpZiAoCiAgICAgIG1vcmVwYWdlVGFibGVEYXRhW2ldLnR5cGUudmFsdWUgPT0gZ2V0QXJlYVR5cGVCeUxhYmVsKCJDdXN0b20gQVBLIiwgdm0pCiAgICApIHsKICAgICAgbW9yZXBhZ2VUYWJsZURhdGFbaV0udmFsdWUuaXRlbVR5cGUgPSAic2VsZWN0IjsKICAgICAgbW9yZXBhZ2VUYWJsZURhdGFbaV0udmFsdWUuZGlzYWJsZWQgPSBmYWxzZTsKICAgIH0gZWxzZSB7CiAgICAgIG1vcmVwYWdlVGFibGVEYXRhW2ldLnZhbHVlLml0ZW1UeXBlID0gImlucHV0IjsKICAgIH0KCiAgICAvL3R5cGXlj5jljJbml7ZsYWJlbOWAvOabtOaWsO+8jHZhbHVl5YC85pu05pawCiAgICBpZiAoCiAgICAgICJ1bmRlZmluZWQiICE9IHR5cGVvZiBldmVudCAmJgogICAgICBldmVudC5pdGVtS2V5ID09ICJtb3JlcGFnZSIgJiYKICAgICAgZXZlbnQuY29udGVudEtleSA9PSAibW9yZXBhZ2UiCiAgICApIHsKICAgICAgaWYgKGV2ZW50Lm5ld1ZhbFtpXS50eXBlLnZhbHVlICE9IGV2ZW50Lm9sZFZhbFtpXS50eXBlLnZhbHVlKSB7CiAgICAgICAgaWYgKAogICAgICAgICAgdm0uYXBpRGF0YS5jb25maWdEYXRhWwogICAgICAgICAgICAiQ29uZmlnLkluZG9vci5QQUdFMkFSRUEiICsgKGkgKyAxKSArICIuTEFCRUwiCiAgICAgICAgICBdICE9ICIiICYmCiAgICAgICAgICB2bS5hcGlEYXRhLmNvbmZpZ0RhdGFbCiAgICAgICAgICAgICJDb25maWcuSW5kb29yLlBBR0UyQVJFQSIgKyAoaSArIDEpICsgIi5EaXNwbGF5VHlwZSIKICAgICAgICAgIF0gPT0gZXZlbnQubmV3VmFsW2ldLnR5cGUudmFsdWUKICAgICAgICApIHsKICAgICAgICAgIG1vcmVwYWdlVGFibGVEYXRhW2ldLmxhYmVsLnZhbHVlID0KICAgICAgICAgICAgdm0uYXBpRGF0YS5jb25maWdEYXRhWwogICAgICAgICAgICAgICJDb25maWcuSW5kb29yLlBBR0UyQVJFQSIgKyAoaSArIDEpICsgIi5MQUJFTCIKICAgICAgICAgICAgXTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgbW9yZXBhZ2VUYWJsZURhdGFbaV0ubGFiZWwudmFsdWUgPSBnZXRPcHRpb25zQnlMYWJlbCgKICAgICAgICAgICAgdm0sCiAgICAgICAgICAgIGdldEFyZWFUeXBlQnlLZXkobW9yZXBhZ2VUYWJsZURhdGFbaV0udHlwZS52YWx1ZSwgdm0pCiAgICAgICAgICApOwogICAgICAgICAgdm0uY2hhbmdlZENmZ0RhdGFbIkNvbmZpZy5JbmRvb3IuUEFHRTJBUkVBIiArIChpICsgMSkgKyAiLkxBQkVMIl0gPQogICAgICAgICAgICBtb3JlcGFnZVRhYmxlRGF0YVtpXS5sYWJlbC52YWx1ZTsKICAgICAgICB9CiAgICAgICAgaWYgKAogICAgICAgICAgdm0uYXBpRGF0YS5jb25maWdEYXRhWwogICAgICAgICAgICAiQ29uZmlnLkluZG9vci5QQUdFMkFSRUEiICsgKGkgKyAxKSArICIuRGlzcGxheVR5cGUiCiAgICAgICAgICBdID09IGV2ZW50Lm5ld1ZhbFtpXS50eXBlLnZhbHVlCiAgICAgICAgKSB7CiAgICAgICAgICBtb3JlcGFnZVRhYmxlRGF0YVtpXS52YWx1ZS52YWx1ZSA9CiAgICAgICAgICAgIHZtLmFwaURhdGEuY29uZmlnRGF0YVsKICAgICAgICAgICAgICAiQ29uZmlnLkluZG9vci5QQUdFMkFSRUEiICsgKGkgKyAxKSArICIuVmFsdWUiCiAgICAgICAgICAgIF07CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIG1vcmVwYWdlVGFibGVEYXRhW2ldLnZhbHVlLnZhbHVlID0gIiI7CiAgICAgICAgICB2bS5jaGFuZ2VkQ2ZnRGF0YVsiQ29uZmlnLkluZG9vci5QQUdFMkFSRUEiICsgKGkgKyAxKSArICIuVmFsdWUiXSA9CiAgICAgICAgICAgICIiOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KfQoKZnVuY3Rpb24gZ2V0QXJlYVR5cGVCeUxhYmVsKGxhYmVsLCB2bSkgewogIGxldCB0eXBlcyA9IHZtLmFwaURhdGEuZGF0YS5QYWdlMURpc3BsYXlUeXBlczsKICBmb3IgKGxldCBpID0gMDsgaSA8IHR5cGVzLmxlbmd0aDsgaSsrKSB7CiAgICBpZiAodHlwZXNbaV0ubGFiZWwgPT0gbGFiZWwpIHsKICAgICAgcmV0dXJuIHR5cGVzW2ldLmtleTsKICAgIH0KICB9CiAgcmV0dXJuIC0xOwp9CgpmdW5jdGlvbiBnZXRBcmVhVHlwZUJ5S2V5KGtleSwgdm0pIHsKICBsZXQgdHlwZXMgPSB2bS5hcGlEYXRhLmRhdGEuUGFnZTFEaXNwbGF5VHlwZXM7CiAgZm9yIChsZXQgaSA9IDA7IGkgPCB0eXBlcy5sZW5ndGg7IGkrKykgewogICAgaWYgKHR5cGVzW2ldLmtleSA9PSBrZXkpIHsKICAgICAgcmV0dXJuIHR5cGVzW2ldLmxhYmVsOwogICAgfQogIH0KICByZXR1cm4gLTE7Cn0KCmZ1bmN0aW9uIHN1Ym1pdERhdGEodm0pIHsKICB2bS5kYXRhLnN1Ym1pdExvYWRpbmcgPSB0cnVlOwoKICBsZXQgcmVxdWVzdERhdGEgPSB7CiAgICB0YXJnZXQ6ICJwaG9uZURpc3BsYXlTZXR0aW5nIiwKICAgIGFjdGlvbjogInNldCIsCiAgICBjb25maWdEYXRhOiB2bS5zdWJtaXRDZmdEYXRhLAogIH07CiAgdm0uJGF4aW9zLnBvc3QoImFwaSIsIHJlcXVlc3REYXRhKS50aGVuKChyZXNwb25zZSkgPT4gewogICAgc2hvd1JlcXVlc3RTdWNjZXNzKHZtKTsKICAgIHZtLmRhdGEuc3VibWl0TG9hZGluZyA9IGZhbHNlOwogIH0pOwp9CgpmdW5jdGlvbiBnZXREYXRhKHZtKSB7CiAgdm0uJGF4aW9zLmdldCgiYXBpL3Bob25lRGlzcGxheVNldHRpbmcvaW5mbyIpLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICB2bS5nZXREYXRhU3VjY2VzcyA9IHRydWU7CiAgICB2bS5hcGlEYXRhID0gcmVzcG9uc2UuZGF0YTsKICAgIHZtLmNoYW5nZWRDZmdEYXRhID0gZGVlcENsb25lKHJlc3BvbnNlLmRhdGEuY29uZmlnRGF0YSk7CiAgICBjcmVhdGVQYWdlRGF0YSh2bSk7CiAgICBoYW5kbGVyUGFnZUNoYW5nZWQodm0pOwogIH0pOwp9CgpmdW5jdGlvbiBnZXRDb21taXREYXRhKHZtKSB7CiAgdm0uc3VibWl0Q2ZnRGF0YSA9IHt9OwogIGZvciAodmFyIGNoYW5nZWRLZXkgaW4gdm0uY2hhbmdlZENmZ0RhdGEpIHsKICAgIGlmICh2bS5hcGlEYXRhLmNvbmZpZ0RhdGFbY2hhbmdlZEtleV0gIT0gdm0uY2hhbmdlZENmZ0RhdGFbY2hhbmdlZEtleV0pIHsKICAgICAgdm0uc3VibWl0Q2ZnRGF0YVtjaGFuZ2VkS2V5XSA9IHZtLmNoYW5nZWRDZmdEYXRhW2NoYW5nZWRLZXldOwogICAgfQogIH0KfQoKZnVuY3Rpb24gY2hlY2tDb21taXREYXRhKHZtKSB7CiAgcmV0dXJuIGNoZWNrSG9tZXBhZ2VEYXRhKHZtKSAmJiBjaGVja01vcmVwYWdlRGF0YSh2bSk7Cn0KCmZ1bmN0aW9uIGNoZWNrTW9yZXBhZ2VEYXRhKHZtKSB7CiAgbGV0IHN1Y2Nlc3MgPSB0cnVlOwogIGxldCBpdGVtID0gZ2V0SXRlbUJ5S2V5KHZtLmRhdGEsICJtb3JlcGFnZSIsICJtb3JlcGFnZSIpOwogIGxldCB0YWJsZURhdGEgPSBpdGVtLnRhYmxlRGF0YTsKICBmb3IgKGxldCBpID0gMDsgaSA8IHRhYmxlRGF0YS5sZW5ndGg7IGkrKykgewogICAgLy90eXBl5piv5ZCm55u45ZCMCiAgICBmb3IgKGxldCBqID0gMDsgaiA8IHRhYmxlRGF0YS5sZW5ndGg7IGorKykgewogICAgICBpZiAoCiAgICAgICAgaSAhPSBqICYmCiAgICAgICAgdGFibGVEYXRhW2pdLnR5cGUudmFsdWUgPT0gdGFibGVEYXRhW2ldLnR5cGUudmFsdWUgJiYKICAgICAgICB0YWJsZURhdGFbal0udHlwZS52YWx1ZSAhPSBnZXRBcmVhVHlwZUJ5TGFiZWwoIkN1c3RvbSBBUEsiLCB2bSkgJiYKICAgICAgICB0YWJsZURhdGFbal0udHlwZS52YWx1ZSAhPSBnZXRBcmVhVHlwZUJ5TGFiZWwoIkJyb3dzZXIiLCB2bSkgJiYKICAgICAgICB0YWJsZURhdGFbal0udHlwZS52YWx1ZSAhPSBnZXRBcmVhVHlwZUJ5TGFiZWwoIk4vQSIsIHZtKQogICAgICApIHsKICAgICAgICBzdWNjZXNzID0gZmFsc2U7CiAgICAgIH0KICAgIH0KICB9CiAgcmV0dXJuIHN1Y2Nlc3M7Cn0KCmZ1bmN0aW9uIGNoZWNrSG9tZXBhZ2VEYXRhKHZtKSB7CiAgbGV0IHN1Y2Nlc3MgPSB0cnVlOwogIGxldCBpdGVtID0gZ2V0SXRlbUJ5S2V5KHZtLmRhdGEsICJob21lcGFnZSIsICJob21lcGFnZSIpOwogIGxldCB0YWJsZURhdGEgPSBpdGVtLnRhYmxlRGF0YTsKICBmb3IgKGxldCBpID0gMDsgaSA8IHRhYmxlRGF0YS5sZW5ndGg7IGkrKykgewogICAgLy90eXBl5piv5ZCm55u45ZCMCiAgICBmb3IgKGxldCBqID0gMDsgaiA8IHRhYmxlRGF0YS5sZW5ndGg7IGorKykgewogICAgICBpZiAoCiAgICAgICAgaSAhPSBqICYmCiAgICAgICAgdGFibGVEYXRhW2pdLnR5cGUudmFsdWUgPT0gdGFibGVEYXRhW2ldLnR5cGUudmFsdWUgJiYKICAgICAgICB0YWJsZURhdGFbal0udHlwZS52YWx1ZSAhPSBnZXRBcmVhVHlwZUJ5TGFiZWwoIkN1c3RvbSBBUEsiLCB2bSkgJiYKICAgICAgICB0YWJsZURhdGFbal0udHlwZS52YWx1ZSAhPSBnZXRBcmVhVHlwZUJ5TGFiZWwoIkJyb3dzZXIiLCB2bSkgJiYKICAgICAgICB0YWJsZURhdGFbal0udHlwZS52YWx1ZSAhPSBnZXRBcmVhVHlwZUJ5TGFiZWwoIk4vQSIsIHZtKQogICAgICApIHsKICAgICAgICBzdWNjZXNzID0gZmFsc2U7CiAgICAgIH0KICAgIH0KICB9CiAgcmV0dXJuIHN1Y2Nlc3M7Cn0KCmZ1bmN0aW9uIGNyZWF0ZVNlbGVjdEl0ZW1zKHZtKSB7CiAgLy9hcGtsaXN0CiAgdm0uYXBwU2VsZWN0SXRlbXMgPSBbXTsKICBsZXQgYXBwSXRlbXMgPSB2bS5hcGlEYXRhLmRhdGEuYXBrTGlzdC5zcGxpdCgiJiIpOwogIGZvciAobGV0IGkgPSAwOyBpIDwgYXBwSXRlbXMubGVuZ3RoOyBpKyspIHsKICAgIGlmIChhcHBJdGVtc1tpXS5sZW5ndGggPT0gMCkgewogICAgICBjb250aW51ZTsKICAgIH0KICAgIGxldCBhcnIgPSBhcHBJdGVtc1tpXS5zcGxpdCgiPSIpOwogICAgdmFyIHNlbGVjdEl0ZW0gPSB7CiAgICAgIGtleTogYXJyWzFdLAogICAgICBsYWJlbDogYXJyWzBdLAogICAgfTsKICAgIHZtLmFwcFNlbGVjdEl0ZW1zLnB1c2goc2VsZWN0SXRlbSk7CiAgfQoKICAvL3BhZ2UgdHlwZSBzZWxlY3QgaXRlbXMKICB2bS50eXBlSXRlbXMgPSBbXTsKICBsZXQgdHlwZXMgPSB2bS5hcGlEYXRhLmRhdGEuUGFnZTFEaXNwbGF5VHlwZXM7CiAgZm9yIChsZXQgaSA9IDA7IGkgPCB0eXBlcy5sZW5ndGg7IGkrKykgewogICAgbGV0IGl0ZW0gPSB7CiAgICAgIGtleTogdHlwZXNbaV0ua2V5LAogICAgICBsYWJlbDogZ2V0T3B0aW9uc0J5TGFiZWwodm0sIHR5cGVzW2ldLmxhYmVsKSwKICAgIH07CiAgICB2bS50eXBlSXRlbXMucHVzaChpdGVtKTsKICB9CgogIC8vc2NyZWVuIHBpY3R1cmUKICB2bS5zY3JlZW5TYXZlclZpZGVvSXRlbXMgPSBbXTsKICB2bS5zY3JlZW5TYXZlclBpY3R1cmVJdGVtcyA9IFtdOwogIGxldCBzY3JlZW5TYXZlciA9IHZtLmFwaURhdGEuZGF0YS5zY3JlZW5TYXZlckZpbGVzLnNwbGl0KCJcbiIpOwogIGZvciAobGV0IGkgPSAwOyBpIDwgc2NyZWVuU2F2ZXIubGVuZ3RoOyBpKyspIHsKICAgIGlmIChzY3JlZW5TYXZlcltpXSAhPSAiIikgewogICAgICBsZXQgaXRlbSA9IHsKICAgICAgICBrZXk6IHNjcmVlblNhdmVyW2ldLAogICAgICAgIGxhYmVsOiBzY3JlZW5TYXZlcltpXSwKICAgICAgfTsKICAgICAgaWYgKAogICAgICAgIGNoZWNrRmlsZUZvcm1hdChzY3JlZW5TYXZlcltpXSwgIi5KUEciLCA0KSB8fAogICAgICAgIGNoZWNrRmlsZUZvcm1hdChzY3JlZW5TYXZlcltpXSwgIi5KUEVHIiwgNSkgfHwKICAgICAgICBjaGVja0ZpbGVGb3JtYXQoc2NyZWVuU2F2ZXJbaV0sICIuUE5HIiwgNCkKICAgICAgKSB7CiAgICAgICAgdm0uc2NyZWVuU2F2ZXJQaWN0dXJlSXRlbXMucHVzaChpdGVtKTsKICAgICAgfSBlbHNlIGlmICgKICAgICAgICBjaGVja0ZpbGVGb3JtYXQoc2NyZWVuU2F2ZXJbaV0sICIuTVA0IiwgNCkgfHwKICAgICAgICBjaGVja0ZpbGVGb3JtYXQoc2NyZWVuU2F2ZXJbaV0sICIuV01WIiwgNCkgfHwKICAgICAgICBjaGVja0ZpbGVGb3JtYXQoc2NyZWVuU2F2ZXJbaV0sICIuQVZJIiwgNCkKICAgICAgKSB7CiAgICAgICAgdm0uc2NyZWVuU2F2ZXJWaWRlb0l0ZW1zLnB1c2goaXRlbSk7CiAgICAgIH0KICAgIH0KICB9CiAgLy9zY3JlZW4gc2F2ZXIgdHlwZXMKICB2bS5zY3JlZW5TYXZlclR5cGVJdGVtcyA9IFtdOwogIGlmICh2bS5hcGlEYXRhLmNvbmZpZ0RhdGFbIkNvbmZpZy5Eb29yU2V0dGluZy5DT05ORUNULlNlcnZlck1vZGUiXSA9PSAxKSB7CiAgICB2bS5zY3JlZW5TYXZlclR5cGVJdGVtcy5wdXNoKHsga2V5OiAwLCBsYWJlbDogdm0uJHQoIlNETUMiKSB9KTsKICAgIHZtLnNjcmVlblNhdmVyVHlwZUl0ZW1zLnB1c2goeyBrZXk6IDEsIGxhYmVsOiB2bS4kdCgiTG9jYWxQaWN0dXJlcyIpIH0pOwogICAgdm0uc2NyZWVuU2F2ZXJUeXBlSXRlbXMucHVzaCh7IGtleTogMiwgbGFiZWw6IHZtLiR0KCJTRE1DTG9jYWxQaWN0dXJlcyIpIH0pOwogIH0gZWxzZSB7CiAgICB2bS5zY3JlZW5TYXZlclR5cGVJdGVtcy5wdXNoKHsga2V5OiAxLCBsYWJlbDogdm0uJHQoIkxvY2FsUGljdHVyZXMiKSB9KTsKICB9CiAgaWYgKHZtLmFwaURhdGEuZGF0YS5oYXNBa0ZhY2UgIT0gIiIpIHsKICAgIGlmICh2bS5hcGlEYXRhLmNvbmZpZ0RhdGFbIkNvbmZpZy5Eb29yU2V0dGluZy5DT05ORUNULlNlcnZlck1vZGUiXSA9PSAxKSB7CiAgICAgIHZtLnNjcmVlblNhdmVyVHlwZUl0ZW1zLnB1c2goeyBrZXk6IDMsIGxhYmVsOiB2bS4kdCgiU0RNQ1ZpZGVvcyIpIH0pOwogICAgICB2bS5zY3JlZW5TYXZlclR5cGVJdGVtcy5wdXNoKHsga2V5OiA1LCBsYWJlbDogdm0uJHQoIlNETUNMb2NhbFZpZGVvcyIpIH0pOwogICAgfQogICAgdm0uc2NyZWVuU2F2ZXJUeXBlSXRlbXMucHVzaCh7IGtleTogNCwgbGFiZWw6IHZtLiR0KCJMb2NhbFZpZGVvcyIpIH0pOwogIH0KICAvL3dhbGxwYXBlciBmaWxlcwogIHZtLndhbGxwYXBlckZpbGVJdGVtcyA9IFtdOwogIGxldCBkZWZhdWx0V2FsbHBhcGVyID0gewogICAga2V5OiAiIiwKICAgIGxhYmVsOiAiRGVmYXVsdCIsCiAgfTsKICB2bS53YWxscGFwZXJGaWxlSXRlbXMucHVzaChkZWZhdWx0V2FsbHBhcGVyKTsKICBsZXQgd2FsbHBlcGVyRmlsZXMgPSB2bS5hcGlEYXRhLmRhdGEud2FsbHBhcGVyRmlsZXMuc3BsaXQoIlxuIik7CiAgZm9yIChsZXQgaSA9IDA7IGkgPCB3YWxscGVwZXJGaWxlcy5sZW5ndGg7IGkrKykgewogICAgaWYgKHdhbGxwZXBlckZpbGVzW2ldICE9ICIiKSB7CiAgICAgIGxldCBpdGVtID0gewogICAgICAgIGtleTogdm0uYXBpRGF0YS5kYXRhLndhbGxwYXBlclBhdGggKyB3YWxscGVwZXJGaWxlc1tpXSwKICAgICAgICBsYWJlbDogd2FsbHBlcGVyRmlsZXNbaV0sCiAgICAgIH07CiAgICAgIHZtLndhbGxwYXBlckZpbGVJdGVtcy5wdXNoKGl0ZW0pOwogICAgfQogIH0KfQoKZnVuY3Rpb24gY3JlYXRlUGFnZURhdGEodm0pIHsKICB2bS5kYXRhID0gewogICAgZ2V0RGF0YVN1Y2Nlc3M6IHRydWUsCiAgICBicmVhZENydW1iOiB7CiAgICAgIGZpcnN0VGl0bGU6IHZtLiR0KCJQaG9uZSIpLAogICAgICBzZWNvbmRUaXRsZTogdm0uJHQoIkRpc3BsYXlTZXR0aW5nIiksCiAgICB9LAogICAgb25TdWJtaXQ6IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKCFjaGVja0NvbW1pdERhdGEodm0pKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGdldENvbW1pdERhdGEodm0pOwogICAgICBzdWJtaXREYXRhKHZtKTsKICAgIH0sCiAgICBvbkNhbmNlbDogZnVuY3Rpb24gKCkgewogICAgICB2bS5kYXRhLmNhbmNlbExvYWRpbmcgPSB0cnVlOwogICAgICBnZXREYXRhKHZtKTsKICAgIH0sCiAgICBzdWJtaXRMb2FkaW5nOiBmYWxzZSwKICAgIGNhbmNlbExvYWRpbmc6IGZhbHNlLAogICAgY29udGVudHM6IFtdLAogIH07CgogIGNyZWF0ZVNlbGVjdEl0ZW1zKHZtKTsKCiAgdm0uZGF0YS5jb250ZW50cy5wdXNoKGNyZWF0ZUhvbWVwYWdlQ29udGVudCh2bSkpOwogIHZtLmRhdGEuY29udGVudHMucHVzaChjcmVhdGVNb3JlcGFnZUNvbnRlbnQodm0pKTsKICB2bS5kYXRhLmNvbnRlbnRzLnB1c2goY3JlYXRlU2NyZWVuU2F2ZXJDb250ZW50KHZtKSk7CiAgdm0uZGF0YS5jb250ZW50cy5wdXNoKGNyZWF0ZVdhbGxwYXBhZXJDb250ZW50KHZtKSk7CiAgdm0uZGF0YS5jb250ZW50cy5wdXNoKGNyZWF0ZUJvb3RMb2dvQ29udGVudCh2bSkpOwp9CgpmdW5jdGlvbiBjcmVhdGVCb290TG9nb0NvbnRlbnQodm0pIHsKICBsZXQgY29udGVudCA9IHsKICAgIGtleTogImJvb3RMb2dvIiwKICAgIHRpdGxlOiB2bS4kdCgiQm9vdExvZ28iKSwKICAgIHRpdGxlRGVzY3JpcHRpb246IHZtLiR0KCJCb290TG9nbyIpLAogICAgaXRlbXM6IFsKICAgICAgewogICAgICAgIHRpdGxlOiB2bS4kdCgiQm9vdExvZ28iKSwKICAgICAgICB0eXBlOiAiZmlsZS1pbnB1dCIsCiAgICAgICAga2V5OiAiYm9vdExvZ29VcGxvYWQiLAogICAgICAgIGFjY2VwdEZpbGVUeXBlOiAiLnppcCwucG5nIiwKICAgICAgICBtb2RhbFRpdGxlOiB2bS4kdCgiQm9vdExvZ29Gb3JtYXQxMjgwIiksCiAgICAgICAgbG9hZGluZzogZmFsc2UsCiAgICAgICAgdmFsdWU6IHsKICAgICAgICAgIGZpbGVEYXRhOiB7fSwKICAgICAgICAgIGZpbGVOYW1lOiB2bS4kdCgiVXBncmFkZUZpbGVQYXRoIiksCiAgICAgICAgfSwKICAgICAgICBpbXBvcnRCdG5OYW1lOiB2bS4kdCgiSW1wb3J0IiksCiAgICAgICAgbW9kYWxDb25maXJtTmFtZTogdm0uJHQoIlVwbG9hZCIpLAogICAgICAgIGltZ1Jlc29sdXRpb25XaWR0aDogMTI4MCwKICAgICAgICBpbWdSZXNvbHV0aW9uSGVpZ2h0OiA4MDAsCiAgICAgICAgdXBsb2FkRnVuY3Rpb246IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHVwbG9hZEZpbGUodm0sICJib290TG9nbyIsICJib290TG9nb1VwbG9hZCIpOwogICAgICAgIH0sCiAgICAgICAgaXNTaG93RXhwb3J0OiB0cnVlLAogICAgICAgIGV4cG9ydEJ0bk5hbWU6IHZtLiR0KCJSZXNldCIpLAogICAgICAgIG9uRXhwb3J0OmZ1bmN0aW9uKCl7CiAgICAgICAgICBvbkRlbEZpbGUodm0sICIiLCJib290TG9nbyIsICJib290TG9nb1VwbG9hZCIpOwogICAgICAgIH0KICAgICAgfSwKICAgIF0sCiAgfTsKICByZXR1cm4gY29udGVudDsKfQoKZnVuY3Rpb24gY3JlYXRlV2FsbHBhcGFlckNvbnRlbnQodm0pIHsKICBsZXQgY29udGVudCA9IHsKICAgIGtleTogIndhbGxwYXBlciIsCiAgICB0aXRsZTogdm0uJHQoIldhbGxwYXBlciIpLAogICAgdGl0bGVEZXNjcmlwdGlvbjogdm0uJHQoIldhbGxwYXBlciIpLAogICAgaXRlbXM6IFsKICAgICAgewogICAgICAgIHRpdGxlOiB2bS4kdCgiV2FsbHBhcGVyIiksCiAgICAgICAgdHlwZTogImZpbGUtaW5wdXQiLAogICAgICAgIGtleTogIndhbGxwYXBlclVwbG9hZCIsCiAgICAgICAgYWNjZXB0RmlsZVR5cGU6ICIuanBnLC5qcGVnLC5wbmciLAogICAgICAgIG1vZGFsVGl0bGU6IHZtLiR0KCJXYWxscGFwZXJGb3JtYXQxMjgwIiksCiAgICAgICAgbG9hZGluZzogZmFsc2UsCiAgICAgICAgdmFsdWU6IHsKICAgICAgICAgIGZpbGVEYXRhOiB7fSwKICAgICAgICAgIGZpbGVOYW1lOiB2bS4kdCgiVXBncmFkZUZpbGVQYXRoIiksCiAgICAgICAgfSwKICAgICAgICBpbXBvcnRCdG5OYW1lOiB2bS4kdCgiSW1wb3J0IiksCiAgICAgICAgbW9kYWxDb25maXJtTmFtZTogdm0uJHQoIlVwbG9hZCIpLAogICAgICAgIGltZ1Jlc29sdXRpb25XaWR0aDogMTI4MCwKICAgICAgICBpbWdSZXNvbHV0aW9uSGVpZ2h0OiA4MDAsCiAgICAgICAgdXBsb2FkRnVuY3Rpb246IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHVwbG9hZEZpbGUodm0sICJ3YWxscGFwZXIiLCAid2FsbHBhcGVyVXBsb2FkIik7CiAgICAgICAgfSwKICAgICAgfSwKICAgICAgewogICAgICAgIHRpdGxlOiB2bS4kdCgiV2FsbHBhcGVyRmlsZXMiKSwKICAgICAgICB0eXBlOiAic2VsZWN0IiwKICAgICAgICBrZXk6ICJDb25maWcuU2V0dGluZ3MuTE9HTy5XYWxscGFwZXIiLAogICAgICAgIHZhbHVlOiB2bS5hcGlEYXRhLmNvbmZpZ0RhdGFbIkNvbmZpZy5TZXR0aW5ncy5MT0dPLldhbGxwYXBlciJdLAogICAgICAgIHNlbGVjdEl0ZW1zOiB2bS53YWxscGFwZXJGaWxlSXRlbXMsCiAgICAgICAgc2hvd0J0bjogdHJ1ZSwKICAgICAgICBvbkRlbDogZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgICAgICBvbkRlbEZpbGUodm0sIHZhbHVlLCAid2FsbHBhcGVyIiwgIndhbGxwYXBlckRlbCIpOwogICAgICAgIH0sCiAgICAgICAgbG9hZGluZzogZmFsc2UsCiAgICAgICAgZGVsRGlzYWJsZWQ6IGZhbHNlLAogICAgICB9LAogICAgXSwKICB9OwogIHJldHVybiBjb250ZW50Owp9CgpmdW5jdGlvbiBjcmVhdGVTY3JlZW5TYXZlckNvbnRlbnQodm0pIHsKICBsZXQgY29udGVudCA9IHsKICAgIGtleTogInNjcmVlblNhdmVyIiwKICAgIHRpdGxlOiB2bS4kdCgiU2NyZWVuU2F2ZXJTZXR0aW5nIiksCiAgICB0aXRsZURlc2NyaXB0aW9uOiB2bS4kdCgiU2NyZWVuU2F2ZXJTZXR0aW5nIiksCiAgICBpdGVtczogWwogICAgICB7CiAgICAgICAgdGl0bGU6IHZtLiR0KCJTY3JlZW5TYXZlclBpY3R1cmVzIiksCiAgICAgICAgdHlwZTogImZpbGUtaW5wdXQiLAogICAgICAgIGtleTogInNjcmVlblNhdmVyUGljdHVyZSIsCiAgICAgICAgYWNjZXB0RmlsZVR5cGU6ICIuanBnLC5wbmcsLmpwZWciLAogICAgICAgIG1vZGFsVGl0bGU6IHZtLiR0KCJTY3JlZW5TYXZlckZvcm1hdCIpLAogICAgICAgIGxvYWRpbmc6IGZhbHNlLAogICAgICAgIHZhbHVlOiB7CiAgICAgICAgICBmaWxlRGF0YToge30sCiAgICAgICAgICBmaWxlTmFtZTogdm0uJHQoIlVwZ3JhZGVGaWxlUGF0aCIpLAogICAgICAgIH0sCiAgICAgICAgaW1wb3J0QnRuTmFtZTogdm0uJHQoIkltcG9ydCIpLAogICAgICAgIG1vZGFsQ29uZmlybU5hbWU6IHZtLiR0KCJVcGxvYWQiKSwKICAgICAgICB1cGxvYWRGdW5jdGlvbjogZnVuY3Rpb24gKCkgewogICAgICAgICAgdXBsb2FkRmlsZSh2bSwgInNjcmVlblNhdmVyIiwgInNjcmVlblNhdmVyUGljdHVyZSIpOwogICAgICAgIH0sCiAgICAgICAgbWF4U2l6ZTogMiAqIDEwMjQgKiAxMDI0LAogICAgICB9LAogICAgICB7CiAgICAgICAgdGl0bGU6IHZtLiR0KCJTY3JlZW5TYXZlclZpZGVvcyIpLAogICAgICAgIGlzSGlkZTogdm0uYXBpRGF0YS5kYXRhLmhhc0FrRmFjZSA9PSAiIiwKICAgICAgICB0eXBlOiAiZmlsZS1pbnB1dCIsCiAgICAgICAga2V5OiAic2NyZWVuU2F2ZXJWaWRlbyIsCiAgICAgICAgYWNjZXB0RmlsZVR5cGU6ICIubXA0LC53bXYsLmF2aSIsCiAgICAgICAgbW9kYWxUaXRsZTogdm0uJHQoIlNjcmVlblNhdmVyVmlkZW9Gb3JtYXQiKSwKICAgICAgICBsb2FkaW5nOiBmYWxzZSwKICAgICAgICB2YWx1ZTogewogICAgICAgICAgZmlsZURhdGE6IHt9LAogICAgICAgICAgZmlsZU5hbWU6IHZtLiR0KCJVcGdyYWRlRmlsZVBhdGgiKSwKICAgICAgICB9LAogICAgICAgIGltcG9ydEJ0bk5hbWU6IHZtLiR0KCJJbXBvcnQiKSwKICAgICAgICBtb2RhbENvbmZpcm1OYW1lOiB2bS4kdCgiVXBsb2FkIiksCiAgICAgICAgdXBsb2FkRnVuY3Rpb246IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHVwbG9hZEZpbGUodm0sICJzY3JlZW5TYXZlciIsICJzY3JlZW5TYXZlclZpZGVvIik7CiAgICAgICAgfSwKICAgICAgICBtYXhTaXplOiA1MDAgKiAxMDI0ICogMTAyNCwKICAgICAgfSwKICAgICAgewogICAgICAgIHRpdGxlOiB2bS4kdCgiUGljdHVyZUZpbGVzIiksCiAgICAgICAgdHlwZTogInNlbGVjdCIsCiAgICAgICAga2V5OiAicGljdHVyZUZpbGUiLAogICAgICAgIHZhbHVlOgogICAgICAgICAgdm0uc2NyZWVuU2F2ZXJQaWN0dXJlSXRlbXMubGVuZ3RoID09IDAKICAgICAgICAgICAgPyAiIgogICAgICAgICAgICA6IHZtLnNjcmVlblNhdmVyUGljdHVyZUl0ZW1zWzBdLmtleSwKICAgICAgICBzZWxlY3RJdGVtczogdm0uc2NyZWVuU2F2ZXJQaWN0dXJlSXRlbXMsCiAgICAgICAgc2hvd0J0bjogdHJ1ZSwKICAgICAgICBvbkRlbDogZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgICAgICBvbkRlbEZpbGUodm0sIHZhbHVlLCAic2NyZWVuU2F2ZXIiLCAicGljdHVyZUZpbGUiKTsKICAgICAgICB9LAogICAgICAgIGxvYWRpbmc6IGZhbHNlLAogICAgICB9LAogICAgICB7CiAgICAgICAgdGl0bGU6IHZtLiR0KCJWaWRlb0ZpbGVzIiksCiAgICAgICAgaXNIaWRlOiB2bS5hcGlEYXRhLmRhdGEuaGFzQWtGYWNlID09ICIiLAogICAgICAgIHR5cGU6ICJzZWxlY3QiLAogICAgICAgIGtleTogInZpZGVvRmlsZSIsCiAgICAgICAgdmFsdWU6CiAgICAgICAgICB2bS5zY3JlZW5TYXZlclZpZGVvSXRlbXMubGVuZ3RoID09IDAKICAgICAgICAgICAgPyAiIgogICAgICAgICAgICA6IHZtLnNjcmVlblNhdmVyVmlkZW9JdGVtc1swXS5rZXksCiAgICAgICAgc2VsZWN0SXRlbXM6IHZtLnNjcmVlblNhdmVyVmlkZW9JdGVtcywKICAgICAgICBzaG93QnRuOiB0cnVlLAogICAgICAgIG9uRGVsOiBmdW5jdGlvbiAodmFsdWUpIHsKICAgICAgICAgIG9uRGVsRmlsZSh2bSwgdmFsdWUsICJzY3JlZW5TYXZlciIsICJ2aWRlb0ZpbGUiKTsKICAgICAgICB9LAogICAgICAgIGxvYWRpbmc6IGZhbHNlLAogICAgICB9LAogICAgICB7CiAgICAgICAgdGl0bGU6IHZtLiR0KCJTY3JlZW5TYXZlclR5cGUiKSwKICAgICAgICB0eXBlOiAic2VsZWN0IiwKICAgICAgICBrZXk6ICJDb25maWcuU2V0dGluZ3MuU0NSRUVOU0FWRVIuU2NyZWVzYXZlclR5cGUiLAogICAgICAgIHZhbHVlOgogICAgICAgICAgdm0uYXBpRGF0YS5jb25maWdEYXRhWyJDb25maWcuU2V0dGluZ3MuU0NSRUVOU0FWRVIuU2NyZWVzYXZlclR5cGUiXSwKICAgICAgICBzZWxlY3RJdGVtczogdm0uc2NyZWVuU2F2ZXJUeXBlSXRlbXMsCiAgICAgIH0sCiAgICBdLAogIH07CiAgcmV0dXJuIGNvbnRlbnQ7Cn0KCmZ1bmN0aW9uIGNyZWF0ZU1vcmVwYWdlQ29udGVudCh2bSkgewogIC8vdGFibGUgZGF0YQogIGxldCB0YWJsZURhdGEgPSBbXTsKICBmb3IgKGxldCBpID0gMDsgaSA8IHZtLmFwaURhdGEuZGF0YS5wYWdlMk51bTsgaSsrKSB7CiAgICBsZXQgaXRlbSA9IHsKICAgICAga2V5OiBpLAogICAgICBhcmVhOiB2bS4kdCgiQXJlYSIpICsgKGkgKyAxKSwKICAgICAgdHlwZTogewogICAgICAgIHZhbHVlOgogICAgICAgICAgdm0uYXBpRGF0YS5jb25maWdEYXRhWwogICAgICAgICAgICAiQ29uZmlnLkluZG9vci5QQUdFMkFSRUEiICsgKGkgKyAxKSArICIuRGlzcGxheVR5cGUiCiAgICAgICAgICBdLAogICAgICAgIGlzV2FybjogZmFsc2UsCiAgICAgICAgd2FybkxhYmVsOiB2bS4kdCgiUGxlYXNlQ2hlY2tNdWx0aXBsaWNpdHkiKSwKICAgICAgfSwKICAgICAgdmFsdWU6IHsKICAgICAgICB2YWx1ZToKICAgICAgICAgIHZtLmFwaURhdGEuY29uZmlnRGF0YVsiQ29uZmlnLkluZG9vci5QQUdFMkFSRUEiICsgKGkgKyAxKSArICIuVmFsdWUiXSwKICAgICAgICBpc1dhcm46IGZhbHNlLAogICAgICAgIHdhcm5MYWJlbDogIiIsCiAgICAgICAgZGlzYWJsZWQ6IHRydWUsCiAgICAgICAgaXRlbVR5cGU6ICJpbnB1dCIsCiAgICAgIH0sCiAgICAgIGxhYmVsOiB7CiAgICAgICAgdmFsdWU6CiAgICAgICAgICB2bS5hcGlEYXRhLmNvbmZpZ0RhdGFbIkNvbmZpZy5JbmRvb3IuUEFHRTJBUkVBIiArIChpICsgMSkgKyAiLkxBQkVMIl0sCiAgICAgICAgaXNXYXJuOiBmYWxzZSwKICAgICAgICB3YXJuTGFiZWw6ICIiLAogICAgICAgIGRpc2FibGVkOiBmYWxzZSwKICAgICAgfSwKICAgICAgaWNvbjogewogICAgICAgIGZpbGVEYXRhOiB7fSwKICAgICAgICBmaWxlTmFtZTogdm0uJHQoIlVwZ3JhZGVGaWxlUGF0aCIpLAogICAgICAgIGlzU2hvdzogdHJ1ZSwKICAgICAgfSwKICAgIH07CiAgICB0YWJsZURhdGEucHVzaChpdGVtKTsKICB9CiAgLy9jb250ZW50CiAgbGV0IGNvbnRlbnQgPSB7CiAgICBrZXk6ICJtb3JlcGFnZSIsCiAgICB0aXRsZTogdm0uJHQoIlBhZ2UyRGlzcGxheSIpLAogICAgdGl0bGVEZXNjcmlwdGlvbjogdm0uJHQoIlBhZ2UyRGlzcGxheSIpLAogICAgc2hvd0V4YW1wbGU6IHRydWUsCiAgICBpbWdOYW1lOiAiaG9tZV9wYWdlLmpwZyIsCiAgICBpdGVtczogWwogICAgICB7CiAgICAgICAgdHlwZTogInRhYmxlIiwKICAgICAgICBrZXk6ICJtb3JlcGFnZSIsCiAgICAgICAgdGFibGVEYXRhOiB0YWJsZURhdGEsCiAgICAgICAgdGFibGVDb2x1bW5zOiBbCiAgICAgICAgICB7CiAgICAgICAgICAgIHR5cGU6ICJsYWJlbCIsCiAgICAgICAgICAgIHRpdGxlOiB2bS4kdCgiQXJlYSIpLAogICAgICAgICAgICBkYXRhSW5kZXg6ICJhcmVhIiwKICAgICAgICAgICAgc2NvcGVkU2xvdHM6IHsgY3VzdG9tUmVuZGVyOiAiYXJlYSIgfSwKICAgICAgICAgICAgYWxpZ246ICJjZW50ZXIiLAogICAgICAgICAgICB3aWR0aDogIjExJSIsCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICB0eXBlOiAic2VsZWN0IiwKICAgICAgICAgICAgdGl0bGU6IHZtLiR0KCJUeXBlIiksCiAgICAgICAgICAgIGRhdGFJbmRleDogInR5cGUiLAogICAgICAgICAgICBzY29wZWRTbG90czogeyBjdXN0b21SZW5kZXI6ICJ0eXBlIiB9LAogICAgICAgICAgICBzZWxlY3RJdGVtczogdm0udHlwZUl0ZW1zLAogICAgICAgICAgICBhbGlnbjogImNlbnRlciIsCiAgICAgICAgICAgIHdpZHRoOiAiMTglIiwKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIHR5cGU6ICJpbnB1dCIsCiAgICAgICAgICAgIHRpdGxlOiB2bS4kdCgiVmFsdWUiKSwKICAgICAgICAgICAgZGF0YUluZGV4OiAidmFsdWUiLAogICAgICAgICAgICBzY29wZWRTbG90czogeyBjdXN0b21SZW5kZXI6ICJ2YWx1ZSIgfSwKICAgICAgICAgICAgYWxpZ246ICJjZW50ZXIiLAogICAgICAgICAgICB3aWR0aDogIjE4JSIsCiAgICAgICAgICAgIG1heExlbmd0aDogMTI3LAogICAgICAgICAgICBzZWxlY3RJdGVtczogdm0uYXBwU2VsZWN0SXRlbXMsCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICB0eXBlOiAiaW5wdXQiLAogICAgICAgICAgICB0aXRsZTogdm0uJHQoIkxhYmVsIiksCiAgICAgICAgICAgIGRhdGFJbmRleDogImxhYmVsIiwKICAgICAgICAgICAgc2NvcGVkU2xvdHM6IHsgY3VzdG9tUmVuZGVyOiAibGFiZWwiIH0sCiAgICAgICAgICAgIGFsaWduOiAiY2VudGVyIiwKICAgICAgICAgICAgd2lkdGg6ICIxOCUiLAogICAgICAgICAgICBtYXhMZW5ndGg6IDEyNywKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIHR5cGU6ICJmaWxlLWlucHV0IiwKICAgICAgICAgICAgdGl0bGU6IHZtLiR0KCJJY29uTGFiZWwiKSArICIoIiArIHZtLiR0KCJNYXhJY29uU2l6ZSIpICsgIjo1MCo1MCkiLAogICAgICAgICAgICBkYXRhSW5kZXg6ICJpY29uIiwKICAgICAgICAgICAgc2NvcGVkU2xvdHM6IHsgY3VzdG9tUmVuZGVyOiAiaWNvbiIgfSwKICAgICAgICAgICAgYWxpZ246ICJjZW50ZXIiLAogICAgICAgICAgICB3aWR0aDogIjM1JSIsCiAgICAgICAgICAgIGJ0bk5hbWU6IHZtLiR0KCJEZWxldGVMYWJlbCIpLAogICAgICAgICAgICBhY2NlcHRGaWxlVHlwZTogIi5qcGcsLnBuZywuanBlZyIsCiAgICAgICAgICAgIHVwbG9hZDogZnVuY3Rpb24gKGZpbGVEYXRhLCBpbmRleCkgewogICAgICAgICAgICAgIHJldHVybiB1cGxvYWRJY29uKGZpbGVEYXRhLCBpbmRleCwgdm0pOwogICAgICAgICAgICB9LAogICAgICAgICAgfSwKICAgICAgICBdLAogICAgICB9LAogICAgXSwKICB9OwogIHJldHVybiBjb250ZW50Owp9CgpmdW5jdGlvbiBjcmVhdGVIb21lcGFnZUNvbnRlbnQodm0pIHsKICAvL2RhdGEKICBsZXQgdGFibGVEYXRhID0gW107CiAgZm9yIChsZXQgaSA9IDA7IGkgPCB2bS5hcGlEYXRhLmRhdGEucGFnZTFOdW07IGkrKykgewogICAgbGV0IGl0ZW0gPSB7CiAgICAgIGtleTogaSwKICAgICAgYXJlYTogdm0uJHQoIkFyZWEiKSArIChpICsgMSksCiAgICAgIHR5cGU6IHsKICAgICAgICB2YWx1ZToKICAgICAgICAgIHZtLmFwaURhdGEuY29uZmlnRGF0YVsKICAgICAgICAgICAgIkNvbmZpZy5JbmRvb3IuUEFHRTFBUkVBIiArIChpICsgMSkgKyAiLkRpc3BsYXlUeXBlIgogICAgICAgICAgXSwKICAgICAgICBpc1dhcm46IGZhbHNlLAogICAgICAgIHdhcm5MYWJlbDogdm0uJHQoIlBsZWFzZUNoZWNrTXVsdGlwbGljaXR5IiksCiAgICAgIH0sCiAgICAgIHZhbHVlOiB7CiAgICAgICAgdmFsdWU6CiAgICAgICAgICB2bS5hcGlEYXRhLmNvbmZpZ0RhdGFbIkNvbmZpZy5JbmRvb3IuUEFHRTFBUkVBIiArIChpICsgMSkgKyAiLlZhbHVlIl0sCiAgICAgICAgaXNXYXJuOiBmYWxzZSwKICAgICAgICB3YXJuTGFiZWw6ICIiLAogICAgICAgIGRpc2FibGVkOiB0cnVlLAogICAgICAgIGl0ZW1UeXBlOiAiaW5wdXQiLAogICAgICB9LAogICAgICBsYWJlbDogewogICAgICAgIHZhbHVlOgogICAgICAgICAgdm0uYXBpRGF0YS5jb25maWdEYXRhWyJDb25maWcuSW5kb29yLlBBR0UxQVJFQSIgKyAoaSArIDEpICsgIi5MQUJFTCJdLAogICAgICAgIGlzV2FybjogZmFsc2UsCiAgICAgICAgd2FybkxhYmVsOiAiIiwKICAgICAgICBkaXNhYmxlZDogZmFsc2UsCiAgICAgIH0sCiAgICAgIGljb246IHsKICAgICAgICBmaWxlRGF0YToge30sCiAgICAgICAgZmlsZU5hbWU6IHZtLiR0KCJVcGdyYWRlRmlsZVBhdGgiKSwKICAgICAgICBpc1Nob3c6IHRydWUsCiAgICAgIH0sCiAgICB9OwogICAgdGFibGVEYXRhLnB1c2goaXRlbSk7CiAgfQogIC8vY29udGVudAogIGxldCBjb250ZW50ID0gewogICAga2V5OiAiaG9tZXBhZ2UiLAogICAgdGl0bGU6IHZtLiR0KCJQYWdlMURpc3BsYXkiKSwKICAgIHRpdGxlRGVzY3JpcHRpb246IHZtLiR0KCJQYWdlMURpc3BsYXkiKSwKICAgIHNob3dFeGFtcGxlOiB0cnVlLAogICAgaW1nTmFtZTogImhvbWVfcGFnZS5qcGciLAogICAgaXRlbXM6IFsKICAgICAgewogICAgICAgIHR5cGU6ICJ0YWJsZSIsCiAgICAgICAga2V5OiAiaG9tZXBhZ2UiLAogICAgICAgIHRhYmxlRGF0YTogdGFibGVEYXRhLAogICAgICAgIHRhYmxlQ29sdW1uczogWwogICAgICAgICAgewogICAgICAgICAgICB0eXBlOiAibGFiZWwiLAogICAgICAgICAgICB0aXRsZTogdm0uJHQoIkFyZWEiKSwKICAgICAgICAgICAgZGF0YUluZGV4OiAiYXJlYSIsCiAgICAgICAgICAgIHNjb3BlZFNsb3RzOiB7IGN1c3RvbVJlbmRlcjogImFyZWEiIH0sCiAgICAgICAgICAgIGFsaWduOiAiY2VudGVyIiwKICAgICAgICAgICAgd2lkdGg6ICIxMSUiLAogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgdHlwZTogInNlbGVjdCIsCiAgICAgICAgICAgIHRpdGxlOiB2bS4kdCgiVHlwZSIpLAogICAgICAgICAgICBkYXRhSW5kZXg6ICJ0eXBlIiwKICAgICAgICAgICAgc2NvcGVkU2xvdHM6IHsgY3VzdG9tUmVuZGVyOiAidHlwZSIgfSwKICAgICAgICAgICAgc2VsZWN0SXRlbXM6IHZtLnR5cGVJdGVtcywKICAgICAgICAgICAgYWxpZ246ICJjZW50ZXIiLAogICAgICAgICAgICB3aWR0aDogIjE4JSIsCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICB0eXBlOiAiaW5wdXQiLAogICAgICAgICAgICB0aXRsZTogdm0uJHQoIlZhbHVlIiksCiAgICAgICAgICAgIGRhdGFJbmRleDogInZhbHVlIiwKICAgICAgICAgICAgc2NvcGVkU2xvdHM6IHsgY3VzdG9tUmVuZGVyOiAidmFsdWUiIH0sCiAgICAgICAgICAgIGFsaWduOiAiY2VudGVyIiwKICAgICAgICAgICAgd2lkdGg6ICIxOCUiLAogICAgICAgICAgICBtYXhMZW5ndGg6IDEyNywKICAgICAgICAgICAgc2VsZWN0SXRlbXM6IHZtLmFwcFNlbGVjdEl0ZW1zLAogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgdHlwZTogImlucHV0IiwKICAgICAgICAgICAgdGl0bGU6IHZtLiR0KCJMYWJlbCIpLAogICAgICAgICAgICBkYXRhSW5kZXg6ICJsYWJlbCIsCiAgICAgICAgICAgIHNjb3BlZFNsb3RzOiB7IGN1c3RvbVJlbmRlcjogImxhYmVsIiB9LAogICAgICAgICAgICBhbGlnbjogImNlbnRlciIsCiAgICAgICAgICAgIHdpZHRoOiAiMTglIiwKICAgICAgICAgICAgbWF4TGVuZ3RoOiAxMjcsCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICB0eXBlOiAiZmlsZS1pbnB1dCIsCiAgICAgICAgICAgIHRpdGxlOiB2bS4kdCgiSWNvbkxhYmVsIikgKyAiKCIgKyB2bS4kdCgiTWF4SWNvblNpemUiKSArICI6NTAqNTApIiwKICAgICAgICAgICAgZGF0YUluZGV4OiAiaWNvbiIsCiAgICAgICAgICAgIHNjb3BlZFNsb3RzOiB7IGN1c3RvbVJlbmRlcjogImljb24iIH0sCiAgICAgICAgICAgIGFsaWduOiAiY2VudGVyIiwKICAgICAgICAgICAgd2lkdGg6ICIzNSUiLAogICAgICAgICAgICBidG5OYW1lOiB2bS4kdCgiRGVsZXRlTGFiZWwiKSwKICAgICAgICAgICAgYWNjZXB0RmlsZVR5cGU6ICIuanBnLC5wbmcsLmpwZWciLAogICAgICAgICAgICB1cGxvYWQ6IGZ1bmN0aW9uIChmaWxlRGF0YSwgaW5kZXgpIHsKICAgICAgICAgICAgICByZXR1cm4gdXBsb2FkSWNvbihmaWxlRGF0YSwgaW5kZXgsIHZtKTsKICAgICAgICAgICAgfSwKICAgICAgICAgIH0sCiAgICAgICAgXSwKICAgICAgfSwKICAgIF0sCiAgfTsKICByZXR1cm4gY29udGVudDsKfQoKZnVuY3Rpb24gdXBsb2FkSWNvbihmaWxlRGF0YSwgaW5kZXgsIHZtKSB7CiAgbGV0IGZpbGVOYW1lID0gZmlsZURhdGEubmFtZTsKICBpZiAoZmlsZU5hbWUgPT0gIiIgfHwgZmlsZU5hbWUgPT0gdm0uJHQoIlVwZ3JhZGVGaWxlUGF0aCIpKSB7CiAgICByZXR1cm47CiAgfQoKICAvL+ehruiupOWbvueJh+WIhui+qOeOhwogIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpOwogIHJlYWRlci5yZWFkQXNEYXRhVVJMKGZpbGVEYXRhKTsKICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24gKCkgewogICAgdmFyIGltZyA9IG5ldyBJbWFnZSgpOwogICAgaW1nLnNyYyA9IHJlYWRlci5yZXN1bHQ7CiAgICBpbWcub25sb2FkID0gZnVuY3Rpb24gKCkgewogICAgICAvL+WIhui+qOeOh+i2heWHugogICAgICBpZiAoaW1nLndpZHRoID4gNTAgfHwgaW1nLmhlaWdodCA+IDUwKSB7CiAgICAgICAgc2hvd0Vycm9ySW5mbyh2bSwgdm0uJHQoIkltYWdlUmVzb2x1dGlvbkVyciIpKTsKICAgICAgICBsZXQgaXRlbSA9IGdldEl0ZW1CeUtleSh2bS5kYXRhLCAiaG9tZXBhZ2UiLCAiaG9tZXBhZ2UiKTsKICAgICAgICBpdGVtLnRhYmxlRGF0YVtpbmRleF0uaWNvbiA9IHsKICAgICAgICAgIGZpbGVEYXRhOiB7fSwKICAgICAgICAgIGZpbGVOYW1lOiB2bS4kdCgiVXBncmFkZUZpbGVQYXRoIiksCiAgICAgICAgfTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgLy/mraPluLjkuIrkvKAKICAgICAgY29uc3QgdXBEYXRhID0gbmV3IEZvcm1EYXRhKCk7CiAgICAgIHVwRGF0YS5hcHBlbmQoImZpbGUiLCBmaWxlRGF0YSk7CiAgICAgIGF4aW9zCiAgICAgICAgLnBvc3QoImFwaS9waG9uZURpc3BsYXlTZXR0aW5nL3VwbG9hZD90eXBlPWFyZWFJY29uIiwgdXBEYXRhLCB7CiAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICJDb250ZW50LVR5cGUiOiAibXVsdGlwYXJ0L2Zvcm0tZGF0YSIsCiAgICAgICAgICB9LAogICAgICAgIH0pCiAgICAgICAgLnRoZW4oKHJlcykgPT4ge30pOwogICAgfTsKICAgIGltZy5vbmVycm9yID0gZnVuY3Rpb24gKCkgewogICAgICAvL+WbvueJh+WKoOi9vemUmeivrwogICAgICBzaG93RXJyb3JJbmZvKHZtLCB2bS4kdCgiRmlsZUZvcm1hdFdhcm5pbmciKSk7CiAgICAgIGxldCBpdGVtID0gZ2V0SXRlbUJ5S2V5KHZtLmRhdGEsICJob21lcGFnZSIsICJob21lcGFnZSIpOwogICAgICBpdGVtLnRhYmxlRGF0YVtpbmRleF0uaWNvbiA9IHsKICAgICAgICBmaWxlRGF0YToge30sCiAgICAgICAgZmlsZU5hbWU6IHZtLiR0KCJVcGdyYWRlRmlsZVBhdGgiKSwKICAgICAgfTsKICAgIH07CiAgfTsKfQoKZnVuY3Rpb24gdXBsb2FkRmlsZSh2bSwgY29udGVudEtleSwgaXRlbUtleSkgewogIGxldCBpdGVtID0gZ2V0SXRlbUJ5S2V5KHZtLmRhdGEsIGNvbnRlbnRLZXksIGl0ZW1LZXkpOwogIGxldCBmaWxlTmFtZSA9IGl0ZW0udmFsdWUuZmlsZU5hbWU7CiAgaWYgKGZpbGVOYW1lID09ICIiIHx8IGZpbGVOYW1lID09IHZtLiR0KCJVcGdyYWRlRmlsZVBhdGgiKSkgewogICAgcmV0dXJuOwogIH0KICBsZXQgY29uZmlybVRleHQgPSB2bS4kdCgiSW1wb3J0V2FsbHBhcGVyV2FybmluZyIpOwogIGlmIChjb250ZW50S2V5ID09ICJzY3JlZW5TYXZlciIpIHsKICAgIGNvbmZpcm1UZXh0ID0gdm0uJHQoIkltcG9ydFNjcmVlblNhdmVyV2FybmluZyIpOwogIH0gZWxzZSBpZiAoY29udGVudEtleSA9PSAiYm9vdExvZ28iKSB7CiAgICBjb25maXJtVGV4dCA9IHZtLiR0KCJVcGxvYWRMb2dvV2FybmluZyIpOwogIH0KICBpZiAoY29uZmlybShjb25maXJtVGV4dCkpIHsKICAgIC8v5LiK5LygCiAgICBpdGVtLmxvYWRpbmcgPSB0cnVlOwogICAgY29uc3QgdXBEYXRhID0gbmV3IEZvcm1EYXRhKCk7CiAgICB1cERhdGEuYXBwZW5kKCJmaWxlIiwgaXRlbS52YWx1ZS5maWxlRGF0YSk7CiAgICBsZXQgYXBpVXJsID0gImFwaS9waG9uZURpc3BsYXlTZXR0aW5nL3VwbG9hZD90eXBlPSIgKyBpdGVtS2V5OwogICAgaWYgKGl0ZW1LZXkgPT0gImJvb3RMb2dvVXBsb2FkIikgewogICAgICBhcGlVcmwgKz0KICAgICAgICAiJndpZHRoPSIgKwogICAgICAgIGl0ZW0udmFsdWUuZmlsZURhdGEud2lkdGggKwogICAgICAgICImaGVpZ2h0PSIgKwogICAgICAgIGl0ZW0udmFsdWUuZmlsZURhdGEuaGVpZ2h0OwogICAgfQogICAgYXhpb3MKICAgICAgLnBvc3QoYXBpVXJsLCB1cERhdGEsIHsKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAiQ29udGVudC1UeXBlIjogIm11bHRpcGFydC9mb3JtLWRhdGEiLAogICAgICAgIH0sCiAgICAgIH0pCiAgICAgIC50aGVuKChyZXMpID0+IHsKICAgICAgICBpZiAocmVzLmRhdGEucmV0Y29kZSA9PSAtMSkgewogICAgICAgICAgc2hvd0Vycm9ySW5mbyh2bSwgdm0uJHQoIkZpbGVVcGxvYWRGYWlsZWRXYXJuaW5nIikpOwogICAgICAgIH0gZWxzZSBpZiAocmVzLmRhdGEucmV0Y29kZSA9PSAwKSB7CiAgICAgICAgICBnZXREYXRhKHZtKTsKICAgICAgICAgIHNob3dSZXF1ZXN0U3VjY2Vzcyh2bSwgdm0uJHQoIlVwbG9hZEZpbGVGaW5pc2hlZCIpKTsKICAgICAgICAgIGl0ZW0udmFsdWUuZmlsZU5hbWUgPSB2bS4kdCgiVXBncmFkZUZpbGVQYXRoIik7CiAgICAgICAgICBpdGVtLnZhbHVlLmZpbGVEYXRhID0ge307CiAgICAgICAgfQogICAgICAgIGl0ZW0ubG9hZGluZyA9IGZhbHNlOwogICAgICB9KTsKICB9Cn0KCmZ1bmN0aW9uIG9uRGVsRmlsZSh2bSwgdmFsdWUsIGNvbnRlbnRLZXksIGl0ZW1LZXkpIHsKICBsZXQgcmVhbEl0ZW1LZXkgPQogICAgaXRlbUtleSA9PSAid2FsbHBhcGVyRGVsIiA/ICJDb25maWcuU2V0dGluZ3MuTE9HTy5XYWxscGFwZXIiIDogaXRlbUtleTsKICBsZXQgcmVxdWVzdERhdGEgPSB7CiAgICB0YXJnZXQ6ICJwaG9uZURpc3BsYXlTZXR0aW5nIiwKICAgIGFjdGlvbjogImRlbCIsCiAgICBkYXRhOiB7CiAgICAgIGZpbGVOYW1lOiB2YWx1ZSwKICAgICAgdHlwZTogaXRlbUtleSwKICAgIH0sCiAgfTsKICBpZihpdGVtS2V5ID09ICJib290TG9nb1VwbG9hZCIpewogICAgaWYoIWNvbmZpcm0odm0uJHQoIkRlbGV0ZUxvZ29Db25maXJtIikpKXsKICAgICAgcmV0dXJuIDsKICAgIH0KICB9CiAgZ2V0SXRlbUJ5S2V5KHZtLmRhdGEsIGNvbnRlbnRLZXksIHJlYWxJdGVtS2V5KS5sb2FkaW5nID0gdHJ1ZTsKICB2bS4kYXhpb3MucG9zdCgiYXBpIiwgcmVxdWVzdERhdGEpLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICBnZXRJdGVtQnlLZXkodm0uZGF0YSwgY29udGVudEtleSwgcmVhbEl0ZW1LZXkpLmxvYWRpbmcgPSBmYWxzZTsKICAgIGdldERhdGEodm0pOwogICAgc2hvd1JlcXVlc3RTdWNjZXNzKHZtKTsKICB9KTsKfQo="},null]}