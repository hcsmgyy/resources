{"remainingRequest":"/workspace3/minjie.chen/gitlab-work/advance-indoor/resources/www/MODELESS/NORMAL/htdocs/node_modules/babel-loader/lib/index.js!/workspace3/minjie.chen/gitlab-work/advance-indoor/resources/www/MODELESS/NORMAL/htdocs/src/plugins/axios.js","dependencies":[{"path":"/workspace3/minjie.chen/gitlab-work/advance-indoor/resources/www/MODELESS/NORMAL/htdocs/src/plugins/axios.js","mtime":1600155105014},{"path":"/workspace3/minjie.chen/gitlab-work/advance-indoor/resources/www/MODELESS/NORMAL/htdocs/node_modules/cache-loader/dist/cjs.js","mtime":1600155105894},{"path":"/workspace3/minjie.chen/gitlab-work/advance-indoor/resources/www/MODELESS/NORMAL/htdocs/node_modules/babel-loader/lib/index.js","mtime":1600155105338}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5kZXgtb2YiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLnRvLXN0cmluZyI7CmltcG9ydCBfdHlwZW9mIGZyb20gIi93b3Jrc3BhY2UzL21pbmppZS5jaGVuL2dpdGxhYi13b3JrL2FkdmFuY2UtaW5kb29yL3Jlc291cmNlcy93d3cvTU9ERUxFU1MvTk9STUFML2h0ZG9jcy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vdHlwZW9mIjsKaW1wb3J0IFZ1ZSBmcm9tICd2dWUnOwppbXBvcnQgYXhpb3MgZnJvbSAiYXhpb3MiOwppbXBvcnQgeyBfIH0gZnJvbSAnY29yZS1qcyc7CmltcG9ydCB7IGdldENvb2tpZSB9IGZyb20gIkAvanMvY29va2llUHJvY2Vzcy5qcyI7CnZhciBjb25maWcgPSB7CiAgLy8gYmFzZVVSTDogcHJvY2Vzcy5lbnYuYmFzZVVSTCB8fCBwcm9jZXNzLmVudi5hcGlVcmwgfHwgIiIKICB0aW1lb3V0OiAxMjAgKiAxMDAwIC8vIFRpbWVvdXQKICAvLyB3aXRoQ3JlZGVudGlhbHM6IHRydWUsIC8vIENoZWNrIGNyb3NzLXNpdGUgQWNjZXNzLUNvbnRyb2wKCn07Cgp2YXIgX2F4aW9zID0gYXhpb3MuY3JlYXRlKGNvbmZpZyk7CgpfYXhpb3MuaW50ZXJjZXB0b3JzLnJlcXVlc3QudXNlKGZ1bmN0aW9uIChjb25maWcpIHsKICBjaGFuZ2VUeXBlVG9TdHJpbmcoY29uZmlnKTsKICBzZXRUb2tlbihjb25maWcpOwogIHJldHVybiBjb25maWc7Cn0sIGZ1bmN0aW9uIChlcnJvcikgewogIC8vIERvIHNvbWV0aGluZyB3aXRoIHJlcXVlc3QgZXJyb3IKICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpOwp9KTsgLy8gQWRkIGEgcmVzcG9uc2UgaW50ZXJjZXB0b3IKCgpfYXhpb3MuaW50ZXJjZXB0b3JzLnJlc3BvbnNlLnVzZShmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAvLyBEbyBzb21ldGhpbmcgd2l0aCByZXNwb25zZSBkYXRhCiAgaWYgKHJlc3BvbnNlLmRhdGEucmV0Y29kZSA9PSAtMTAwKSB7CiAgICAvL+acqueZu+W9le+8jOmHjeWumuWQkeWbnueZu+mZhumhtemdogogICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSAnLyc7CiAgICByZXR1cm47CiAgfQoKICByZXR1cm4gcmVzcG9uc2U7IC8vIHJldHVybiByZXNwb25zZTsKfSwgZnVuY3Rpb24gKGVycm9yKSB7CiAgLy8gRG8gc29tZXRoaW5nIHdpdGggcmVzcG9uc2UgZXJyb3IKICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpOwp9KTsKClBsdWdpbi5pbnN0YWxsID0gZnVuY3Rpb24gKFZ1ZSwgb3B0aW9ucykgewogIFZ1ZS5heGlvcyA9IF9heGlvczsKICB3aW5kb3cuYXhpb3MgPSBfYXhpb3M7CiAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoVnVlLnByb3RvdHlwZSwgewogICAgYXhpb3M6IHsKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgcmV0dXJuIF9heGlvczsKICAgICAgfQogICAgfSwKICAgICRheGlvczogewogICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICByZXR1cm4gX2F4aW9zOwogICAgICB9CiAgICB9CiAgfSk7Cn07CgpWdWUudXNlKFBsdWdpbik7CmV4cG9ydCBkZWZhdWx0IFBsdWdpbjsgLy/lsIZkYXRh5a+56LGh5pWw5o2u5YWo6YOo6L2s5o2i5Li6c3RyaW5n57G75Z6LCgpmdW5jdGlvbiBjaGFuZ2VUeXBlVG9TdHJpbmcoY29uZmlnKSB7CiAgaWYgKGNvbmZpZy5tZXRob2QgIT0gInBvc3QiKSB7CiAgICByZXR1cm47CiAgfQoKICBpZiAoY29uZmlnLmRhdGEuaGFzT3duUHJvcGVydHkoJ2NvbmZpZ0RhdGEnKSkgewogICAgZm9yICh2YXIgdmFsIGluIGNvbmZpZy5kYXRhLmNvbmZpZ0RhdGEpIHsKICAgICAgaWYgKHR5cGVvZiBjb25maWcuZGF0YS5jb25maWdEYXRhW3ZhbF0gPT09ICJudW1iZXIiKSB7CiAgICAgICAgY29uZmlnLmRhdGEuY29uZmlnRGF0YVt2YWxdID0gY29uZmlnLmRhdGEuY29uZmlnRGF0YVt2YWxdLnRvU3RyaW5nKCk7CiAgICAgIH0KICAgIH0KICB9CgogIGlmIChjb25maWcuZGF0YS5oYXNPd25Qcm9wZXJ0eSgnZGF0YScpKSB7CiAgICBmb3IgKHZhciB2YWwgaW4gY29uZmlnLmRhdGEuZGF0YSkgewogICAgICBpZiAodHlwZW9mIGNvbmZpZy5kYXRhLmRhdGFbdmFsXSA9PT0gIm51bWJlciIpIHsKICAgICAgICBjb25maWcuZGF0YS5kYXRhW3ZhbF0gPSBjb25maWcuZGF0YS5kYXRhW3ZhbF0udG9TdHJpbmcoKTsKICAgICAgfSBlbHNlIGlmIChfdHlwZW9mKGNvbmZpZy5kYXRhLmRhdGFbdmFsXSkgPT09ICJvYmplY3QiKSB7CiAgICAgICAgc2V0T2JqZWN0VG9TdHJpbmcoY29uZmlnLmRhdGEuZGF0YVt2YWxdKTsKICAgICAgfQogICAgfQogIH0KfQoKZnVuY3Rpb24gc2V0T2JqZWN0VG9TdHJpbmcob2JqZWN0KSB7CiAgZm9yICh2YXIgdmFsIGluIG9iamVjdCkgewogICAgaWYgKHR5cGVvZiBvYmplY3RbdmFsXSA9PT0gIm51bWJlciIpIHsKICAgICAgb2JqZWN0W3ZhbF0gPSBvYmplY3RbdmFsXS50b1N0cmluZygpOwogICAgfSBlbHNlIGlmIChfdHlwZW9mKG9iamVjdFt2YWxdKSA9PT0gIm9iamVjdCIpIHsKICAgICAgc2V0T2JqZWN0VG9TdHJpbmcob2JqZWN0W3ZhbF0pOwogICAgfQogIH0KfSAvL+S4uuaJgOacieivt+axguW4puS4inRva2Vu5pWw5o2uCgoKZnVuY3Rpb24gc2V0VG9rZW4oY29uZmlnKSB7CiAgaWYgKGNvbmZpZy5tZXRob2QgPT0gImdldCIpIHsKICAgIGlmIChjb25maWcudXJsLmluZGV4T2YoIj8iKSAhPSAtMSkgewogICAgICBjb25maWcudXJsICs9ICImc2Vzc2lvbj0iICsgZ2V0Q29va2llKCJ0b2tlbiIpOwogICAgfSBlbHNlIHsKICAgICAgY29uZmlnLnVybCArPSAiP3Nlc3Npb249IiArIGdldENvb2tpZSgidG9rZW4iKTsKICAgIH0KICB9IGVsc2UgewogICAgaWYgKCJ1bmRlZmluZWQiID09IHR5cGVvZiBjb25maWcuZGF0YSkgewogICAgICBjb25maWcuZGF0YSA9IHsKICAgICAgICBzZXNzaW9uOiBnZXRDb29raWUoInRva2VuIikKICAgICAgfTsKICAgIH0gZWxzZSB7CiAgICAgIGNvbmZpZy5kYXRhLnNlc3Npb24gPSBnZXRDb29raWUoInRva2VuIik7CiAgICB9CiAgfQp9"},{"version":3,"sources":["/workspace3/minjie.chen/gitlab-work/advance-indoor/resources/www/MODELESS/NORMAL/htdocs/src/plugins/axios.js"],"names":["Vue","axios","_","getCookie","config","timeout","_axios","create","interceptors","request","use","changeTypeToString","setToken","error","Promise","reject","response","data","retcode","window","location","href","Plugin","install","options","Object","defineProperties","prototype","get","$axios","method","hasOwnProperty","val","configData","toString","setObjectToString","object","url","indexOf","session"],"mappings":"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","sourcesContent":["\"use strict\";\n\nimport Vue from 'vue';\nimport axios from \"axios\";\nimport { _ } from 'core-js';\n\nimport { getCookie } from \"@/js/cookieProcess.js\";\n\nlet config = {\n  // baseURL: process.env.baseURL || process.env.apiUrl || \"\"\n  timeout: 120 * 1000, // Timeout\n  // withCredentials: true, // Check cross-site Access-Control\n};\n\nconst _axios = axios.create(config);\n\n_axios.interceptors.request.use(\n  function (config) {\n    changeTypeToString(config);\n    setToken(config);\n    return config;\n  },\n  function (error) {\n    // Do something with request error\n    return Promise.reject(error);\n  }\n);\n\n// Add a response interceptor\n_axios.interceptors.response.use(\n  function (response) {\n    // Do something with response data\n    if (response.data.retcode == -100) {\n      //未登录，重定向回登陆页面\n      window.location.href = '/';\n      return;\n    }\n    return response;\n    // return response;\n  },\n  function (error) {\n    // Do something with response error\n    return Promise.reject(error);\n  }\n);\n\nPlugin.install = function (Vue, options) {\n  Vue.axios = _axios;\n  window.axios = _axios;\n  Object.defineProperties(Vue.prototype, {\n    axios: {\n      get() {\n        return _axios;\n      }\n    },\n    $axios: {\n      get() {\n        return _axios;\n      }\n    },\n  });\n};\n\nVue.use(Plugin)\n\nexport default Plugin;\n\n\n//将data对象数据全部转换为string类型\nfunction changeTypeToString(config) {\n  if (config.method != \"post\") {\n    return;\n  }\n  if (config.data.hasOwnProperty('configData')) {\n    for (var val in config.data.configData) {\n      if (typeof config.data.configData[val] === \"number\") {\n        config.data.configData[val] = config.data.configData[val].toString();\n      }\n    }\n  }\n  if (config.data.hasOwnProperty('data')) {\n    for (var val in config.data.data) {\n      if (typeof config.data.data[val] === \"number\") {\n        config.data.data[val] = config.data.data[val].toString();\n      } else if (typeof config.data.data[val] === \"object\") {\n        setObjectToString(config.data.data[val]);\n      }\n    }\n  }\n}\n\nfunction setObjectToString(object) {\n  for (var val in object) {\n    if (typeof object[val] === \"number\") {\n      object[val] = object[val].toString();\n    } else if (typeof object[val] === \"object\") {\n      setObjectToString(object[val]);\n    }\n  }\n}\n\n//为所有请求带上token数据\nfunction setToken(config) {\n  if (config.method == \"get\") {\n    if (config.url.indexOf(\"?\") != -1) {\n      config.url += (\"&session=\" + getCookie(\"token\"));\n    } else {\n      config.url += (\"?session=\" + getCookie(\"token\"));\n    }\n  } else {\n    if (\"undefined\" == typeof (config.data)) {\n      config.data = { session: getCookie(\"token\") };\n    } else {\n      config.data.session = getCookie(\"token\");\n    }\n  }\n\n}\n\n"]}]}