{"remainingRequest":"/workspace3/minjie.chen/gitlab-work/advance-indoor/resources/www/MODELESS/NORMAL/htdocs/node_modules/thread-loader/dist/cjs.js!/workspace3/minjie.chen/gitlab-work/advance-indoor/resources/www/MODELESS/NORMAL/htdocs/node_modules/babel-loader/lib/index.js!/workspace3/minjie.chen/gitlab-work/advance-indoor/resources/www/MODELESS/NORMAL/htdocs/node_modules/cache-loader/dist/cjs.js??ref--0-0!/workspace3/minjie.chen/gitlab-work/advance-indoor/resources/www/MODELESS/NORMAL/htdocs/node_modules/vue-loader/lib/index.js??vue-loader-options!/workspace3/minjie.chen/gitlab-work/advance-indoor/resources/www/MODELESS/NORMAL/htdocs/src/views/PhoneRelay.vue?vue&type=script&lang=js&","dependencies":[{"path":"/workspace3/minjie.chen/gitlab-work/advance-indoor/resources/www/MODELESS/NORMAL/htdocs/src/views/PhoneRelay.vue","mtime":1600155105014},{"path":"/workspace3/minjie.chen/gitlab-work/advance-indoor/resources/www/MODELESS/NORMAL/htdocs/node_modules/cache-loader/dist/cjs.js","mtime":1600155105894},{"path":"/workspace3/minjie.chen/gitlab-work/advance-indoor/resources/www/MODELESS/NORMAL/htdocs/node_modules/thread-loader/dist/cjs.js","mtime":1600155105122},{"path":"/workspace3/minjie.chen/gitlab-work/advance-indoor/resources/www/MODELESS/NORMAL/htdocs/node_modules/babel-loader/lib/index.js","mtime":1600155105338},{"path":"/workspace3/minjie.chen/gitlab-work/advance-indoor/resources/www/MODELESS/NORMAL/htdocs/node_modules/cache-loader/dist/cjs.js","mtime":1600155105894},{"path":"/workspace3/minjie.chen/gitlab-work/advance-indoor/resources/www/MODELESS/NORMAL/htdocs/node_modules/vue-loader/lib/index.js","mtime":1600155105414}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLmV4ZWMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuc3BsaXQiOwovLwovLwovLwovLwppbXBvcnQgQ29tbW9uUGFnZSBmcm9tICJAL2NvbXBvbmVudHMvQ29tbW9uUGFnZS52dWUiOwppbXBvcnQgeyBzaG93UmVxdWVzdFN1Y2Nlc3MsIGRlZXBDbG9uZSwgbm90Q29udGFpbkludmFsaWQsIGdldEl0ZW1CeUtleSwgY2hlY2tJcEFkZHIgfSBmcm9tICJAL2pzL2NvbW1vbi5qcyI7CmV4cG9ydCBkZWZhdWx0IHsKICBjb21wb25lbnRzOiB7CiAgICBDb21tb25QYWdlOiBDb21tb25QYWdlCiAgfSwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgc3RhdHVzSXRlbXM6IFt7CiAgICAgICAga2V5OiAwLAogICAgICAgIGxhYmVsOiB0aGlzLiR0KCJEaXNhYmxlZCIpCiAgICAgIH0sIHsKICAgICAgICBrZXk6IDEsCiAgICAgICAgbGFiZWw6IHRoaXMuJHQoIkVuYWJsZWQiKQogICAgICB9XSwKICAgICAgY2hhbmdlZENmZ0RhdGE6IHt9LAogICAgICBzdWJtaXRDZmdEYXRhOiB7fSwKICAgICAgYXBpRGF0YToge30sCiAgICAgIGRhdGE6IHsKICAgICAgICBnZXREYXRhU3VjY2VzczogZmFsc2UKICAgICAgfQogICAgfTsKICB9LAogIGNyZWF0ZWQ6IGZ1bmN0aW9uIGNyZWF0ZWQoKSB7CiAgICBnZXREYXRhKHRoaXMpOwogIH0sCiAgbWV0aG9kczogewogICAgb25Db21tb25QYWdlRGF0YUNoYW5nZTogZnVuY3Rpb24gb25Db21tb25QYWdlRGF0YUNoYW5nZShldmVudCkgewogICAgICBzZXRDaGFuZ2VkRGF0YSh0aGlzLCBldmVudCk7IC8v55WM6Z2i5Y+Y5YyWCgogICAgICBoYW5kbGVyUGFnZUNoYW5nZWQodGhpcyk7CiAgICB9CiAgfQp9OwoKZnVuY3Rpb24gc2V0Q2hhbmdlZERhdGEodm0sIGV2ZW50KSB7CiAgaWYgKGV2ZW50LmNvbnRlbnRLZXkgPT0gInJlbGF5U2V0dGluZyIgfHwgZXZlbnQuY29udGVudEtleSA9PSAib3BlblJlbGF5VmlhSHR0cCIgfHwgZXZlbnQuY29udGVudEtleSA9PSAicmVtb3RlQ29udHJvbCIgfHwgZXZlbnQuY29udGVudEtleSA9PSAid2ViUmVsYXkiKSB7CiAgICB2bS5jaGFuZ2VkQ2ZnRGF0YVtldmVudC5pdGVtS2V5XSA9IGV2ZW50Lm5ld1ZhbDsKICB9IGVsc2UgaWYgKGV2ZW50LmNvbnRlbnRLZXkgPT0gInNvZnRrZXlJblRhbGtpbmciICYmIGV2ZW50Lml0ZW1LZXkgPT0gInNvZnRrZXlJblRhbGtpbmciKSB7CiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGV2ZW50Lm5ld1ZhbC5sZW5ndGg7IGkrKykgewogICAgICB2bS5jaGFuZ2VkQ2ZnRGF0YVsiQ29uZmlnLkRvb3JTZXR0aW5nLlJFTEFZLlRhbGtpbmdTdGF0dXMiICsgKGkgKyAxKV0gPSBldmVudC5uZXdWYWxbaV0uc3RhdHVzLnZhbHVlOwogICAgICB2bS5jaGFuZ2VkQ2ZnRGF0YVsiQ29uZmlnLkRvb3JTZXR0aW5nLlJFTEFZLlRhbGtpbmdDb2xEaXNwbGF5TmFtZSIgKyAoaSArIDEpXSA9IGV2ZW50Lm5ld1ZhbFtpXS5kaXNwbGF5TmFtZS52YWx1ZTsKICAgICAgdm0uY2hhbmdlZENmZ0RhdGFbIkNvbmZpZy5Eb29yU2V0dGluZy5SRUxBWS5UYWxraW5nUmVsYXlUeXBlIiArIChpICsgMSldID0gZXZlbnQubmV3VmFsW2ldLnR5cGUudmFsdWU7CiAgICB9CiAgfSBlbHNlIGlmIChldmVudC5jb250ZW50S2V5ID09ICJzb2Z0a2V5SW5Ib21lT3JNb3JlIiAmJiBldmVudC5pdGVtS2V5ID09ICJzb2Z0a2V5SW5Ib21lT3JNb3JlIikgewogICAgdm0uY2hhbmdlZENmZ0RhdGFbIkNvbmZpZy5Eb29yU2V0dGluZy5SRUxBWS5JZGxlU3RhdHVzIl0gPSBldmVudC5uZXdWYWxbMF0uc3RhdHVzLnZhbHVlOwogICAgdm0uY2hhbmdlZENmZ0RhdGFbIkNvbmZpZy5Eb29yU2V0dGluZy5SRUxBWS5JZGxlRGlzcGxheU5hbWUiXSA9IGV2ZW50Lm5ld1ZhbFswXS5kaXNwbGF5TmFtZS52YWx1ZTsKICAgIHZtLmNoYW5nZWRDZmdEYXRhWyJDb25maWcuRG9vclNldHRpbmcuUkVMQVkuSWRsZVJlbGF5VHlwZSJdID0gZXZlbnQubmV3VmFsWzBdLnR5cGUudmFsdWU7CiAgfSBlbHNlIGlmIChldmVudC5jb250ZW50S2V5ID09ICJzb2Z0a2V5SW5DYWxsUHJldmlldyIgJiYgZXZlbnQuaXRlbUtleSA9PSAic29mdGtleUluQ2FsbFByZXZpZXciKSB7CiAgICB2bS5jaGFuZ2VkQ2ZnRGF0YVsiQ29uZmlnLkRvb3JTZXR0aW5nLlJFTEFZLkluY29taW5nU3RhdHVzIl0gPSBldmVudC5uZXdWYWxbMF0uc3RhdHVzLnZhbHVlOwogICAgdm0uY2hhbmdlZENmZ0RhdGFbIkNvbmZpZy5Eb29yU2V0dGluZy5SRUxBWS5JbmNvbWluZ0Rpc3BsYXlOYW1lIl0gPSBldmVudC5uZXdWYWxbMF0uZGlzcGxheU5hbWUudmFsdWU7CiAgICB2bS5jaGFuZ2VkQ2ZnRGF0YVsiQ29uZmlnLkRvb3JTZXR0aW5nLlJFTEFZLkluY29taW5nUmVsYXlUeXBlIl0gPSBldmVudC5uZXdWYWxbMF0udHlwZS52YWx1ZTsKICB9IGVsc2UgaWYgKGV2ZW50LmNvbnRlbnRLZXkgPT0gInNvZnRrZXlJbk1vbml0b3IiICYmIGV2ZW50Lml0ZW1LZXkgPT0gInNvZnRrZXlJbk1vbml0b3IiKSB7CiAgICB2bS5jaGFuZ2VkQ2ZnRGF0YVsiQ29uZmlnLkRvb3JTZXR0aW5nLlJFTEFZLk1vbml0b3JTdGF0dXMiXSA9IGV2ZW50Lm5ld1ZhbFswXS5zdGF0dXMudmFsdWU7CiAgICB2bS5jaGFuZ2VkQ2ZnRGF0YVsiQ29uZmlnLkRvb3JTZXR0aW5nLlJFTEFZLk1vbml0b3JEaXNwbGF5TmFtZSJdID0gZXZlbnQubmV3VmFsWzBdLmRpc3BsYXlOYW1lLnZhbHVlOwogICAgdm0uY2hhbmdlZENmZ0RhdGFbIkNvbmZpZy5Eb29yU2V0dGluZy5SRUxBWS5Nb25pdG9yUmVsYXlUeXBlIl0gPSBldmVudC5uZXdWYWxbMF0udHlwZS52YWx1ZTsKICB9IGVsc2UgaWYgKGV2ZW50LmNvbnRlbnRLZXkgPT0gInJlbW90ZVJlbGF5QnlIdHRwIiAmJiBldmVudC5pdGVtS2V5ID09ICJyZW1vdGVSZWxheUJ5SHR0cCIgJiYgZXZlbnQudGFibGVPcGVyYXRlVHlwZSAhPSAic2VsZWN0aW9uIikgewogICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGV2ZW50Lm5ld1ZhbC5sZW5ndGg7IF9pKyspIHsKICAgICAgdm0uY2hhbmdlZENmZ0RhdGFbIkNvbmZpZy5Eb29yU2V0dGluZy5SRU1PVEVSRUxBWS5SZW1vdGVJUCIgKyBfaV0gPSBldmVudC5uZXdWYWxbX2ldLnJlbW90ZUlwLnZhbHVlOwogICAgICB2bS5jaGFuZ2VkQ2ZnRGF0YVsiQ29uZmlnLkRvb3JTZXR0aW5nLlJFTU9URVJFTEFZLlJlbW90ZVVSTCIgKyBfaV0gPSBldmVudC5uZXdWYWxbX2ldLnJlbW90ZUFkZHJlc3MudmFsdWU7CiAgICAgIHZtLmNoYW5nZWRDZmdEYXRhWyJDb25maWcuRG9vclNldHRpbmcuUkVNT1RFUkVMQVkuUmVtb3RlVXNlciIgKyBfaV0gPSBldmVudC5uZXdWYWxbX2ldLnVzZXJuYW1lLnZhbHVlOwogICAgICB2bS5jaGFuZ2VkQ2ZnRGF0YVsiQ29uZmlnLkRvb3JTZXR0aW5nLlJFTU9URVJFTEFZLlJlbW90ZVBhc3N3ZCIgKyBfaV0gPSBldmVudC5uZXdWYWxbX2ldLnBhc3N3b3JkLnZhbHVlOwogICAgICB2YXIgZG9vck51bSA9ICIiOwoKICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBldmVudC5uZXdWYWxbX2ldLmRvb3JOdW0udmFsdWUubGVuZ3RoOyBqKyspIHsKICAgICAgICBkb29yTnVtICs9IGV2ZW50Lm5ld1ZhbFtfaV0uZG9vck51bS52YWx1ZVtqXTsKCiAgICAgICAgaWYgKGogIT0gZXZlbnQubmV3VmFsW19pXS5kb29yTnVtLnZhbHVlLmxlbmd0aCAtIDEpIHsKICAgICAgICAgIGRvb3JOdW0gKz0gIiwiOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdm0uY2hhbmdlZENmZ0RhdGFbIkNvbmZpZy5Eb29yU2V0dGluZy5SRU1PVEVSRUxBWS5SZW1vdGVEb29yTnVtIiArIF9pXSA9IGRvb3JOdW07CiAgICB9CiAgfSBlbHNlIGlmIChldmVudC5jb250ZW50S2V5ID09ICJ3ZWJSZWxheUFjdGlvblNldHRpbmciICYmIGV2ZW50Lml0ZW1LZXkgPT0gIndlYlJlbGF5QWN0aW9uU2V0dGluZyIpIHsKICAgIGZvciAodmFyIF9pMiA9IDA7IF9pMiA8IGV2ZW50Lm5ld1ZhbC5sZW5ndGg7IF9pMisrKSB7CiAgICAgIHZtLmNoYW5nZWRDZmdEYXRhWyJDb25maWcuRG9vclNldHRpbmcuV0VCUkVMQVkuV2ViUmVsYXlJUCIgKyBfaTJdID0gZXZlbnQubmV3VmFsW19pMl0uaXAudmFsdWU7CiAgICAgIHZtLmNoYW5nZWRDZmdEYXRhWyJDb25maWcuRG9vclNldHRpbmcuV0VCUkVMQVkuV2ViUmVsYXlTSVAiICsgX2kyXSA9IGV2ZW50Lm5ld1ZhbFtfaTJdLnNpcC52YWx1ZTsKICAgICAgdm0uY2hhbmdlZENmZ0RhdGFbIkNvbmZpZy5Eb29yU2V0dGluZy5XRUJSRUxBWS5XZWJBY3Rpb24iICsgX2kyXSA9IGV2ZW50Lm5ld1ZhbFtfaTJdLmFjdGlvbi52YWx1ZTsKICAgIH0KICB9Cn0KCmZ1bmN0aW9uIGhhbmRsZXJQYWdlQ2hhbmdlZCh2bSkgewogIGlmICh2bS5jaGFuZ2VkQ2ZnRGF0YVsiQ29uZmlnLkRvb3JTZXR0aW5nLlJFTEFZLlJlbGF5T25XZWIiXSA9PSAwKSB7CiAgICBnZXRJdGVtQnlLZXkodm0uZGF0YSwgIm9wZW5SZWxheVZpYUh0dHAiLCAiQ29uZmlnLkRvb3JTZXR0aW5nLlJFTEFZLlJlbGF5T25XZWJVc2VyIikuZGlzYWJsZWQgPSB0cnVlOwogICAgZ2V0SXRlbUJ5S2V5KHZtLmRhdGEsICJvcGVuUmVsYXlWaWFIdHRwIiwgIkNvbmZpZy5Eb29yU2V0dGluZy5SRUxBWS5SZWxheU9uV2ViUHdkIikuZGlzYWJsZWQgPSB0cnVlOwogIH0gZWxzZSB7CiAgICBnZXRJdGVtQnlLZXkodm0uZGF0YSwgIm9wZW5SZWxheVZpYUh0dHAiLCAiQ29uZmlnLkRvb3JTZXR0aW5nLlJFTEFZLlJlbGF5T25XZWJVc2VyIikuZGlzYWJsZWQgPSBmYWxzZTsKICAgIGdldEl0ZW1CeUtleSh2bS5kYXRhLCAib3BlblJlbGF5VmlhSHR0cCIsICJDb25maWcuRG9vclNldHRpbmcuUkVMQVkuUmVsYXlPbldlYlB3ZCIpLmRpc2FibGVkID0gZmFsc2U7CiAgfQoKICBnZXRJdGVtQnlLZXkodm0uZGF0YSwgInJlbGF5U2V0dGluZyIsICJDb25maWcuRG9vclNldHRpbmcuUkVMQVkuRFRNRkNvZGUyIikuaXNIaWRlID0gdm0uYXBpRGF0YS5kYXRhLnN1cHBvcnRUaHJlZUR0bWYgIT0gMTsKICBnZXRJdGVtQnlLZXkodm0uZGF0YSwgInJlbGF5U2V0dGluZyIsICJDb25maWcuRG9vclNldHRpbmcuUkVMQVkuRFRNRkNvZGUzIikuaXNIaWRlID0gdm0uYXBpRGF0YS5kYXRhLnN1cHBvcnRUaHJlZUR0bWYgIT0gMTsKfQoKZnVuY3Rpb24gc3VibWl0RGF0YSh2bSkgewogIHZtLmRhdGEuc3VibWl0TG9hZGluZyA9IHRydWU7CiAgdmFyIHJlcXVlc3REYXRhID0gewogICAgdGFyZ2V0OiAicGhvbmVSZWxheSIsCiAgICBhY3Rpb246ICJzZXQiLAogICAgY29uZmlnRGF0YTogdm0uc3VibWl0Q2ZnRGF0YQogIH07CiAgdm0uJGF4aW9zLnBvc3QoImFwaSIsIHJlcXVlc3REYXRhKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgc2hvd1JlcXVlc3RTdWNjZXNzKHZtKTsKICAgIHZtLmRhdGEuc3VibWl0TG9hZGluZyA9IGZhbHNlOwogIH0pOwp9CgpmdW5jdGlvbiBnZXREYXRhKHZtKSB7CiAgdm0uJGF4aW9zLmdldCgiYXBpL3Bob25lUmVsYXkvaW5mbyIpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICB2bS5nZXREYXRhU3VjY2VzcyA9IHRydWU7CiAgICB2bS5hcGlEYXRhID0gcmVzcG9uc2UuZGF0YTsKICAgIHZtLmNoYW5nZWRDZmdEYXRhID0gZGVlcENsb25lKHJlc3BvbnNlLmRhdGEuY29uZmlnRGF0YSk7CiAgICBjcmVhdGVQYWdlRGF0YSh2bSk7CiAgICBoYW5kbGVyUGFnZUNoYW5nZWQodm0pOwogIH0pOwp9CgpmdW5jdGlvbiBnZXRDb21taXREYXRhKHZtKSB7CiAgdm0uc3VibWl0Q2ZnRGF0YSA9IHt9OwoKICBmb3IgKHZhciBjaGFuZ2VkS2V5IGluIHZtLmNoYW5nZWRDZmdEYXRhKSB7CiAgICBpZiAodm0uYXBpRGF0YS5jb25maWdEYXRhW2NoYW5nZWRLZXldICE9IHZtLmNoYW5nZWRDZmdEYXRhW2NoYW5nZWRLZXldKSB7CiAgICAgIHZtLnN1Ym1pdENmZ0RhdGFbY2hhbmdlZEtleV0gPSB2bS5jaGFuZ2VkQ2ZnRGF0YVtjaGFuZ2VkS2V5XTsKICAgIH0KICB9Cn0KCmZ1bmN0aW9uIGNoZWNrQ29tbWl0RGF0YSh2bSkgewogIHJldHVybiBjaGVja1JlbW90ZUNvbnRyb2wodm0pICYmIGNoZWNrUmVtb3RlUmVsYXlIdHRwKHZtKSAmJiBjaGVja1dlYlJlbGF5KHZtKSAmJiBjaGVja1dlYlJlbGF5QWN0aW9uU2V0dGluZyh2bSk7Cn0KCmZ1bmN0aW9uIGNoZWNrV2ViUmVsYXlBY3Rpb25TZXR0aW5nKHZtKSB7CiAgdmFyIHN1Y2Nlc3MgPSB0cnVlOwoKICBmb3IgKHZhciBpID0gMDsgaSA8IHZtLmFwaURhdGEuZGF0YS53ZWJSZWxheUFjdGlvbk1heE51bTsgaSsrKSB7CiAgICB2YXIgdGFibGVEYXRhID0gZ2V0SXRlbUJ5S2V5KHZtLmRhdGEsICJ3ZWJSZWxheUFjdGlvblNldHRpbmciLCAid2ViUmVsYXlBY3Rpb25TZXR0aW5nIikudGFibGVEYXRhOwogICAgdGFibGVEYXRhW2ldLmlwLmlzV2FybiA9IGZhbHNlOwogICAgdGFibGVEYXRhW2ldLnNpcC5pc1dhcm4gPSBmYWxzZTsKICAgIHRhYmxlRGF0YVtpXS5hY3Rpb24uaXNXYXJuID0gZmFsc2U7CgogICAgaWYgKHZtLmNoYW5nZWRDZmdEYXRhWyJDb25maWcuRG9vclNldHRpbmcuV0VCUkVMQVkuV2ViUmVsYXlJUCIgKyBpXSA9PSAiIiAmJiB2bS5jaGFuZ2VkQ2ZnRGF0YVsiQ29uZmlnLkRvb3JTZXR0aW5nLldFQlJFTEFZLldlYlJlbGF5U0lQIiArIGldID09ICIiICYmIHZtLmNoYW5nZWRDZmdEYXRhWyJDb25maWcuRG9vclNldHRpbmcuV0VCUkVMQVkuV2ViQWN0aW9uIiArIGldICE9ICIiKSB7CiAgICAgIHRhYmxlRGF0YVtpXS5pcC5pc1dhcm4gPSB0cnVlOwogICAgICB0YWJsZURhdGFbaV0uc2lwLmlzV2FybiA9IHRydWU7CiAgICAgIHN1Y2Nlc3MgPSBmYWxzZTsKICAgIH0KCiAgICBpZiAoKHZtLmNoYW5nZWRDZmdEYXRhWyJDb25maWcuRG9vclNldHRpbmcuV0VCUkVMQVkuV2ViUmVsYXlJUCIgKyBpXSAhPSAiIiB8fCB2bS5jaGFuZ2VkQ2ZnRGF0YVsiQ29uZmlnLkRvb3JTZXR0aW5nLldFQlJFTEFZLldlYlJlbGF5U0lQIiArIGldICE9ICIiKSAmJiB2bS5jaGFuZ2VkQ2ZnRGF0YVsiQ29uZmlnLkRvb3JTZXR0aW5nLldFQlJFTEFZLldlYkFjdGlvbiIgKyBpXSA9PSAiIikgewogICAgICB0YWJsZURhdGFbaV0uYWN0aW9uLmlzV2FybiA9IHRydWU7CiAgICAgIHN1Y2Nlc3MgPSBmYWxzZTsKICAgIH0KICB9CgogIHJldHVybiBzdWNjZXNzOwp9CgpmdW5jdGlvbiBjaGVja1dlYlJlbGF5KHZtKSB7CiAgdmFyIHN1Y2Nlc3MgPSB0cnVlOwoKICBpZiAodm0uY2hhbmdlZENmZ0RhdGFbIkNvbmZpZy5Eb29yU2V0dGluZy5XRUJSRUxBWS5JcEFkZHJlc3MiXSAhPSAiIiAmJiAhY2hlY2tJcEFkZHIodm0uY2hhbmdlZENmZ0RhdGFbIkNvbmZpZy5Eb29yU2V0dGluZy5XRUJSRUxBWS5JcEFkZHJlc3MiXSkpIHsKICAgIGdldEl0ZW1CeUtleSh2bS5kYXRhLCAid2ViUmVsYXkiLCAiQ29uZmlnLkRvb3JTZXR0aW5nLldFQlJFTEFZLklwQWRkcmVzcyIpLmlzV2FybiA9IHRydWU7CiAgICBzdWNjZXNzID0gZmFsc2U7CiAgfQoKICByZXR1cm4gc3VjY2VzczsKfQoKZnVuY3Rpb24gY2hlY2tSZW1vdGVSZWxheUh0dHAodm0pIHsKICB2YXIgc3VjY2VzcyA9IHRydWU7CgogIGZvciAodmFyIGkgPSAwOyBpIDwgdm0uYXBpRGF0YS5kYXRhLm1heFJlbW90ZVJlbGF5TnVtOyBpKyspIHsKICAgIGlmICgodm0uY2hhbmdlZENmZ0RhdGFbIkNvbmZpZy5Eb29yU2V0dGluZy5SRU1PVEVSRUxBWS5SZW1vdGVVUkwiICsgaV0gIT0gIiIgfHwgdm0uY2hhbmdlZENmZ0RhdGFbIkNvbmZpZy5Eb29yU2V0dGluZy5SRU1PVEVSRUxBWS5SZW1vdGVVc2VyIiArIGldICE9ICIiKSAmJiB2bS5jaGFuZ2VkQ2ZnRGF0YVsiQ29uZmlnLkRvb3JTZXR0aW5nLlJFTU9URVJFTEFZLlJlbW90ZUlQIiArIGldID09ICIiKSB7CiAgICAgIHZhciB0YWJsZURhdGEgPSBnZXRJdGVtQnlLZXkodm0uZGF0YSwgInJlbW90ZVJlbGF5QnlIdHRwIiwgInJlbW90ZVJlbGF5QnlIdHRwIikudGFibGVEYXRhOwogICAgICB0YWJsZURhdGFbaV0ucmVtb3RlSXAuaXNXYXJuID0gdHJ1ZTsKICAgICAgc3VjY2VzcyA9IGZhbHNlOwogICAgfQogIH0KCiAgcmV0dXJuIHN1Y2Nlc3M7Cn0KCmZ1bmN0aW9uIGNoZWNrUmVtb3RlQ29udHJvbCh2bSkgewogIHZhciBzdWNjZXNzID0gdHJ1ZTsKCiAgaWYgKCFub3RDb250YWluSW52YWxpZCh2bS5jaGFuZ2VkQ2ZnRGF0YVsiQ29uZmlnLkZlYXR1cmVzLlJFTU9URUNPTlRST0wuQWN0aW9uVVJJQWxsb3dJUExpc3QiXSkpIHsKICAgIGdldEl0ZW1CeUtleSh2bS5kYXRhLCAicmVtb3RlQ29udHJvbCIsICJDb25maWcuRmVhdHVyZXMuUkVNT1RFQ09OVFJPTC5BY3Rpb25VUklBbGxvd0lQTGlzdCIpLmlzV2FybiA9IHRydWU7CiAgICBzdWNjZXNzID0gZmFsc2U7CiAgfQoKICByZXR1cm4gc3VjY2VzczsKfQoKZnVuY3Rpb24gY3JlYXRlUGFnZURhdGEodm0pIHsKICB2bS5kYXRhID0gewogICAgZ2V0RGF0YVN1Y2Nlc3M6IHRydWUsCiAgICBicmVhZENydW1iOiB7CiAgICAgIGZpcnN0VGl0bGU6IHZtLiR0KCJQaG9uZSIpLAogICAgICBzZWNvbmRUaXRsZTogdm0uJHQoIlJlbGF5IikKICAgIH0sCiAgICBvblN1Ym1pdDogZnVuY3Rpb24gb25TdWJtaXQoKSB7CiAgICAgIGlmICghY2hlY2tDb21taXREYXRhKHZtKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgZ2V0Q29tbWl0RGF0YSh2bSk7CiAgICAgIHN1Ym1pdERhdGEodm0pOwogICAgfSwKICAgIG9uQ2FuY2VsOiBmdW5jdGlvbiBvbkNhbmNlbCgpIHsKICAgICAgdm0uZGF0YS5jYW5jZWxMb2FkaW5nID0gdHJ1ZTsKICAgICAgZ2V0RGF0YSh2bSk7CiAgICB9LAogICAgc3VibWl0TG9hZGluZzogZmFsc2UsCiAgICBjYW5jZWxMb2FkaW5nOiBmYWxzZSwKICAgIGNvbnRlbnRzOiBbXQogIH07CiAgdm0uZGF0YS5jb250ZW50cy5wdXNoKGNyZWF0ZVJlbGF5U2V0dGluZ0NvbnRlbnQodm0pKTsKICB2bS5kYXRhLmNvbnRlbnRzLnB1c2goY3JlYXRlUmVtb3RlQ29udHJvbENvbnRlbnQodm0pKTsKICB2bS5kYXRhLmNvbnRlbnRzLnB1c2goY3JlYXRlT3BlblJlbGF5VmlhSHR0cENvbnRlbnQodm0pKTsKICB2bS5kYXRhLmNvbnRlbnRzLnB1c2goY3JlYXRlU29mdGtleUluVGFsa2luZ0NvbnRlbnQodm0pKTsKICB2bS5kYXRhLmNvbnRlbnRzLnB1c2goY3JlYXRlU29mdGtleUluSG9tZU9yTW9yZUNvbnRlbnQodm0pKTsKICB2bS5kYXRhLmNvbnRlbnRzLnB1c2goY3JlYXRlU29mdGtleUluTW9uaXRvckNvbnRlbnQodm0pKTsKICB2bS5kYXRhLmNvbnRlbnRzLnB1c2goY3JlYXRlU29mdGtleUluQ2FsbFByZXZpZXdDb250ZW50KHZtKSk7CiAgdm0uZGF0YS5jb250ZW50cy5wdXNoKGNyZWF0ZVJlbW90ZVJlbGF5QnlIdHRwQ29udGVudCh2bSkpOwogIHZtLmRhdGEuY29udGVudHMucHVzaChjcmVhdGVXZWJSZWxheUNvbnRlbnQodm0pKTsKICB2bS5kYXRhLmNvbnRlbnRzLnB1c2goY3JlYXRlV2ViUmVsYXlBY3Rpb25TZXR0aW5nQ29udGVudCh2bSkpOwp9CgpmdW5jdGlvbiBjcmVhdGVXZWJSZWxheUFjdGlvblNldHRpbmdDb250ZW50KHZtKSB7CiAgLy90YWJsZSBkYXRhCiAgdmFyIHRhYmxlRGF0YSA9IFtdOwoKICBmb3IgKHZhciBpID0gMDsgaSA8IHZtLmFwaURhdGEuZGF0YS53ZWJSZWxheUFjdGlvbk1heE51bTsgaSsrKSB7CiAgICB2YXIgaXRlbSA9IHsKICAgICAga2V5OiBpLAogICAgICBhY3Rpb25JZDogdm0uJHQoIldlYlJlbGF5Q29sSWQiKSArICIgIiArIChpICsgMSksCiAgICAgIGlwOiB7CiAgICAgICAgdmFsdWU6IHZtLmFwaURhdGEuY29uZmlnRGF0YVsiQ29uZmlnLkRvb3JTZXR0aW5nLldFQlJFTEFZLldlYlJlbGF5SVAiICsgaV0sCiAgICAgICAgaXNXYXJuOiBmYWxzZSwKICAgICAgICB3YXJuTGFiZWw6IHZtLiR0KCJWYWx1ZUVtcHR5V2FybmluZyIpCiAgICAgIH0sCiAgICAgIHNpcDogewogICAgICAgIHZhbHVlOiB2bS5hcGlEYXRhLmNvbmZpZ0RhdGFbIkNvbmZpZy5Eb29yU2V0dGluZy5XRUJSRUxBWS5XZWJSZWxheVNJUCIgKyBpXSwKICAgICAgICBpc1dhcm46IGZhbHNlLAogICAgICAgIHdhcm5MYWJlbDogdm0uJHQoIlZhbHVlRW1wdHlXYXJuaW5nIikKICAgICAgfSwKICAgICAgYWN0aW9uOiB7CiAgICAgICAgdmFsdWU6IHZtLmFwaURhdGEuY29uZmlnRGF0YVsiQ29uZmlnLkRvb3JTZXR0aW5nLldFQlJFTEFZLldlYkFjdGlvbiIgKyBpXSwKICAgICAgICBpc1dhcm46IGZhbHNlLAogICAgICAgIHdhcm5MYWJlbDogdm0uJHQoIlZhbHVlRW1wdHlXYXJuaW5nIikKICAgICAgfQogICAgfTsKICAgIHRhYmxlRGF0YS5wdXNoKGl0ZW0pOwogIH0gLy9jb250ZW50CgoKICB2YXIgY29udGVudCA9IHsKICAgIGtleTogIndlYlJlbGF5QWN0aW9uU2V0dGluZyIsCiAgICB0aXRsZTogdm0uJHQoIldlYlJlbGF5QWN0aW9uU2V0dGluZyIpLAogICAgdGl0bGVEZXNjcmlwdGlvbjogdm0uJHQoIldlYlJlbGF5QWN0aW9uU2V0dGluZyIpLAogICAgaXRlbXM6IFt7CiAgICAgIHR5cGU6ICJ0YWJsZSIsCiAgICAgIGtleTogIndlYlJlbGF5QWN0aW9uU2V0dGluZyIsCiAgICAgIHRhYmxlQ29sdW1uczogW3sKICAgICAgICB0eXBlOiAibGFiZWwiLAogICAgICAgIHRpdGxlOiB2bS4kdCgiV2ViUmVsYXlDb2xJZCIpLAogICAgICAgIGRhdGFJbmRleDogImFjdGlvbklkIiwKICAgICAgICBzY29wZWRTbG90czogewogICAgICAgICAgY3VzdG9tUmVuZGVyOiAiYWN0aW9uSWQiCiAgICAgICAgfSwKICAgICAgICBhbGlnbjogImNlbnRlciIsCiAgICAgICAgc2VsZWN0SXRlbXM6IHZtLnN0YXR1c0l0ZW1zLAogICAgICAgIHdpZHRoOiAiMTAlIgogICAgICB9LCB7CiAgICAgICAgdHlwZTogImlucHV0IiwKICAgICAgICB0aXRsZTogdm0uJHQoIklQIiksCiAgICAgICAgZGF0YUluZGV4OiAiaXAiLAogICAgICAgIHNjb3BlZFNsb3RzOiB7CiAgICAgICAgICBjdXN0b21SZW5kZXI6ICJpcCIKICAgICAgICB9LAogICAgICAgIGFsaWduOiAiY2VudGVyIiwKICAgICAgICB3aWR0aDogIjMwJSIKICAgICAgfSwgewogICAgICAgIHR5cGU6ICJpbnB1dCIsCiAgICAgICAgdGl0bGU6IHZtLiR0KCJTSVAiKSwKICAgICAgICBkYXRhSW5kZXg6ICJzaXAiLAogICAgICAgIHNjb3BlZFNsb3RzOiB7CiAgICAgICAgICBjdXN0b21SZW5kZXI6ICJzaXAiCiAgICAgICAgfSwKICAgICAgICBhbGlnbjogImNlbnRlciIsCiAgICAgICAgd2lkdGg6ICIzMCUiCiAgICAgIH0sIHsKICAgICAgICB0eXBlOiAiaW5wdXQiLAogICAgICAgIHRpdGxlOiB2bS4kdCgiV2ViUmVsYXlDb2xBY3Rpb24iKSwKICAgICAgICBkYXRhSW5kZXg6ICJhY3Rpb24iLAogICAgICAgIHNjb3BlZFNsb3RzOiB7CiAgICAgICAgICBjdXN0b21SZW5kZXI6ICJhY3Rpb24iCiAgICAgICAgfSwKICAgICAgICBhbGlnbjogImNlbnRlciIsCiAgICAgICAgd2lkdGg6ICIzMCUiLAogICAgICAgIG1heExlbmd0aDogMTI3CiAgICAgIH1dLAogICAgICB0YWJsZURhdGE6IHRhYmxlRGF0YQogICAgfV0KICB9OwogIHJldHVybiBjb250ZW50Owp9CgpmdW5jdGlvbiBjcmVhdGVXZWJSZWxheUNvbnRlbnQodm0pIHsKICB2YXIgY29udGVudCA9IHsKICAgIGtleTogIndlYlJlbGF5IiwKICAgIHRpdGxlOiB2bS4kdCgiV2ViUmVsYXkiKSwKICAgIHRpdGxlRGVzY3JpcHRpb246IHZtLiR0KCJXZWJSZWxheSIpLAogICAgaXRlbXM6IFt7CiAgICAgIHRpdGxlOiB2bS4kdCgiV2ViUmVsYXlJUEFkZHJlc3MiKSwKICAgICAgdHlwZTogImlucHV0IiwKICAgICAga2V5OiAiQ29uZmlnLkRvb3JTZXR0aW5nLldFQlJFTEFZLklwQWRkcmVzcyIsCiAgICAgIHZhbHVlOiB2bS5hcGlEYXRhLmNvbmZpZ0RhdGFbIkNvbmZpZy5Eb29yU2V0dGluZy5XRUJSRUxBWS5JcEFkZHJlc3MiXSwKICAgICAgaXNXYXJuOiBmYWxzZSwKICAgICAgd2FybkxhYmVsOiB2bS4kdCgiSXBGb3JtYXRFcnJvciIpCiAgICB9LCB7CiAgICAgIHRpdGxlOiB2bS4kdCgiV2ViUmVsYXlVc2VyIiksCiAgICAgIHR5cGU6ICJpbnB1dCIsCiAgICAgIGtleTogIkNvbmZpZy5Eb29yU2V0dGluZy5XRUJSRUxBWS5Vc2VyTmFtZSIsCiAgICAgIHZhbHVlOiB2bS5hcGlEYXRhLmNvbmZpZ0RhdGFbIkNvbmZpZy5Eb29yU2V0dGluZy5XRUJSRUxBWS5Vc2VyTmFtZSJdCiAgICB9LCB7CiAgICAgIHRpdGxlOiB2bS4kdCgiV2ViUmVsYXlQd2QiKSwKICAgICAgaW5wdXRUeXBlOiAicGFzc3dvcmQiLAogICAgICB0eXBlOiAiaW5wdXQiLAogICAgICBrZXk6ICJDb25maWcuRG9vclNldHRpbmcuV0VCUkVMQVkuUGFzc3dkIiwKICAgICAgdmFsdWU6IHZtLmFwaURhdGEuY29uZmlnRGF0YVsiQ29uZmlnLkRvb3JTZXR0aW5nLldFQlJFTEFZLlBhc3N3ZCJdCiAgICB9XQogIH07CiAgcmV0dXJuIGNvbnRlbnQ7Cn0KCmZ1bmN0aW9uIGNyZWF0ZVJlbW90ZVJlbGF5QnlIdHRwQ29udGVudCh2bSkgewogIC8vZG9vcm51bSBpdGVtcwogIHZhciBkb29yTnVtSXRlbXMgPSBbXTsKCiAgZm9yICh2YXIgaSA9IDE7IGkgPD0gNDsgaSsrKSB7CiAgICB2YXIgaXRlbSA9IHsKICAgICAga2V5OiBpLAogICAgICBsYWJlbDogaQogICAgfTsKICAgIGRvb3JOdW1JdGVtcy5wdXNoKGl0ZW0pOwogIH0gLy90YWJsZWRhdGEKCgogIHZhciB0YWJsZURhdGEgPSBbXTsKCiAgZm9yICh2YXIgX2kzID0gMDsgX2kzIDwgdm0uYXBpRGF0YS5kYXRhLm1heFJlbW90ZVJlbGF5TnVtOyBfaTMrKykgewogICAgdmFyIF9pdGVtID0gewogICAgICBrZXk6IF9pMywKICAgICAgaW5kZXg6IF9pMyArIDEsCiAgICAgIHJlbW90ZUlwOiB7CiAgICAgICAgdmFsdWU6IHZtLmFwaURhdGEuY29uZmlnRGF0YVsiQ29uZmlnLkRvb3JTZXR0aW5nLlJFTU9URVJFTEFZLlJlbW90ZUlQIiArIF9pM10sCiAgICAgICAgaXNXYXJuOiBmYWxzZSwKICAgICAgICB3YXJuTGFiZWw6IHZtLiR0KCJWYWx1ZUVtcHR5V2FybmluZyIpCiAgICAgIH0sCiAgICAgIHJlbW90ZUFkZHJlc3M6IHsKICAgICAgICB2YWx1ZTogdm0uYXBpRGF0YS5jb25maWdEYXRhWyJDb25maWcuRG9vclNldHRpbmcuUkVNT1RFUkVMQVkuUmVtb3RlVVJMIiArIF9pM10sCiAgICAgICAgaXNXYXJuOiBmYWxzZQogICAgICB9LAogICAgICB1c2VybmFtZTogewogICAgICAgIHZhbHVlOiB2bS5hcGlEYXRhLmNvbmZpZ0RhdGFbIkNvbmZpZy5Eb29yU2V0dGluZy5SRU1PVEVSRUxBWS5SZW1vdGVVc2VyIiArIF9pM10sCiAgICAgICAgaXNXYXJuOiBmYWxzZQogICAgICB9LAogICAgICBwYXNzd29yZDogewogICAgICAgIHZhbHVlOiB2bS5hcGlEYXRhLmNvbmZpZ0RhdGFbIkNvbmZpZy5Eb29yU2V0dGluZy5SRU1PVEVSRUxBWS5SZW1vdGVQYXNzd2QiICsgX2kzXSwKICAgICAgICBpc1dhcm46IGZhbHNlCiAgICAgIH0sCiAgICAgIGRvb3JOdW06IHsKICAgICAgICB2YWx1ZTogdm0uYXBpRGF0YS5jb25maWdEYXRhWyJDb25maWcuRG9vclNldHRpbmcuUkVNT1RFUkVMQVkuUmVtb3RlRG9vck51bSIgKyBfaTNdID09ICIiID8gWyIxIiwgIjIiLCAiMyIsICI0Il0gOiB2bS5hcGlEYXRhLmNvbmZpZ0RhdGFbIkNvbmZpZy5Eb29yU2V0dGluZy5SRU1PVEVSRUxBWS5SZW1vdGVEb29yTnVtIiArIF9pM10uc3BsaXQoIiwiKSwKICAgICAgICBpc1dhcm46IGZhbHNlCiAgICAgIH0KICAgIH07CiAgICB0YWJsZURhdGEucHVzaChfaXRlbSk7CiAgfSAvL2NvbnRlbnQKCgogIHZhciBjb250ZW50ID0gewogICAga2V5OiAicmVtb3RlUmVsYXlCeUh0dHAiLAogICAgdGl0bGU6IHZtLiR0KCJSZW1vdGVSZWxheVNldHRpbmciKSwKICAgIHRpdGxlRGVzY3JpcHRpb246IHZtLiR0KCJSZW1vdGVSZWxheVNldHRpbmciKSwKICAgIGl0ZW1zOiBbewogICAgICB0eXBlOiAidGFibGUiLAogICAgICBrZXk6ICJyZW1vdGVSZWxheUJ5SHR0cCIsCiAgICAgIC8vIHNob3dSb3dTZWxlY3Rpb246IHRydWUsCiAgICAgIC8vIHNlbGVjdGVkUm93S2V5czogW10sCiAgICAgIHRhYmxlQ29sdW1uczogW3sKICAgICAgICB0eXBlOiAibGFiZWwiLAogICAgICAgIHRpdGxlOiB2bS4kdCgiSW5kZXgiKSwKICAgICAgICBkYXRhSW5kZXg6ICJpbmRleCIsCiAgICAgICAgc2NvcGVkU2xvdHM6IHsKICAgICAgICAgIGN1c3RvbVJlbmRlcjogImluZGV4IgogICAgICAgIH0sCiAgICAgICAgYWxpZ246ICJjZW50ZXIiLAogICAgICAgIHdpZHRoOiAiNyUiCiAgICAgIH0sIHsKICAgICAgICB0eXBlOiAiaW5wdXQiLAogICAgICAgIHRpdGxlOiB2bS4kdCgiUmVtb3RlUmVsYXlJUCIpLAogICAgICAgIGRhdGFJbmRleDogInJlbW90ZUlwIiwKICAgICAgICBzY29wZWRTbG90czogewogICAgICAgICAgY3VzdG9tUmVuZGVyOiAicmVtb3RlSXAiCiAgICAgICAgfSwKICAgICAgICBhbGlnbjogImNlbnRlciIsCiAgICAgICAgd2lkdGg6ICIxOCUiCiAgICAgIH0sIHsKICAgICAgICB0eXBlOiAiaW5wdXQiLAogICAgICAgIHRpdGxlOiB2bS4kdCgiUmVtb3RlUmVsYXlVUkwiKSwKICAgICAgICBkYXRhSW5kZXg6ICJyZW1vdGVBZGRyZXNzIiwKICAgICAgICBzY29wZWRTbG90czogewogICAgICAgICAgY3VzdG9tUmVuZGVyOiAicmVtb3RlQWRkcmVzcyIKICAgICAgICB9LAogICAgICAgIGFsaWduOiAiY2VudGVyIiwKICAgICAgICB3aWR0aDogIjE4JSIKICAgICAgfSwgewogICAgICAgIHR5cGU6ICJpbnB1dCIsCiAgICAgICAgdGl0bGU6IHZtLiR0KCJVc2VyTmFtZSIpLAogICAgICAgIGRhdGFJbmRleDogInVzZXJuYW1lIiwKICAgICAgICBzY29wZWRTbG90czogewogICAgICAgICAgY3VzdG9tUmVuZGVyOiAidXNlcm5hbWUiCiAgICAgICAgfSwKICAgICAgICBhbGlnbjogImNlbnRlciIsCiAgICAgICAgd2lkdGg6ICIxOCUiCiAgICAgIH0sIHsKICAgICAgICB0eXBlOiAiaW5wdXQiLAogICAgICAgIHRpdGxlOiB2bS4kdCgiUGFzc3dvcmQiKSwKICAgICAgICBkYXRhSW5kZXg6ICJwYXNzd29yZCIsCiAgICAgICAgc2NvcGVkU2xvdHM6IHsKICAgICAgICAgIGN1c3RvbVJlbmRlcjogInBhc3N3b3JkIgogICAgICAgIH0sCiAgICAgICAgYWxpZ246ICJjZW50ZXIiLAogICAgICAgIHdpZHRoOiAiMTglIiwKICAgICAgICBpbnB1dFR5cGU6ICJwYXNzd29yZCIKICAgICAgfSwgewogICAgICAgIHR5cGU6ICJzZWxlY3QiLAogICAgICAgIHRpdGxlOiB2bS4kdCgiRG9vck51bSIpLAogICAgICAgIGRhdGFJbmRleDogImRvb3JOdW0iLAogICAgICAgIHNjb3BlZFNsb3RzOiB7CiAgICAgICAgICBjdXN0b21SZW5kZXI6ICJkb29yTnVtIgogICAgICAgIH0sCiAgICAgICAgYWxpZ246ICJjZW50ZXIiLAogICAgICAgIHdpZHRoOiAiMTglIiwKICAgICAgICBtb2RlOiAibXVsdGlwbGUiLAogICAgICAgIHNlbGVjdEl0ZW1zOiBkb29yTnVtSXRlbXMKICAgICAgfV0sCiAgICAgIHRhYmxlRGF0YTogdGFibGVEYXRhCiAgICB9XQogIH07CiAgcmV0dXJuIGNvbnRlbnQ7Cn0KCmZ1bmN0aW9uIGNyZWF0ZVNvZnRrZXlJbkNhbGxQcmV2aWV3Q29udGVudCh2bSkgewogIC8vdGFibGUgZGF0YQogIHZhciB0YWJsZURhdGEgPSBbewogICAga2V5OiAwLAogICAgc3RhdHVzOiB7CiAgICAgIHZhbHVlOiB2bS5hcGlEYXRhLmNvbmZpZ0RhdGFbIkNvbmZpZy5Eb29yU2V0dGluZy5SRUxBWS5JbmNvbWluZ1N0YXR1cyJdLAogICAgICBpc1dhcm46IGZhbHNlCiAgICB9LAogICAgZGlzcGxheU5hbWU6IHsKICAgICAgdmFsdWU6IHZtLmFwaURhdGEuY29uZmlnRGF0YVsiQ29uZmlnLkRvb3JTZXR0aW5nLlJFTEFZLkluY29taW5nRGlzcGxheU5hbWUiXSwKICAgICAgaXNXYXJuOiBmYWxzZQogICAgfSwKICAgIHR5cGU6IHsKICAgICAgdmFsdWU6IHZtLmFwaURhdGEuY29uZmlnRGF0YVsiQ29uZmlnLkRvb3JTZXR0aW5nLlJFTEFZLkluY29taW5nUmVsYXlUeXBlIl0sCiAgICAgIGlzV2FybjogZmFsc2UKICAgIH0KICB9XTsgLy90eXBlIGl0ZW1zCgogIHZhciB0eXBlSXRlbXMgPSBbXTsKICB0eXBlSXRlbXMucHVzaCh7CiAgICBrZXk6IDMsCiAgICBsYWJlbDogdm0uJHQoIlJlbW90ZVJlbGF5SFRUUCIpCiAgfSk7CiAgdHlwZUl0ZW1zLnB1c2goewogICAga2V5OiA0LAogICAgbGFiZWw6IHZtLiR0KCJXZWJSZWxheUFjdGlvbiIpCiAgfSk7CgogIGlmICh2bS5hcGlEYXRhLmRhdGEuY29ubmVjdE1vZGUgPT0gMikgewogICAgdHlwZUl0ZW1zLnB1c2goewogICAgICBrZXk6IDE2LAogICAgICBsYWJlbDogdm0uJHQoIkNvbmZpZ09uQ2xvdWQiKQogICAgfSk7CiAgfSAvL2NvbnRlbnQKCgogIHZhciBjb250ZW50ID0gewogICAga2V5OiAic29mdGtleUluQ2FsbFByZXZpZXciLAogICAgdGl0bGU6IHZtLiR0KCJDYWxsUHJldmlld1BhZ2VUaXRsZSIpLAogICAgdGl0bGVEZXNjcmlwdGlvbjogdm0uJHQoIkNhbGxQcmV2aWV3UGFnZVRpdGxlIiksCiAgICBpdGVtczogW3sKICAgICAgdHlwZTogInRhYmxlIiwKICAgICAga2V5OiAic29mdGtleUluQ2FsbFByZXZpZXciLAogICAgICB0YWJsZUNvbHVtbnM6IFt7CiAgICAgICAgdHlwZTogInNlbGVjdCIsCiAgICAgICAgdGl0bGU6IHZtLiR0KCJTdGF0dXMiKSwKICAgICAgICBkYXRhSW5kZXg6ICJzdGF0dXMiLAogICAgICAgIHNjb3BlZFNsb3RzOiB7CiAgICAgICAgICBjdXN0b21SZW5kZXI6ICJzdGF0dXMiCiAgICAgICAgfSwKICAgICAgICBhbGlnbjogImNlbnRlciIsCiAgICAgICAgc2VsZWN0SXRlbXM6IHZtLnN0YXR1c0l0ZW1zLAogICAgICAgIHdpZHRoOiAiMzAlIgogICAgICB9LCB7CiAgICAgICAgdHlwZTogImlucHV0IiwKICAgICAgICB0aXRsZTogdm0uJHQoIkRpc3BsYXlOYW1lIiksCiAgICAgICAgZGF0YUluZGV4OiAiZGlzcGxheU5hbWUiLAogICAgICAgIHNjb3BlZFNsb3RzOiB7CiAgICAgICAgICBjdXN0b21SZW5kZXI6ICJkaXNwbGF5TmFtZSIKICAgICAgICB9LAogICAgICAgIGFsaWduOiAiY2VudGVyIiwKICAgICAgICB3aWR0aDogIjMwJSIKICAgICAgfSwgewogICAgICAgIHR5cGU6ICJzZWxlY3QiLAogICAgICAgIHRpdGxlOiB2bS4kdCgiVHlwZSIpLAogICAgICAgIGRhdGFJbmRleDogInR5cGUiLAogICAgICAgIHNjb3BlZFNsb3RzOiB7CiAgICAgICAgICBjdXN0b21SZW5kZXI6ICJ0eXBlIgogICAgICAgIH0sCiAgICAgICAgYWxpZ246ICJjZW50ZXIiLAogICAgICAgIHNlbGVjdEl0ZW1zOiB0eXBlSXRlbXMsCiAgICAgICAgd2lkdGg6ICI0MCUiCiAgICAgIH1dLAogICAgICB0YWJsZURhdGE6IHRhYmxlRGF0YQogICAgfV0KICB9OwogIHJldHVybiBjb250ZW50Owp9CgpmdW5jdGlvbiBjcmVhdGVTb2Z0a2V5SW5Nb25pdG9yQ29udGVudCh2bSkgewogIC8vdGFibGUgZGF0YQogIHZhciB0YWJsZURhdGEgPSBbewogICAga2V5OiAwLAogICAgc3RhdHVzOiB7CiAgICAgIHZhbHVlOiB2bS5hcGlEYXRhLmNvbmZpZ0RhdGFbIkNvbmZpZy5Eb29yU2V0dGluZy5SRUxBWS5Nb25pdG9yU3RhdHVzIl0sCiAgICAgIGlzV2FybjogZmFsc2UKICAgIH0sCiAgICBkaXNwbGF5TmFtZTogewogICAgICB2YWx1ZTogdm0uYXBpRGF0YS5jb25maWdEYXRhWyJDb25maWcuRG9vclNldHRpbmcuUkVMQVkuTW9uaXRvckRpc3BsYXlOYW1lIl0sCiAgICAgIGlzV2FybjogZmFsc2UKICAgIH0sCiAgICB0eXBlOiB7CiAgICAgIHZhbHVlOiB2bS5hcGlEYXRhLmNvbmZpZ0RhdGFbIkNvbmZpZy5Eb29yU2V0dGluZy5SRUxBWS5Nb25pdG9yUmVsYXlUeXBlIl0sCiAgICAgIGlzV2FybjogZmFsc2UKICAgIH0KICB9XTsgLy90eXBlIGl0ZW1zCgogIHZhciB0eXBlSXRlbXMgPSBbXTsKICB0eXBlSXRlbXMucHVzaCh7CiAgICBrZXk6IDMsCiAgICBsYWJlbDogdm0uJHQoIlJlbW90ZVJlbGF5SFRUUCIpCiAgfSk7CiAgdHlwZUl0ZW1zLnB1c2goewogICAga2V5OiA0LAogICAgbGFiZWw6IHZtLiR0KCJXZWJSZWxheUFjdGlvbiIpCiAgfSk7CgogIGlmICh2bS5hcGlEYXRhLmRhdGEuY29ubmVjdE1vZGUgPT0gMikgewogICAgdHlwZUl0ZW1zLnB1c2goewogICAgICBrZXk6IDE2LAogICAgICBsYWJlbDogdm0uJHQoIkNvbmZpZ09uQ2xvdWQiKQogICAgfSk7CiAgfSAvL2NvbnRlbnQKCgogIHZhciBjb250ZW50ID0gewogICAga2V5OiAic29mdGtleUluTW9uaXRvciIsCiAgICB0aXRsZTogdm0uJHQoIk1vbml0b3JQYWdlVGl0bGUiKSwKICAgIHRpdGxlRGVzY3JpcHRpb246IHZtLiR0KCJNb25pdG9yUGFnZVRpdGxlIiksCiAgICBpdGVtczogW3sKICAgICAgdHlwZTogInRhYmxlIiwKICAgICAga2V5OiAic29mdGtleUluTW9uaXRvciIsCiAgICAgIHRhYmxlQ29sdW1uczogW3sKICAgICAgICB0eXBlOiAic2VsZWN0IiwKICAgICAgICB0aXRsZTogdm0uJHQoIlN0YXR1cyIpLAogICAgICAgIGRhdGFJbmRleDogInN0YXR1cyIsCiAgICAgICAgc2NvcGVkU2xvdHM6IHsKICAgICAgICAgIGN1c3RvbVJlbmRlcjogInN0YXR1cyIKICAgICAgICB9LAogICAgICAgIGFsaWduOiAiY2VudGVyIiwKICAgICAgICBzZWxlY3RJdGVtczogdm0uc3RhdHVzSXRlbXMsCiAgICAgICAgd2lkdGg6ICIzMCUiCiAgICAgIH0sIHsKICAgICAgICB0eXBlOiAiaW5wdXQiLAogICAgICAgIHRpdGxlOiB2bS4kdCgiRGlzcGxheU5hbWUiKSwKICAgICAgICBkYXRhSW5kZXg6ICJkaXNwbGF5TmFtZSIsCiAgICAgICAgc2NvcGVkU2xvdHM6IHsKICAgICAgICAgIGN1c3RvbVJlbmRlcjogImRpc3BsYXlOYW1lIgogICAgICAgIH0sCiAgICAgICAgYWxpZ246ICJjZW50ZXIiLAogICAgICAgIHdpZHRoOiAiMzAlIgogICAgICB9LCB7CiAgICAgICAgdHlwZTogInNlbGVjdCIsCiAgICAgICAgdGl0bGU6IHZtLiR0KCJUeXBlIiksCiAgICAgICAgZGF0YUluZGV4OiAidHlwZSIsCiAgICAgICAgc2NvcGVkU2xvdHM6IHsKICAgICAgICAgIGN1c3RvbVJlbmRlcjogInR5cGUiCiAgICAgICAgfSwKICAgICAgICBhbGlnbjogImNlbnRlciIsCiAgICAgICAgc2VsZWN0SXRlbXM6IHR5cGVJdGVtcywKICAgICAgICB3aWR0aDogIjQwJSIKICAgICAgfV0sCiAgICAgIHRhYmxlRGF0YTogdGFibGVEYXRhCiAgICB9XQogIH07CiAgcmV0dXJuIGNvbnRlbnQ7Cn0KCmZ1bmN0aW9uIGNyZWF0ZVNvZnRrZXlJbkhvbWVPck1vcmVDb250ZW50KHZtKSB7CiAgLy90YWJsZSBkYXRhCiAgdmFyIHRhYmxlRGF0YSA9IFt7CiAgICBrZXk6IDAsCiAgICBzdGF0dXM6IHsKICAgICAgdmFsdWU6IHZtLmFwaURhdGEuY29uZmlnRGF0YVsiQ29uZmlnLkRvb3JTZXR0aW5nLlJFTEFZLklkbGVTdGF0dXMiXSwKICAgICAgaXNXYXJuOiBmYWxzZSwKICAgICAgZGlzYWJsZWQ6IHRydWUKICAgIH0sCiAgICBkaXNwbGF5TmFtZTogewogICAgICB2YWx1ZTogdm0uYXBpRGF0YS5jb25maWdEYXRhWyJDb25maWcuRG9vclNldHRpbmcuUkVMQVkuSWRsZURpc3BsYXlOYW1lIl0sCiAgICAgIGlzV2FybjogZmFsc2UKICAgIH0sCiAgICB0eXBlOiB7CiAgICAgIHZhbHVlOiB2bS5hcGlEYXRhLmNvbmZpZ0RhdGFbIkNvbmZpZy5Eb29yU2V0dGluZy5SRUxBWS5JZGxlUmVsYXlUeXBlIl0sCiAgICAgIGlzV2FybjogZmFsc2UKICAgIH0KICB9XTsgLy90eXBlIGl0ZW1zCgogIHZhciB0eXBlSXRlbXMgPSBbXTsKCiAgZm9yICh2YXIgaSA9IDA7IGkgPCB2bS5hcGlEYXRhLmRhdGEubWF4UmVtb3RlUmVsYXlOdW07IGkrKykgewogICAgdmFyIGl0ZW0gPSB7CiAgICAgIGtleTogaSArIDEsCiAgICAgIGxhYmVsOiB2bS4kdCgiUmVtb3RlUmVsYXlIVFRQIikgKyAoaSArIDEpCiAgICB9OwogICAgdHlwZUl0ZW1zLnB1c2goaXRlbSk7CiAgfSAvL2NvbnRlbnQKCgogIHZhciBjb250ZW50ID0gewogICAga2V5OiAic29mdGtleUluSG9tZU9yTW9yZSIsCiAgICB0aXRsZTogdm0uJHQoIkhvbWVPck1vcmVQYWdlVGl0bGUiKSwKICAgIHRpdGxlRGVzY3JpcHRpb246IHZtLiR0KCJIb21lT3JNb3JlUGFnZVRpdGxlIiksCiAgICBpdGVtczogW3sKICAgICAgdHlwZTogInRhYmxlIiwKICAgICAga2V5OiAic29mdGtleUluSG9tZU9yTW9yZSIsCiAgICAgIHRhYmxlQ29sdW1uczogW3sKICAgICAgICB0eXBlOiAic2VsZWN0IiwKICAgICAgICB0aXRsZTogdm0uJHQoIlN0YXR1cyIpLAogICAgICAgIGRhdGFJbmRleDogInN0YXR1cyIsCiAgICAgICAgc2NvcGVkU2xvdHM6IHsKICAgICAgICAgIGN1c3RvbVJlbmRlcjogInN0YXR1cyIKICAgICAgICB9LAogICAgICAgIGFsaWduOiAiY2VudGVyIiwKICAgICAgICBzZWxlY3RJdGVtczogdm0uc3RhdHVzSXRlbXMsCiAgICAgICAgd2lkdGg6ICIzMCUiCiAgICAgIH0sIHsKICAgICAgICB0eXBlOiAiaW5wdXQiLAogICAgICAgIHRpdGxlOiB2bS4kdCgiRGlzcGxheU5hbWUiKSwKICAgICAgICBkYXRhSW5kZXg6ICJkaXNwbGF5TmFtZSIsCiAgICAgICAgc2NvcGVkU2xvdHM6IHsKICAgICAgICAgIGN1c3RvbVJlbmRlcjogImRpc3BsYXlOYW1lIgogICAgICAgIH0sCiAgICAgICAgYWxpZ246ICJjZW50ZXIiLAogICAgICAgIHdpZHRoOiAiMzAlIgogICAgICB9LCB7CiAgICAgICAgdHlwZTogInNlbGVjdCIsCiAgICAgICAgdGl0bGU6IHZtLiR0KCJUeXBlIiksCiAgICAgICAgZGF0YUluZGV4OiAidHlwZSIsCiAgICAgICAgc2NvcGVkU2xvdHM6IHsKICAgICAgICAgIGN1c3RvbVJlbmRlcjogInR5cGUiCiAgICAgICAgfSwKICAgICAgICBhbGlnbjogImNlbnRlciIsCiAgICAgICAgc2VsZWN0SXRlbXM6IHR5cGVJdGVtcywKICAgICAgICB3aWR0aDogIjQwJSIKICAgICAgfV0sCiAgICAgIHRhYmxlRGF0YTogdGFibGVEYXRhCiAgICB9XQogIH07CiAgcmV0dXJuIGNvbnRlbnQ7Cn0KCmZ1bmN0aW9uIGNyZWF0ZVNvZnRrZXlJblRhbGtpbmdDb250ZW50KHZtKSB7CiAgLy90eXBlIGl0ZW1zCiAgdmFyIHR5cGVJdGVtcyA9IFtdOwogIHR5cGVJdGVtcy5wdXNoKHsKICAgIGtleTogMywKICAgIGxhYmVsOiB2bS4kdCgiUmVtb3RlUmVsYXlIVFRQIikKICB9KTsKCiAgaWYgKHZtLmFwaURhdGEuZGF0YS5tYXhSZWxheVNvZnRrZXlOdW0gPT0gMykgewogICAgaWYgKHZtLmFwaURhdGEuZGF0YS5zdXBwb3J0VGhyZWVEdG1mID09IDEpIHsKICAgICAgdHlwZUl0ZW1zLnB1c2goewogICAgICAgIGtleTogMiwKICAgICAgICBsYWJlbDogdm0uJHQoIlJlbW90ZVJlbGF5RFRNRiIpICsgIjEiCiAgICAgIH0pOwogICAgICB0eXBlSXRlbXMucHVzaCh7CiAgICAgICAga2V5OiAxNCwKICAgICAgICBsYWJlbDogdm0uJHQoIlJlbW90ZVJlbGF5RFRNRiIpICsgIjIiCiAgICAgIH0pOwogICAgICB0eXBlSXRlbXMucHVzaCh7CiAgICAgICAga2V5OiAxNSwKICAgICAgICBsYWJlbDogdm0uJHQoIlJlbW90ZVJlbGF5RFRNRiIpICsgIjMiCiAgICAgIH0pOwogICAgfSBlbHNlIHsKICAgICAgdHlwZUl0ZW1zLnB1c2goewogICAgICAgIGtleTogMiwKICAgICAgICBsYWJlbDogdm0uJHQoIlJlbW90ZVJlbGF5RFRNRiIpCiAgICAgIH0pOwogICAgfQoKICAgIGlmICh2bS5hcGlEYXRhLmRhdGEuc3VwcG9ydFJlbGF5QiA9PSAxKSB7CiAgICAgIHR5cGVJdGVtcy5wdXNoKHsKICAgICAgICBrZXk6IDAsCiAgICAgICAgbGFiZWw6IHZtLiR0KCJMb2NhbFJlbGF5IikgKyAiMSIKICAgICAgfSk7CiAgICAgIHR5cGVJdGVtcy5wdXNoKHsKICAgICAgICBrZXk6IDEsCiAgICAgICAgbGFiZWw6IHZtLiR0KCJMb2NhbFJlbGF5IikgKyAiMiIKICAgICAgfSk7CiAgICB9IGVsc2UgewogICAgICB0eXBlSXRlbXMucHVzaCh7CiAgICAgICAga2V5OiAwLAogICAgICAgIGxhYmVsOiB2bS4kdCgiTG9jYWxSZWxheSIpCiAgICAgIH0pOwogICAgfQogIH0gZWxzZSB7CiAgICB0eXBlSXRlbXMucHVzaCh7CiAgICAgIGtleTogMiwKICAgICAgbGFiZWw6IHZtLiR0KCJSZW1vdGVSZWxheURUTUYiKQogICAgfSk7CiAgICB0eXBlSXRlbXMucHVzaCh7CiAgICAgIGtleTogMCwKICAgICAgbGFiZWw6IHZtLiR0KCJMb2NhbFJlbGF5IikKICAgIH0pOwogIH0KCiAgdHlwZUl0ZW1zLnB1c2goewogICAga2V5OiA0LAogICAgbGFiZWw6IHZtLiR0KCJXZWJSZWxheUFjdGlvblZhbHVlIikKICB9KTsgLy90YWJsZSBkYXRhCgogIHZhciB0YWJsZURhdGEgPSBbXTsKCiAgZm9yICh2YXIgaSA9IDA7IGkgPCB2bS5hcGlEYXRhLmRhdGEubWF4UmVsYXlTb2Z0a2V5TnVtOyBpKyspIHsKICAgIHZhciBpdGVtID0gewogICAgICBrZXk6IGksCiAgICAgIGtleUxhYmVsOiB2bS4kdCgiS2V5IikgKyAoaSArIDEpLAogICAgICBzdGF0dXM6IHsKICAgICAgICB2YWx1ZTogdm0uYXBpRGF0YS5jb25maWdEYXRhWyJDb25maWcuRG9vclNldHRpbmcuUkVMQVkuVGFsa2luZ1N0YXR1cyIgKyAoaSArIDEpXSwKICAgICAgICBpc1dhcm46IGZhbHNlCiAgICAgIH0sCiAgICAgIGRpc3BsYXlOYW1lOiB7CiAgICAgICAgdmFsdWU6IHZtLmFwaURhdGEuY29uZmlnRGF0YVsiQ29uZmlnLkRvb3JTZXR0aW5nLlJFTEFZLlRhbGtpbmdDb2xEaXNwbGF5TmFtZSIgKyAoaSArIDEpXSwKICAgICAgICBpc1dhcm46IGZhbHNlCiAgICAgIH0sCiAgICAgIHR5cGU6IHsKICAgICAgICB2YWx1ZTogdm0uYXBpRGF0YS5jb25maWdEYXRhWyJDb25maWcuRG9vclNldHRpbmcuUkVMQVkuVGFsa2luZ1JlbGF5VHlwZSIgKyAoaSArIDEpXSwKICAgICAgICBpc1dhcm46IGZhbHNlCiAgICAgIH0KICAgIH07CiAgICB0YWJsZURhdGEucHVzaChpdGVtKTsKICB9IC8vY29udGVudAoKCiAgdmFyIGNvbnRlbnQgPSB7CiAgICBrZXk6ICJzb2Z0a2V5SW5UYWxraW5nIiwKICAgIHRpdGxlOiB2bS4kdCgiU29mdEtleUluVGFsa2luZyIpLAogICAgdGl0bGVEZXNjcmlwdGlvbjogdm0uJHQoIlNvZnRLZXlJblRhbGtpbmciKSwKICAgIGl0ZW1zOiBbewogICAgICB0eXBlOiAidGFibGUiLAogICAgICBrZXk6ICJzb2Z0a2V5SW5UYWxraW5nIiwKICAgICAgdGFibGVDb2x1bW5zOiBbewogICAgICAgIHR5cGU6ICJsYWJlbCIsCiAgICAgICAgdGl0bGU6IHZtLiR0KCJLZXkiKSwKICAgICAgICBkYXRhSW5kZXg6ICJrZXlMYWJlbCIsCiAgICAgICAgc2NvcGVkU2xvdHM6IHsKICAgICAgICAgIGN1c3RvbVJlbmRlcjogImtleUxhYmVsIgogICAgICAgIH0sCiAgICAgICAgYWxpZ246ICJjZW50ZXIiLAogICAgICAgIHdpZHRoOiAiMTAlIgogICAgICB9LCB7CiAgICAgICAgdHlwZTogInNlbGVjdCIsCiAgICAgICAgdGl0bGU6IHZtLiR0KCJTdGF0dXMiKSwKICAgICAgICBkYXRhSW5kZXg6ICJzdGF0dXMiLAogICAgICAgIHNjb3BlZFNsb3RzOiB7CiAgICAgICAgICBjdXN0b21SZW5kZXI6ICJzdGF0dXMiCiAgICAgICAgfSwKICAgICAgICBhbGlnbjogImNlbnRlciIsCiAgICAgICAgc2VsZWN0SXRlbXM6IHZtLnN0YXR1c0l0ZW1zLAogICAgICAgIHdpZHRoOiAiMzAlIgogICAgICB9LCB7CiAgICAgICAgdHlwZTogImlucHV0IiwKICAgICAgICB0aXRsZTogdm0uJHQoIkRpc3BsYXlOYW1lIiksCiAgICAgICAgZGF0YUluZGV4OiAiZGlzcGxheU5hbWUiLAogICAgICAgIHNjb3BlZFNsb3RzOiB7CiAgICAgICAgICBjdXN0b21SZW5kZXI6ICJkaXNwbGF5TmFtZSIKICAgICAgICB9LAogICAgICAgIGFsaWduOiAiY2VudGVyIiwKICAgICAgICB3aWR0aDogIjMwJSIKICAgICAgfSwgewogICAgICAgIHR5cGU6ICJzZWxlY3QiLAogICAgICAgIHRpdGxlOiB2bS4kdCgiVHlwZSIpLAogICAgICAgIGRhdGFJbmRleDogInR5cGUiLAogICAgICAgIHNjb3BlZFNsb3RzOiB7CiAgICAgICAgICBjdXN0b21SZW5kZXI6ICJ0eXBlIgogICAgICAgIH0sCiAgICAgICAgYWxpZ246ICJjZW50ZXIiLAogICAgICAgIHNlbGVjdEl0ZW1zOiB0eXBlSXRlbXMsCiAgICAgICAgd2lkdGg6ICIzMCUiCiAgICAgIH1dLAogICAgICB0YWJsZURhdGE6IHRhYmxlRGF0YQogICAgfV0KICB9OwogIHJldHVybiBjb250ZW50Owp9CgpmdW5jdGlvbiBjcmVhdGVPcGVuUmVsYXlWaWFIdHRwQ29udGVudCh2bSkgewogIHZhciBjb250ZW50ID0gewogICAga2V5OiAib3BlblJlbGF5VmlhSHR0cCIsCiAgICB0aXRsZTogdm0uJHQoIk9wZW5SZWxheVNldHRpbmciKSwKICAgIHRpdGxlRGVzY3JpcHRpb246IHZtLiR0KCJPcGVuUmVsYXlTZXR0aW5nIiksCiAgICBpdGVtczogW3sKICAgICAgdGl0bGU6IHZtLiR0KCJTd2l0Y2giKSwKICAgICAgdHlwZTogImNoZWNrYm94IiwKICAgICAga2V5OiAiQ29uZmlnLkRvb3JTZXR0aW5nLlJFTEFZLlJlbGF5T25XZWIiLAogICAgICB2YWx1ZTogdm0uYXBpRGF0YS5jb25maWdEYXRhWyJDb25maWcuRG9vclNldHRpbmcuUkVMQVkuUmVsYXlPbldlYiJdCiAgICB9LCB7CiAgICAgIHRpdGxlOiB2bS4kdCgiUmVtb3RlUmVsYXlVc2VyIiksCiAgICAgIHR5cGU6ICJpbnB1dCIsCiAgICAgIGtleTogIkNvbmZpZy5Eb29yU2V0dGluZy5SRUxBWS5SZWxheU9uV2ViVXNlciIsCiAgICAgIHZhbHVlOiB2bS5hcGlEYXRhLmNvbmZpZ0RhdGFbIkNvbmZpZy5Eb29yU2V0dGluZy5SRUxBWS5SZWxheU9uV2ViVXNlciJdLAogICAgICBkaXNhYmxlZDogZmFsc2UKICAgIH0sIHsKICAgICAgdGl0bGU6IHZtLiR0KCJSZW1vdGVSZWxheVBhc3N3ZCIpLAogICAgICB0eXBlOiAiaW5wdXQiLAogICAgICBrZXk6ICJDb25maWcuRG9vclNldHRpbmcuUkVMQVkuUmVsYXlPbldlYlB3ZCIsCiAgICAgIHZhbHVlOiB2bS5hcGlEYXRhLmNvbmZpZ0RhdGFbIkNvbmZpZy5Eb29yU2V0dGluZy5SRUxBWS5SZWxheU9uV2ViUHdkIl0sCiAgICAgIGRpc2FibGVkOiBmYWxzZSwKICAgICAgaW5wdXRUeXBlOiAicGFzc3dvcmQiCiAgICB9XQogIH07CiAgcmV0dXJuIGNvbnRlbnQ7Cn0KCmZ1bmN0aW9uIGNyZWF0ZVJlbW90ZUNvbnRyb2xDb250ZW50KHZtKSB7CiAgdmFyIGNvbnRlbnQgPSB7CiAgICBrZXk6ICJyZW1vdGVDb250cm9sIiwKICAgIHRpdGxlOiB2bS4kdCgiUmVtb3RlQ29udHJvbCIpLAogICAgdGl0bGVEZXNjcmlwdGlvbjogdm0uJHQoIlJlbW90ZUNvbnRyb2wiKSwKICAgIGl0ZW1zOiBbewogICAgICB0aXRsZTogdm0uJHQoIkFsbG93ZWRBY2Nlc3NJUExpc3QiKSwKICAgICAgdHlwZTogImlucHV0IiwKICAgICAga2V5OiAiQ29uZmlnLkZlYXR1cmVzLlJFTU9URUNPTlRST0wuQWN0aW9uVVJJQWxsb3dJUExpc3QiLAogICAgICB2YWx1ZTogdm0uYXBpRGF0YS5jb25maWdEYXRhWyJDb25maWcuRmVhdHVyZXMuUkVNT1RFQ09OVFJPTC5BY3Rpb25VUklBbGxvd0lQTGlzdCJdLAogICAgICBpc1dhcm46IGZhbHNlLAogICAgICB3YXJuTGFiZWw6IHZtLiR0KCJQbGVhc2VDaGVja0FsYXJtU3VibWl0RGF0YSIpCiAgICB9XQogIH07CiAgcmV0dXJuIGNvbnRlbnQ7Cn0KCmZ1bmN0aW9uIGNyZWF0ZVJlbGF5U2V0dGluZ0NvbnRlbnQodm0pIHsKICAvL2RlbGF5IGl0ZW1zCiAgdmFyIGRlbGF5SXRlbXMgPSBbXTsKCiAgZm9yICh2YXIgaSA9IDA7IGkgPD0gNjA7IGkrKykgewogICAgdmFyIGl0ZW0gPSB7CiAgICAgIGtleTogaSwKICAgICAgbGFiZWw6IGkKICAgIH07CiAgICBkZWxheUl0ZW1zLnB1c2goaXRlbSk7CiAgfQoKICBkZWxheUl0ZW1zLnB1c2goewogICAga2V5OiAtMSwKICAgIGxhYmVsOiB2bS4kdCgiTmV2ZXIiKQogIH0pOyAvL3JlbGF5IHR5cGUKCiAgdmFyIHJlbGF5VHlwZUl0ZW1zID0gW107CiAgcmVsYXlUeXBlSXRlbXMucHVzaCh7CiAgICBrZXk6IDAsCiAgICBsYWJlbDogdm0uJHQoIk9wZW5Eb29yIikKICB9KTsKCiAgaWYgKHZtLmFwaURhdGEuZGF0YS5jaGltZUJlbGxUeXBlID09IDEpIHsKICAgIHJlbGF5VHlwZUl0ZW1zLnB1c2goewogICAgICBrZXk6IDEsCiAgICAgIGxhYmVsOiB2bS4kdCgiRXh0ZW5zaW9uU3BlYWtlciIpCiAgICB9KTsKICB9IGVsc2UgaWYgKHZtLmFwaURhdGEuZGF0YS5jaGltZUJlbGxUeXBlID09IDIpIHsKICAgIHJlbGF5VHlwZUl0ZW1zLnB1c2goewogICAgICBrZXk6IDIsCiAgICAgIGxhYmVsOiB2bS4kdCgiQ2hpbWVCZWxsIikKICAgIH0pOwogIH0gZWxzZSB7CiAgICByZWxheVR5cGVJdGVtcy5wdXNoKHsKICAgICAga2V5OiAyLAogICAgICBsYWJlbDogdm0uJHQoIkNoaW1lQmVsbCIpCiAgICB9KTsKCiAgICBpZiAodm0uYXBpRGF0YS5kYXRhLnN1cHBvcnRIaWRlU09TQWN0aW9uICE9IDEpIHsKICAgICAgcmVsYXlUeXBlSXRlbXMucHVzaCh7CiAgICAgICAga2V5OiAzLAogICAgICAgIGxhYmVsOiB2bS4kdCgiU09TQWN0aW9uIikKICAgICAgfSk7CiAgICB9CiAgfQoKICB2YXIgY29udGVudCA9IHsKICAgIGtleTogInJlbGF5U2V0dGluZyIsCiAgICB0aXRsZTogdm0uJHQoIlJlbGF5U2V0dGluZyIpLAogICAgdGl0bGVEZXNjcmlwdGlvbjogdm0uJHQoIlJlbGF5U2V0dGluZyIpLAogICAgaXRlbXM6IFt7CiAgICAgIHRpdGxlOiB2bS4kdCgiTG9jYWxSZWxheSIpICsgIjEiLAogICAgICB0eXBlOiAibGFiZWwiLAogICAgICBrZXk6ICJsb2NhbFJlbGF5MSIsCiAgICAgIHZhbHVlOiAiIiwKICAgICAgdGl0bGVCb2xkOiB0cnVlCiAgICB9LCB7CiAgICAgIHRpdGxlOiB2bS4kdCgiUmVsYXlEZWxheU5hbWUxIiksCiAgICAgIHR5cGU6ICJzZWxlY3QiLAogICAgICBrZXk6ICJDb25maWcuRG9vclNldHRpbmcuUkVMQVkuRGVsYXkxIiwKICAgICAgdmFsdWU6IHZtLmFwaURhdGEuY29uZmlnRGF0YVsiQ29uZmlnLkRvb3JTZXR0aW5nLlJFTEFZLkRlbGF5MSJdLAogICAgICBzZWxlY3RJdGVtczogZGVsYXlJdGVtcwogICAgfSwgewogICAgICB0aXRsZTogdm0uJHQoIkxvY2FsUmVsYXlUeXBlTmFtZTEiKSwKICAgICAgdHlwZTogInNlbGVjdCIsCiAgICAgIGtleTogIkNvbmZpZy5Eb29yU2V0dGluZy5SRUxBWS5Mb2NhbFJlbGF5VHlwZTEiLAogICAgICB2YWx1ZTogdm0uYXBpRGF0YS5jb25maWdEYXRhWyJDb25maWcuRG9vclNldHRpbmcuUkVMQVkuTG9jYWxSZWxheVR5cGUxIl0sCiAgICAgIHNlbGVjdEl0ZW1zOiByZWxheVR5cGVJdGVtcwogICAgfSwgewogICAgICB0aXRsZTogdm0uJHQoIkxvY2FsUmVsYXkiKSArICIyIiwKICAgICAgdHlwZTogImxhYmVsIiwKICAgICAga2V5OiAibG9jYWxSZWxheTIiLAogICAgICB2YWx1ZTogIiIsCiAgICAgIHRpdGxlQm9sZDogdHJ1ZQogICAgfSwgewogICAgICB0aXRsZTogdm0uJHQoIlJlbGF5RGVsYXlOYW1lMiIpLAogICAgICB0eXBlOiAic2VsZWN0IiwKICAgICAga2V5OiAiQ29uZmlnLkRvb3JTZXR0aW5nLlJFTEFZLkRlbGF5MiIsCiAgICAgIHZhbHVlOiB2bS5hcGlEYXRhLmNvbmZpZ0RhdGFbIkNvbmZpZy5Eb29yU2V0dGluZy5SRUxBWS5EZWxheTIiXSwKICAgICAgc2VsZWN0SXRlbXM6IGRlbGF5SXRlbXMKICAgIH0sIHsKICAgICAgdGl0bGU6IHZtLiR0KCJMb2NhbFJlbGF5VHlwZU5hbWUyIiksCiAgICAgIHR5cGU6ICJzZWxlY3QiLAogICAgICBrZXk6ICJDb25maWcuRG9vclNldHRpbmcuUkVMQVkuTG9jYWxSZWxheVR5cGUyIiwKICAgICAgdmFsdWU6IHZtLmFwaURhdGEuY29uZmlnRGF0YVsiQ29uZmlnLkRvb3JTZXR0aW5nLlJFTEFZLkxvY2FsUmVsYXlUeXBlMiJdLAogICAgICBzZWxlY3RJdGVtczogcmVsYXlUeXBlSXRlbXMKICAgIH0sIHsKICAgICAgdGl0bGU6IHZtLiR0KCJSZW1vdGVSZWxheSIpLAogICAgICB0eXBlOiAibGFiZWwiLAogICAgICBrZXk6ICJyZW1vdGVSZWxheSIsCiAgICAgIHZhbHVlOiAiIiwKICAgICAgdGl0bGVCb2xkOiB0cnVlCiAgICB9LCB7CiAgICAgIHRpdGxlOiB2bS4kdCgiRFRNRiIpICsgIjEgIiArIHZtLiR0KCJDb2RlIiksCiAgICAgIHR5cGU6ICJpbnB1dCIsCiAgICAgIGtleTogIkNvbmZpZy5Eb29yU2V0dGluZy5SRUxBWS5EVE1GQ29kZSIsCiAgICAgIHZhbHVlOiB2bS5hcGlEYXRhLmNvbmZpZ0RhdGFbIkNvbmZpZy5Eb29yU2V0dGluZy5SRUxBWS5EVE1GQ29kZSJdCiAgICB9LCB7CiAgICAgIHRpdGxlOiB2bS4kdCgiRFRNRiIpICsgIjIgIiArIHZtLiR0KCJDb2RlIiksCiAgICAgIHR5cGU6ICJpbnB1dCIsCiAgICAgIGtleTogIkNvbmZpZy5Eb29yU2V0dGluZy5SRUxBWS5EVE1GQ29kZTIiLAogICAgICB2YWx1ZTogdm0uYXBpRGF0YS5jb25maWdEYXRhWyJDb25maWcuRG9vclNldHRpbmcuUkVMQVkuRFRNRkNvZGUyIl0sCiAgICAgIGlzSGlkZTogZmFsc2UKICAgIH0sIHsKICAgICAgdGl0bGU6IHZtLiR0KCJEVE1GIikgKyAiMyAiICsgdm0uJHQoIkNvZGUiKSwKICAgICAgdHlwZTogImlucHV0IiwKICAgICAga2V5OiAiQ29uZmlnLkRvb3JTZXR0aW5nLlJFTEFZLkRUTUZDb2RlMyIsCiAgICAgIHZhbHVlOiB2bS5hcGlEYXRhLmNvbmZpZ0RhdGFbIkNvbmZpZy5Eb29yU2V0dGluZy5SRUxBWS5EVE1GQ29kZTMiXSwKICAgICAgaXNIaWRlOiBmYWxzZQogICAgfV0KICB9OwogIHJldHVybiBjb250ZW50Owp9"},null]}